<html lang="en"><head><meta charset="utf8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>GumTree</title><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><style type="text/css">/*
 * This file is part of GumTree.
 *
 * GumTree is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * GumTree is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with GumTree.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Copyright 2011-2015 Jean-Rémy Falleri <jr.falleri@gmail.com>
 * Copyright 2011-2015 Floréal Morandat <florealm@gmail.com>
 */

.add {
	border: 1px solid black;
	background-color: MediumSeaGreen;
}

.del {
	border: 1px solid black;
	background-color: IndianRed;
}

.mv {
	border: 1px solid black;
	background-color: Plum;
}

.upd {
	border: 1px solid black;
	background-color: DarkOrange;
	font-weight: bold;
}

.cupd {
	font-weight: normal;
	color: DimGray;
}

.selected {
	background-color: Gold;
}

.marker {
	margin: 0;
	padding: 0;
}

div {
	margin: 0px;
	padding: 0px;
}

.pre-scrollable {
	margin: 0px;
	padding: 0px;
	font-size: 10pt;
	color: black;
	max-height: 90vh;
	background-color: white;
	border: 1px solid black;
	font-family: "Hack, Inconsolata", "Consolas", "Liberation Sans Regular", "DejaVu Sans Mono", monospace;
}

.tooltip-inner {
    max-width: none;
}
</style><script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script type="text/javascript">/*
 * This file is part of GumTree.
 *
 * GumTree is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * GumTree is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with GumTree.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Copyright 2011-2015 Jean-Rémy Falleri <jr.falleri@gmail.com>
 * Copyright 2011-2015 Floréal Morandat <florealm@gmail.com>
 */

$(function(){
    let popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
    let popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
      return new bootstrap.Popover(popoverTriggerEl)
    })

    $("body").keypress(function (event) {
        switch (event.which) {
            case 116:
                $('html, body').animate({scrollTop: 0}, 100);
                break;
            case 98:
                $("html, body").animate({ scrollTop: $(document).height() }, 100);
                break;
            case 113:
                window.location = "/quit";
                break;
            case 108:
                window.location = "/list";
                break;
        }
    });
});
</script><script type="text/javascript">/*
 * This file is part of GumTree.
 *
 * GumTree is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * GumTree is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with GumTree.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Copyright 2011-2015 Jean-Rémy Falleri <jr.falleri@gmail.com>
 * Copyright 2011-2015 Floréal Morandat <florealm@gmail.com>
 */

currentMapping = 0;

if (typeof String.prototype.startsWith != 'function') {
  String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
  };
}

function getMappedElement(eltId) {
	if (eltId.startsWith("move-src")) {
		return eltId.replace("src","dst");  	 	
  	}
  	else {
  		return eltId.replace("dst","src");
  	}
}

function nextMapping() {
	if (currentMapping == 0) {
		currentMapping = 1;
		return "#mapping-" + currentMapping.toString();
	} else {
		currentMapping++;
		
		if ($("#mapping-" + currentMapping.toString()).length > 0) {
			return "#mapping-" + currentMapping.toString();
		} else {
			currentMapping = 1;
			return "#mapping-" + currentMapping.toString();		
		}		
	}
}

function isSrc(eltId) {
	return eltId.startsWith("move-src");
}

$(function() {
    $("body").keypress(function (event) {
        switch(event.which) {
            case 110:
                const mapping = $(nextMapping());
                const pre = mapping.closest("pre");
                pre.animate({scrollTop: pre.scrollTop() + mapping.position().top - 200}, 100);
                break;
        }
    });

    // highlight
    $("span.mv.token, span.token.upd").click(function(event) {
        if ($(this).hasClass("selected")) {
            $("span.mv.token, span.token.upd").removeClass("selected");
        } else {
            $("span.mv.token, span.token.upd").removeClass("selected");
            const refElt = $("#" + getMappedElement($(this).attr("id")));
            $(this).addClass("selected");
            refElt.addClass("selected");
            const pre = refElt.closest("pre");
            console.log(pre);
            pre.animate({scrollTop: pre.scrollTop() + refElt.position().top - 200}, 100);
        }
        event.stopPropagation();
    });
    
    $("span.add.token, span.token.del").click(function(event) {
        $("span.mv.token, span.token.upd").removeClass("selected");
        event.stopPropagation();
    });

    // tooltip
    $("span.token").hover(
    	function (event) {
    		$(this).tooltip('show');
    		event.stopPropagation();
    	},
    	function (event) {
    		$(this).tooltip('hide');
    		event.stopPropagation();
    	}
    );
});
</script></head><body><div class="container-fluid"><div class="row"><div class="col"><div class="btn-toolbar justify-content-end"><div class="btn-group mr-2"><button class="btn btn-primary btn-sm" id="legend" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-html="true" data-bs-content="<span class='del'>&nbsp;&nbsp;</span> deleted<br><span class='add'>&nbsp;&nbsp;</span> added<br><span class='mv'>&nbsp;&nbsp;</span> moved<br><span class='upd';>&nbsp;&nbsp;</span> updated<br>">Legend</button><button class="btn btn-primary btn-sm" id="shortcuts" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-html="true" data-bs-content="<b>q</b> quit<br><b>l</b> list<br><b>n</b> next<br><b>t</b> top<br><b>b</b> bottom">Shortcuts</button></div><div class="btn-group"><a href="/list" class="btn btn-default btn-sm btn-primary">Back</a><a href="/quit" class="btn btn-default btn-sm btn-danger">Quit</a></div></div></div></div><div class="row"><div class="col-6"><h5>Address.sol</h5><pre class="pre-scrollable">// SPDX-License-Identifier: MIT
<span class="marker" id="mapping-1"></span><span class="token upd" id="move-src-1" data-title="source_file/comment"><span class="cupd">// OpenZeppelin Contracts </span><span class="cupd">v</span>4<span class="cupd">.</span>3<span class="cupd">.</span>2<span class="cupd"> (utils/Address.sol)</span></span>

pragma solidity ^<span class="marker" id="mapping-2"></span><span class="token upd" id="move-src-2" data-title="solidity_pragma_token/solidity_version"><span class="cupd">0.8.</span>0</span>;

/**
 * @dev Collection of functions related to the address type
 */
library Address {
    <span class="marker" id="mapping-3"></span><span class="token upd" id="move-src-3" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>R<span class="cupd">e</span>turns<span class="cupd"> </span>true<span class="cupd"> </span>if `<span class="cupd">a</span>ccount` is <span class="cupd">a</span> co<span class="cupd">n</span>tra<span class="cupd">c</span>t.
     *
     * [IMPORTANT]
     * ====
     * It is unsaf<span class="cupd">e </span>t<span class="cupd">o</span> assume that an address <span class="cupd">f</span>or<span class="cupd"> </span>which <span class="cupd">th</span>is function r<span class="cupd">e</span>turns<span class="cupd">
</span>     * f<span class="cupd">a</span>lse is an externally-owned a<span class="cupd">ccount </span>(EOA)<span class="cupd"> </span>a<span class="cupd">n</span>d n<span class="cupd">ot </span>a co<span class="cupd">n</span>tract.
     *
     * Am<span class="cupd">o</span>n<span class="cupd">g</span><span class="cupd"> </span>o<span class="cupd">t</span>hers, `isC<span class="cupd">o</span>ntract`<span class="cupd"> </span>will r<span class="cupd">e</span>tu<span class="cupd">r</span>n <span class="cupd">f</span>alse f<span class="cupd">or</span><span class="cupd"> the </span>f<span class="cupd">o</span>llowing
     * ty<span class="cupd">pe</span>s of add<span class="cupd">r</span>esses:
     *
     *  - <span class="cupd">a</span>n ex<span class="cupd">t</span>ernally-owned account
     *  - a contract <span class="cupd">i</span>n c<span class="cupd">on</span>struction<span class="cupd">
     *</span>  - an address where a contract will be created
     *  - an address where a contract lived, but was destroyed
     * ====
     */</span>
    <span class="marker" id="mapping-4"></span><span class="token del" data-title="contract_body/function_definition">function isContract(<span class="marker" id="mapping-5"></span><span class="token del" data-title="function_definition/parameter"><span class="marker" id="mapping-6"></span><span class="token mv" id="move-src-4" data-title="parameter/type_name">address</span> account</span>) <span class="marker" id="mapping-7"></span><span class="token del" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-8"></span><span class="token del" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-9"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-10"></span><span class="token del" data-title="function_definition/function_body">{
        // This method relies on extcodesize, which returns 0 for contracts in
        // construction, since the code is only stored at the end of the
        // constructor execution.

        uint256 size;
        assembly {
            size := extcodesize(account)
        }
        return size &gt; 0;
    }</span></span>

    <span class="marker" id="mapping-11"></span><span class="token upd" id="move-src-5" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>R<span class="cupd">e</span>plac<span class="cupd">e</span>ment for Solidity<span class="cupd">'s </span>`tra<span class="cupd">n</span>sfer`: sends `am<span class="cupd">o</span>unt`<span class="cupd"> </span>wei to
     * `re<span class="cupd">c</span>ipient`, f<span class="cupd">o</span>rwar<span class="cupd">d</span>ing all availabl<span class="cupd">e </span>g<span class="cupd">a</span>s and rever<span class="cupd">t</span>ing<span class="cupd"> </span>on errors.
     *
     * https://eips.ethereum.org/EIPS/eip-1884[EIP1884] increases the gas cost
     * of certain opcodes, possibly making contracts go over the 2300 gas limit
     * imposed by <span class="cupd">`t</span>r<span class="cupd">a</span>nsfe<span class="cupd">r</span>`, makin<span class="cupd">g</span> th<span class="cupd">e</span>m unable <span class="cupd">t</span>o receive funds via
     * <span class="cupd">`</span>transfer`.<span class="cupd"> </span>{sendValue} removes th<span class="cupd">i</span>s limi<span class="cupd">t</span>ation.<span class="cupd">
</span>     *
     * https://d<span class="cupd">i</span>ligence.con<span class="cupd">s</span>ensys.net/posts/2019/09/stop-using-soliditys-transfer-now/[Learn<span class="cupd"> </span>more].
     *
     * IMPORTANT: because co<span class="cupd">n</span>tr<span class="cupd">o</span>l is <span class="cupd">t</span>ransferred<span class="cupd"> </span>to `recipient`, c<span class="cupd">a</span>re<span class="cupd"> </span>must be
     * taken to not <span class="cupd">c</span>reate reentrancy vulnerabilities. C<span class="cupd">on</span>sider using
     * {Reen<span class="cupd">tra</span>n<span class="cupd">c</span>yGuard} or <span class="cupd">t</span>he
     * https://solidity<span class="cupd">.</span>readthedocs.io/en/v0.5.11/security-considerations.html#use-the-checks-effects-interactions-pattern[checks-effects-interactions<span class="cupd"> </span>pattern].<span class="cupd">
    </span> <span class="cupd">*/</span></span>
    <span class="marker" id="mapping-12"></span><span class="token mv" id="move-src-6" data-title="contract_body/function_definition">function sendValue(address payable recipient, uint256 amount) internal {
        <span class="marker" id="mapping-13"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-14"></span><span class="token del" data-title="expression_statement/call_expression">require(<span class="marker" id="mapping-15"></span><span class="token del" data-title="call_expression/call_argument"><span class="marker" id="mapping-16"></span><span class="token mv" id="move-src-7" data-title="call_argument/binary_expression">address(this).balance <span class="marker" id="mapping-17"></span><span class="token del" data-title="binary_expression/>=">&gt;=</span> amount</span></span>, <span class="marker" id="mapping-18"></span><span class="token del" data-title="call_expression/call_argument">"Address: insufficient balance"</span>)</span>;</span>

        (bool success, ) = recipient.call{value: amount}("");
        <span class="marker" id="mapping-19"></span><span class="token del" data-title="function_body/expression_statement">require(success, "Address: unable to send value, recipient may have reverted");</span>
    }</span>

    <span class="marker" id="mapping-20"></span><span class="token upd" id="move-src-8" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Performs a Solidity function call using a low level `call`. <span class="cupd">A
</span>     * plain `<span class="cupd">call</span>`<span class="cupd"> </span>is an unsafe replacemen<span class="cupd">t</span> f<span class="cupd">o</span>r<span class="cupd"> a</span> fu<span class="cupd">n</span>ction<span class="cupd"> </span>c<span class="cupd">a</span>ll: us<span class="cupd">e</span> thi<span class="cupd">s</span>
     * function in<span class="cupd">s</span>tead.<span class="cupd">
</span>     *
     * If `<span class="cupd">target</span>`<span class="cupd"> </span>reverts with a revert reason, it is bubbled up by this
     * <span class="cupd">f</span>unction (like regul<span class="cupd">a</span>r Sol<span class="cupd">i</span>dity function ca<span class="cupd">l</span>ls).
     *
     * R<span class="cupd">e</span>turns the raw returne<span class="cupd">d</span> data<span class="cupd">. T</span>o convert to t<span class="cupd">he </span>expec<span class="cupd">t</span>ed return v<span class="cupd">a</span>lue,
     * use https://solidity.<span class="cupd">r</span>eadthedocs.io/en/latest/units-and-<span class="cupd">g</span>lobal-variabl<span class="cupd">e</span>s.h<span class="cupd">t</span>ml?highlight=abi.decode#abi-encoding-and-decoding-functions[`abi.decode`].<span class="cupd">
</span>     *
     * Require<span class="cupd">m</span>ents:
     *
     * - `t<span class="cupd">a</span>rget`<span class="cupd"> </span>must be <span class="cupd">a</span> contract.
     * - calling `targ<span class="cupd">e</span>t`<span class="cupd"> </span>with `data` must not <span class="cupd">revert</span>.
     *
     * _Availabl<span class="cupd">e</span> since v3<span class="cupd">.</span>1._<span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-21"></span><span class="token del" data-title="contract_body/function_definition">function functionCall(<span class="marker" id="mapping-22"></span><span class="token del" data-title="function_definition/parameter">address target</span>, <span class="marker" id="mapping-23"></span><span class="token del" data-title="function_definition/parameter">bytes memory data</span>) <span class="marker" id="mapping-24"></span><span class="token del" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-25"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bytes memory)</span> <span class="marker" id="mapping-26"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-27"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-28"></span><span class="token del" data-title="return_statement/call_expression">functionCall(<span class="marker" id="mapping-29"></span><span class="token mv" id="move-src-9" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-30"></span><span class="token del" data-title="call_expression/call_argument">data</span>, <span class="marker" id="mapping-31"></span><span class="token del" data-title="call_expression/call_argument">"Address: low-level call failed"</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-32"></span><span class="token upd" id="move-src-10" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>S<span class="cupd">a</span><span class="cupd">me</span><span class="cupd"> </span>a<span class="cupd">s </span>{x<span class="cupd">r</span><span class="cupd">e</span>f-Add<span class="cupd">r</span><span class="cupd">e</span><span class="cupd">s</span>s-f<span class="cupd">un</span>c<span class="cupd">t</span><span class="cupd">i</span><span class="cupd">o</span><span class="cupd">n</span>C<span class="cupd">a</span><span class="cupd">ll</span>-<span class="cupd">a</span><span class="cupd">d</span>d<span class="cupd">re</span><span class="cupd">s</span><span class="cupd">s</span>-by<span class="cupd">t</span><span class="cupd">e</span>s<span class="cupd">-</span>}<span class="cupd">[</span>`fu<span class="cupd">nc</span><span class="cupd">t</span><span class="cupd">i</span><span class="cupd">o</span><span class="cupd">n</span>C<span class="cupd">a</span><span class="cupd">l</span>l`],<span class="cupd"> </span><span class="cupd">b</span>u<span class="cupd">t</span><span class="cupd"> </span>w<span class="cupd">i</span><span class="cupd">th</span><span class="cupd">
</span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd">* `</span><span class="cupd">er</span><span class="cupd">r</span><span class="cupd">o</span>rM<span class="cupd">es</span><span class="cupd">s</span><span class="cupd">a</span><span class="cupd">ge</span>` <span class="cupd">a</span><span class="cupd">s</span> <span class="cupd">a</span><span class="cupd"> </span>fall<span class="cupd">b</span><span class="cupd">a</span><span class="cupd">c</span>k<span class="cupd"> </span><span class="cupd">r</span><span class="cupd">e</span>v<span class="cupd">e</span><span class="cupd">r</span><span class="cupd">t</span><span class="cupd"> </span><span class="cupd">re</span>a<span class="cupd">s</span>on<span class="cupd"> </span>wh<span class="cupd">e</span><span class="cupd">n </span>`<span class="cupd">t</span>a<span class="cupd">r</span>g<span class="cupd">e</span><span class="cupd">t</span>`<span class="cupd"> re</span><span class="cupd">v</span><span class="cupd">er</span><span class="cupd">t</span><span class="cupd">s.
</span><span class="cupd"> </span><span class="cupd">    </span><span class="cupd">*
</span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd">   </span><span class="cupd">* </span>_A<span class="cupd">v</span><span class="cupd">a</span><span class="cupd">i</span><span class="cupd">l</span><span class="cupd">a</span>bl<span class="cupd">e</span> <span class="cupd">s</span><span class="cupd">in</span><span class="cupd">c</span><span class="cupd">e</span> v3<span class="cupd">.</span>1._<span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-33"></span><span class="token mv" id="move-src-11" data-title="contract_body/function_definition">function functionCall(
        address target,
        bytes memory data<span class="marker" id="mapping-34"></span><span class="token del" data-title="function_definition/,">,</span>
        <span class="marker" id="mapping-35"></span><span class="token del" data-title="function_definition/parameter">string memory errorMessage</span>
    ) internal returns (bytes memory) {
        return functionCallWithValue(target, data, 0<span class="marker" id="mapping-36"></span><span class="token del" data-title="call_expression/,">,</span> <span class="marker" id="mapping-37"></span><span class="token del" data-title="call_expression/call_argument">errorMessage</span>);
    }</span>

    <span class="marker" id="mapping-38"></span><span class="token upd" id="move-src-12" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Sa<span class="cupd">m</span>e<span class="cupd"> a</span>s<span class="cupd"> </span>{xref-A<span class="cupd">d</span>dress-<span class="cupd">function</span>C<span class="cupd">all</span>-<span class="cupd">a</span>ddr<span class="cupd">e</span>ss-byt<span class="cupd">e</span>s-}[<span class="cupd">`</span>fun<span class="cupd">c</span>tionC<span class="cupd">all`</span>],<span class="cupd">
</span><span class="cupd">     </span><span class="cupd">* </span>but<span class="cupd"> </span><span class="cupd">al</span><span class="cupd">s</span>o<span class="cupd"> </span>tr<span class="cupd">an</span><span class="cupd">s</span><span class="cupd">fe</span><span class="cupd">r</span><span class="cupd">r</span><span class="cupd">i</span><span class="cupd">n</span>g<span class="cupd"> </span>`v<span class="cupd">al</span><span class="cupd">u</span><span class="cupd">e</span>`<span class="cupd"> </span>we<span class="cupd">i</span><span class="cupd"> </span><span class="cupd">t</span><span class="cupd">o</span><span class="cupd"> </span>`<span class="cupd">t</span><span class="cupd">a</span>rget`<span class="cupd">.
     *
     * </span>R<span class="cupd">e</span>qu<span class="cupd">i</span><span class="cupd">re</span>m<span class="cupd">e</span><span class="cupd">n</span><span class="cupd">t</span><span class="cupd">s</span>:<span class="cupd">
</span><span class="cupd">     </span><span class="cupd">*
</span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span>*<span class="cupd"> </span>-<span class="cupd"> </span><span class="cupd">t</span><span class="cupd">he call</span><span class="cupd">i</span><span class="cupd">n</span>g<span class="cupd"> </span><span class="cupd">c</span><span class="cupd">on</span><span class="cupd">t</span><span class="cupd">r</span><span class="cupd">a</span>c<span class="cupd">t</span> m<span class="cupd">u</span><span class="cupd">s</span><span class="cupd">t</span> <span class="cupd">h</span>av<span class="cupd">e </span><span class="cupd">a</span><span class="cupd">n</span><span class="cupd"> </span>E<span class="cupd">T</span>H<span class="cupd"> </span>bala<span class="cupd">n</span>c<span class="cupd">e</span><span class="cupd"> </span><span class="cupd">o</span>f<span class="cupd"> </span>a<span class="cupd">t</span><span class="cupd"> </span>l<span class="cupd">e</span>as<span class="cupd">t</span><span class="cupd"> </span>`<span class="cupd">value</span>`.<span class="cupd">
     * </span>-<span class="cupd"> </span><span class="cupd">t</span><span class="cupd">he</span> <span class="cupd">c</span><span class="cupd">a</span><span class="cupd">l</span><span class="cupd">l</span><span class="cupd">e</span><span class="cupd">d</span> S<span class="cupd">o</span>l<span class="cupd">i</span><span class="cupd">di</span>ty <span class="cupd">function</span> mu<span class="cupd">s</span>t be <span class="cupd">`</span>p<span class="cupd">a</span>ya<span class="cupd">b</span>l<span class="cupd">e</span><span class="cupd">`</span><span class="cupd">.
     *
     * </span>_Ava<span class="cupd">i</span>l<span class="cupd">a</span><span class="cupd">b</span><span class="cupd">l</span><span class="cupd">e</span><span class="cupd"> </span><span class="cupd">s</span>i<span class="cupd">n</span>c<span class="cupd">e</span> <span class="cupd">v</span>3<span class="cupd">.</span>1._<span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-39"></span><span class="token del" data-title="contract_body/function_definition">function functionCallWithValue(
        <span class="marker" id="mapping-40"></span><span class="token del" data-title="function_definition/parameter">address target</span>,
        <span class="marker" id="mapping-41"></span><span class="token del" data-title="function_definition/parameter">bytes memory data</span>,
        <span class="marker" id="mapping-42"></span><span class="token del" data-title="function_definition/parameter">uint256 value</span>
    ) <span class="marker" id="mapping-43"></span><span class="token del" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-44"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bytes memory)</span> <span class="marker" id="mapping-45"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-46"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-47"></span><span class="token del" data-title="return_statement/call_expression">functionCallWithValue(<span class="marker" id="mapping-48"></span><span class="token mv" id="move-src-13" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-49"></span><span class="token del" data-title="call_expression/call_argument">data</span>, <span class="marker" id="mapping-50"></span><span class="token del" data-title="call_expression/call_argument">value</span>, <span class="marker" id="mapping-51"></span><span class="token del" data-title="call_expression/call_argument">"Address: low-level call with value failed"</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-52"></span><span class="token upd" id="move-src-14" data-title="contract_body/comment"><span class="cupd">/**
     * @dev Same as {xref-Address-functionCall</span>WithValue<span class="cupd">-address-bytes-</span>uint256-<span class="cupd">}[`functionCall</span>WithValue<span class="cupd">`], </span>but<span class="cupd">
    </span> <span class="cupd">* </span>wi<span class="cupd">t</span>h<span class="cupd"> </span>`err<span class="cupd">o</span><span class="cupd">r</span>Mess<span class="cupd">a</span>ge` a<span class="cupd">s</span> a <span class="cupd">f</span>allback r<span class="cupd">e</span>ve<span class="cupd">r</span>t <span class="cupd">r</span>easo<span class="cupd">n</span><span class="cupd"> </span><span class="cupd">w</span>h<span class="cupd">e</span>n<span class="cupd"> </span><span class="cupd">`target`</span><span class="cupd"> </span><span class="cupd">re</span>v<span class="cupd">e</span>r<span class="cupd">ts</span>.<span class="cupd">
     *
     * </span>_Av<span class="cupd">a</span><span class="cupd">i</span>l<span class="cupd">a</span><span class="cupd">b</span><span class="cupd">l</span><span class="cupd">e </span><span class="cupd">s</span><span class="cupd">i</span><span class="cupd">nc</span><span class="cupd">e </span>v3<span class="cupd">.</span>1._<span class="cupd">
     */</span></span>
    function functionCallWithValue(
        address target,
        bytes memory data,
        uint256 value<span class="marker" id="mapping-53"></span><span class="token del" data-title="function_definition/,">,</span>
        <span class="marker" id="mapping-54"></span><span class="token del" data-title="function_definition/parameter">string memory errorMessage</span>
    ) internal returns (bytes memory) {
        <span class="marker" id="mapping-55"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-56"></span><span class="token del" data-title="expression_statement/call_expression">require(<span class="marker" id="mapping-57"></span><span class="token del" data-title="call_expression/call_argument"><span class="marker" id="mapping-58"></span><span class="token mv" id="move-src-15" data-title="call_argument/binary_expression">address(this).balance <span class="marker" id="mapping-59"></span><span class="token del" data-title="binary_expression/>=">&gt;=</span> value</span></span>, <span class="marker" id="mapping-60"></span><span class="token del" data-title="call_expression/call_argument">"Address: insufficient balance for call"</span>)</span>;</span>
        <span class="marker" id="mapping-61"></span><span class="token del" data-title="function_body/expression_statement">require(isContract(target), "Address: call to non-contract");</span>

        (bool success, bytes memory returndata) = target.call{value: value}(data);
        return <span class="marker" id="mapping-62"></span><span class="token upd" id="move-src-16" data-title="call_expression/identifier"><span class="cupd">verifyCallResult</span></span>(<span class="marker" id="mapping-63"></span><span class="token mv" id="move-src-17" data-title="call_expression/call_argument">success</span>, <span class="marker" id="mapping-64"></span><span class="token mv" id="move-src-18" data-title="call_expression/call_argument">returndata</span>, <span class="marker" id="mapping-65"></span><span class="token del" data-title="call_expression/call_argument">errorMessage</span>);
    }

    <span class="marker" id="mapping-66"></span><span class="token upd" id="move-src-19" data-title="contract_body/comment"><span class="cupd">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but performing a static call.
     *</span>
     * _Available since v3.3._
     */</span>
    <span class="marker" id="mapping-67"></span><span class="token del" data-title="contract_body/function_definition">function functionStaticCall(<span class="marker" id="mapping-68"></span><span class="token del" data-title="function_definition/parameter">address target</span>, <span class="marker" id="mapping-69"></span><span class="token del" data-title="function_definition/parameter">bytes memory data</span>) <span class="marker" id="mapping-70"></span><span class="token del" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-71"></span><span class="token mv" id="move-src-20" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-72"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bytes memory)</span> <span class="marker" id="mapping-73"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-74"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-75"></span><span class="token del" data-title="return_statement/call_expression">functionStaticCall(<span class="marker" id="mapping-76"></span><span class="token mv" id="move-src-21" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-77"></span><span class="token del" data-title="call_expression/call_argument">data</span>, <span class="marker" id="mapping-78"></span><span class="token del" data-title="call_expression/call_argument">"Address: low-level static call failed"</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-79"></span><span class="token mv" id="move-src-22" data-title="contract_body/comment"><span class="marker" id="mapping-80"></span><span class="token upd" id="move-src-23" data-title="contract_body/comment"><span class="cupd">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-</span>string-<span class="cupd">}[`functionCall`],
     * but performing a </span>st<span class="cupd">at</span>ic<span class="cupd"> call.
     *</span>
     * _Available since v3.3._
     */</span></span>
    function functionStaticCall(
        address target,
        bytes memory data<span class="marker" id="mapping-81"></span><span class="token del" data-title="function_definition/,">,</span>
        <span class="marker" id="mapping-82"></span><span class="token del" data-title="function_definition/parameter">string memory errorMessage</span>
    ) internal view returns (bytes memory) {
        <span class="marker" id="mapping-83"></span><span class="token del" data-title="function_body/expression_statement">require(isContract(target), "Address: static call to non-contract");</span>

        (bool success, bytes memory returndata) = target.staticcall(data);
        return <span class="marker" id="mapping-84"></span><span class="token upd" id="move-src-24" data-title="call_expression/identifier"><span class="cupd">verifyCallResult</span></span>(<span class="marker" id="mapping-85"></span><span class="token mv" id="move-src-25" data-title="call_expression/call_argument">success</span>, <span class="marker" id="mapping-86"></span><span class="token mv" id="move-src-26" data-title="call_expression/call_argument">returndata</span>, <span class="marker" id="mapping-87"></span><span class="token del" data-title="call_expression/call_argument">errorMessage</span>);
    }

    <span class="marker" id="mapping-88"></span><span class="token upd" id="move-src-27" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>S<span class="cupd">a</span>m<span class="cupd">e</span><span class="cupd"> </span><span class="cupd">a</span><span class="cupd">s</span> {x<span class="cupd">r</span>ef<span class="cupd">-</span>Add<span class="cupd">r</span><span class="cupd">ess</span>-<span class="cupd">fu</span>nctionCa<span class="cupd">l</span>l-<span class="cupd">a</span><span class="cupd">d</span>d<span class="cupd">re</span>ss-by<span class="cupd">t</span>e<span class="cupd">s</span>-}[`<span class="cupd">f</span>unc<span class="cupd">t</span>ionC<span class="cupd">a</span>ll`],<span class="cupd">
     * </span>bu<span class="cupd">t </span>pe<span class="cupd">r</span>f<span class="cupd">or</span>m<span class="cupd">ing </span>a<span class="cupd"> </span>d<span class="cupd">e</span>l<span class="cupd">e</span>ga<span class="cupd">t</span><span class="cupd">e</span><span class="cupd"> </span>c<span class="cupd">all</span>.<span class="cupd">
</span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span>*<span class="cupd">
</span><span class="cupd">     </span><span class="cupd">* </span>_Available <span class="cupd">s</span>in<span class="cupd">c</span><span class="cupd">e</span><span class="cupd"> </span>v3<span class="cupd">.</span>4._<span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-89"></span><span class="token del" data-title="contract_body/function_definition">function functionDelegateCall(<span class="marker" id="mapping-90"></span><span class="token mv" id="move-src-28" data-title="function_definition/parameter">address target</span>, <span class="marker" id="mapping-91"></span><span class="token del" data-title="function_definition/parameter">bytes memory data</span>) <span class="marker" id="mapping-92"></span><span class="token mv" id="move-src-29" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-93"></span><span class="token mv" id="move-src-30" data-title="function_definition/return_type_definition">returns (bytes memory)</span> <span class="marker" id="mapping-94"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-95"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-96"></span><span class="token del" data-title="return_statement/call_expression">functionDelegateCall(<span class="marker" id="mapping-97"></span><span class="token mv" id="move-src-31" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-98"></span><span class="token del" data-title="call_expression/call_argument">data</span>, <span class="marker" id="mapping-99"></span><span class="token del" data-title="call_expression/call_argument">"Address: low-level delegate call failed"</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-100"></span><span class="token upd" id="move-src-32" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Sam<span class="cupd">e</span><span class="cupd"> </span><span class="cupd">a</span>s<span class="cupd"> </span>{xr<span class="cupd">e</span>f-Addr<span class="cupd">e</span>ss-fun<span class="cupd">c</span>tionC<span class="cupd">all</span>-<span class="cupd">a</span>ddre<span class="cupd">s</span><span class="cupd">s</span>-byt<span class="cupd">es</span>-<span class="cupd">s</span>tring-}[`<span class="cupd">fu</span>nctionCa<span class="cupd">l</span>l`]<span class="cupd">,
</span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span>*<span class="cupd"> b</span><span class="cupd">u</span>t perform<span class="cupd">ing </span>a delega<span class="cupd">t</span><span class="cupd">e </span>call.<span class="cupd">
    </span> <span class="cupd">*
</span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span><span class="cupd"> </span>*<span class="cupd"> </span>_Av<span class="cupd">ail</span><span class="cupd">a</span>b<span class="cupd">l</span>e<span class="cupd"> </span>sinc<span class="cupd">e</span> v3<span class="cupd">.</span>4._<span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-101"></span><span class="token mv" id="move-src-33" data-title="contract_body/function_definition">function functionDelegateCall(
        address target,
        bytes memory data<span class="marker" id="mapping-102"></span><span class="token del" data-title="function_definition/,">,</span>
        <span class="marker" id="mapping-103"></span><span class="token del" data-title="function_definition/parameter">string memory errorMessage</span>
    ) internal returns (bytes memory) {
        <span class="marker" id="mapping-104"></span><span class="token del" data-title="function_body/expression_statement">require(isContract(target), "Address: delegate call to non-contract");</span>

        (bool success, bytes memory returndata) = target.delegatecall(data);
        return <span class="marker" id="mapping-105"></span><span class="token upd" id="move-src-34" data-title="call_expression/identifier"><span class="cupd">verifyCallResult</span></span>(<span class="marker" id="mapping-106"></span><span class="token mv" id="move-src-35" data-title="call_expression/call_argument">success</span>, <span class="marker" id="mapping-107"></span><span class="token mv" id="move-src-36" data-title="call_expression/call_argument">returndata</span>, <span class="marker" id="mapping-108"></span><span class="token del" data-title="call_expression/call_argument">errorMessage</span>);
    }</span>

    <span class="marker" id="mapping-109"></span><span class="token upd" id="move-src-37" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Tool to <span class="cupd">ver</span>ifie<span class="cupd">s </span><span class="cupd">th</span>at<span class="cupd"> </span>a low l<span class="cupd">e</span>vel call was s<span class="cupd">u</span>ccessful, a<span class="cupd">nd</span> rever<span class="cupd">t</span><span class="cupd"> if </span>it wa<span class="cupd">s</span><span class="cupd">n</span>'<span class="cupd">t</span>,<span class="cupd"> </span>ei<span class="cupd">ther</span> by bubbl<span class="cupd">i</span>ng th<span class="cupd">e
</span>     * <span class="cupd">revert</span> rea<span class="cupd">s</span>on<span class="cupd"> </span>us<span class="cupd">i</span>ng <span class="cupd">th</span>e<span class="cupd"> </span>prov<span class="cupd">i</span>d<span class="cupd">ed</span> o<span class="cupd">n</span><span class="cupd">e</span>.
     *
     * _Av<span class="cupd">a</span>i<span class="cupd">l</span>ab<span class="cupd">l</span>e since v4<span class="cupd">.</span>3._<span class="cupd">
     */</span></span>
    function <span class="marker" id="mapping-110"></span><span class="token upd" id="move-src-38" data-title="function_definition/identifier"><span class="cupd">ver</span>ifyCallResult</span>(
        <span class="marker" id="mapping-111"></span><span class="token mv" id="move-src-39" data-title="function_definition/parameter">bool success</span><span class="marker" id="mapping-112"></span><span class="token del" data-title="function_definition/,">,</span>
        bytes memory returndata<span class="marker" id="mapping-113"></span><span class="token del" data-title="function_definition/,">,</span>
        <span class="marker" id="mapping-114"></span><span class="token del" data-title="function_definition/parameter">string memory errorMessage</span>
    ) <span class="marker" id="mapping-115"></span><span class="token mv" id="move-src-40" data-title="function_definition/visibility">internal</span> pure <span class="marker" id="mapping-116"></span><span class="token mv" id="move-src-41" data-title="function_definition/return_type_definition">returns (bytes memory)</span> {
        <span class="marker" id="mapping-117"></span><span class="token del" data-title="function_body/if_statement">if (success) <span class="marker" id="mapping-118"></span><span class="token mv" id="move-src-42" data-title="if_statement/block_statement">{
            return returndata;
        }</span> else <span class="marker" id="mapping-119"></span><span class="token del" data-title="if_statement/block_statement">{
            // Look for revert reason and bubble it up if present
            <span class="marker" id="mapping-120"></span><span class="token mv" id="move-src-43" data-title="block_statement/if_statement">if (returndata.length &gt; 0) {
                // The easiest way to bubble the revert reason is using memory via assembly

                assembly {
                    let returndata_size := mload(returndata)
                    revert(add(32, returndata), returndata_size)
                }
            } else {
                revert<span class="marker" id="mapping-121"></span><span class="token del" data-title="revert_statement/parenthesized_expression">(errorMessage)</span>;
            }</span>
        }</span></span>
    }
}
</pre></div><div class="col-6"><h5>Address.sol</h5><pre class="pre-scrollable">// SPDX-License-Identifier: MIT
<span class="marker" id="mapping-122"></span><span class="token upd" id="move-dst-1" data-title="source_file/comment"><span class="cupd">// OpenZeppelin Contracts </span>(last updated <span class="cupd">v</span>5<span class="cupd">.</span>0<span class="cupd">.</span>0)<span class="cupd"> (utils/Address.sol)</span></span>

pragma solidity ^<span class="marker" id="mapping-123"></span><span class="token upd" id="move-dst-2" data-title="solidity_pragma_token/solidity_version"><span class="cupd">0.8.</span>20</span>;

/**
 * @dev Collection of functions related to the address type
 */
library Address {
    <span class="marker" id="mapping-124"></span><span class="token upd" id="move-dst-3" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Th<span class="cupd">e</span><span class="cupd"> </span>ETH<span class="cupd"> </span>b<span class="cupd">a</span>l<span class="cupd">a</span><span class="cupd">n</span><span class="cupd">c</span><span class="cupd">e </span><span class="cupd">o</span><span class="cupd">f</span><span class="cupd"> </span><span class="cupd">th</span><span class="cupd">e</span><span class="cupd"> </span><span class="cupd">a</span><span class="cupd">ccount </span>is<span class="cupd"> </span><span class="cupd">n</span><span class="cupd">ot </span>e<span class="cupd">n</span><span class="cupd">o</span>u<span class="cupd">g</span>h<span class="cupd"> </span><span class="cupd">t</span><span class="cupd">o</span><span class="cupd"> </span>p<span class="cupd">e</span><span class="cupd">r</span><span class="cupd">f</span><span class="cupd">or</span>m<span class="cupd"> the </span><span class="cupd">o</span><span class="cupd">pe</span><span class="cupd">r</span><span class="cupd">a</span><span class="cupd">t</span><span class="cupd">i</span><span class="cupd">on</span>.<span class="cupd">
     *</span>/</span>
    <span class="marker" id="mapping-125"></span><span class="token add" data-title="contract_body/error_declaration">error AddressInsufficientBalance(<span class="marker" id="mapping-126"></span><span class="token add" data-title="error_declaration/error_parameter"><span class="marker" id="mapping-127"></span><span class="token mv" id="move-dst-4" data-title="error_parameter/type_name">address</span> account</span>);</span>

    <span class="marker" id="mapping-128"></span><span class="token upd" id="move-dst-5" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Th<span class="cupd">e</span>r<span class="cupd">e</span><span class="cupd">'s </span><span class="cupd">n</span><span class="cupd">o</span><span class="cupd"> </span><span class="cupd">c</span><span class="cupd">o</span><span class="cupd">d</span><span class="cupd">e </span><span class="cupd">a</span><span class="cupd">t</span><span class="cupd"> </span><span class="cupd">`t</span><span class="cupd">a</span><span class="cupd">r</span><span class="cupd">g</span><span class="cupd">e</span><span class="cupd">t</span><span class="cupd">`</span><span class="cupd"> </span>(<span class="cupd">i</span><span class="cupd">t</span><span class="cupd"> </span><span class="cupd">i</span><span class="cupd">s</span><span class="cupd"> </span><span class="cupd">n</span><span class="cupd">o</span><span class="cupd">t</span><span class="cupd"> </span><span class="cupd">a</span><span class="cupd"> </span><span class="cupd">c</span><span class="cupd">on</span><span class="cupd">tra</span><span class="cupd">c</span><span class="cupd">t</span>)<span class="cupd">.</span><span class="cupd">
</span><span class="cupd">     </span><span class="cupd">*/</span></span>
    <span class="marker" id="mapping-129"></span><span class="token add" data-title="contract_body/error_declaration">error AddressEmptyCode(address target);</span>

    <span class="marker" id="mapping-130"></span><span class="token upd" id="move-dst-8" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span><span class="cupd">A </span><span class="cupd">call</span><span class="cupd"> </span><span class="cupd">t</span><span class="cupd">o</span><span class="cupd"> a</span><span class="cupd">n</span><span class="cupd"> </span><span class="cupd">a</span>ddr<span class="cupd">e</span><span class="cupd">s</span><span class="cupd">s</span><span class="cupd"> </span><span class="cupd">target</span><span class="cupd"> </span><span class="cupd">f</span><span class="cupd">a</span><span class="cupd">i</span><span class="cupd">l</span><span class="cupd">e</span><span class="cupd">d</span><span class="cupd">. T</span><span class="cupd">he </span><span class="cupd">t</span><span class="cupd">a</span><span class="cupd">r</span><span class="cupd">g</span><span class="cupd">e</span><span class="cupd">t</span><span class="cupd"> </span><span class="cupd">m</span><span class="cupd">a</span>y<span class="cupd"> </span>h<span class="cupd">a</span>v<span class="cupd">e</span><span class="cupd"> </span><span class="cupd">revert</span><span class="cupd">e</span>d<span class="cupd">.</span><span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-131"></span><span class="token add" data-title="contract_body/error_declaration">error FailedInnerCall();</span>

    <span class="marker" id="mapping-132"></span><span class="token upd" id="move-dst-10" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Repl<span class="cupd">a</span>ce<span class="cupd">me</span>nt<span class="cupd"> </span>for Solidity'<span class="cupd">s </span>`t<span class="cupd">r</span>ansf<span class="cupd">e</span><span class="cupd">r</span>`: s<span class="cupd">e</span>nd<span class="cupd">s</span> `amo<span class="cupd">un</span><span class="cupd">t</span>` we<span class="cupd">i</span> t<span class="cupd">o</span>
     * `recipie<span class="cupd">n</span>t`, forw<span class="cupd">a</span>rding a<span class="cupd">ll</span> <span class="cupd">a</span>vailable gas an<span class="cupd">d</span> <span class="cupd">re</span>verting on error<span class="cupd">s</span>.
     *
     * http<span class="cupd">s</span>://eips.e<span class="cupd">t</span>h<span class="cupd">e</span>reum.org/EIPS/eip<span class="cupd">-</span>1884<span class="cupd">[</span>EIP1884] i<span class="cupd">nc</span>reases <span class="cupd">t</span>he gas cost
     * of certa<span class="cupd">i</span>n <span class="cupd">o</span>pcodes, possibly maki<span class="cupd">n</span>g contr<span class="cupd">a</span>cts go over the 2300 gas <span class="cupd">l</span>imit<span class="cupd">
</span>     * imposed <span class="cupd">b</span>y `<span class="cupd">t</span>ransfer`,<span class="cupd"> </span>mak<span class="cupd">i</span>ng <span class="cupd">th</span>em<span class="cupd"> </span>unable<span class="cupd"> </span>to<span class="cupd"> </span>receive<span class="cupd"> </span>funds<span class="cupd"> </span>via<span class="cupd">
</span>     <span class="cupd">* `</span>transf<span class="cupd">er</span>`. {sendValue} <span class="cupd">r</span>em<span class="cupd">o</span>v<span class="cupd">es</span> thi<span class="cupd">s</span> limit<span class="cupd">a</span>tion.
     *
     * https://consensys.net/dili<span class="cupd">ge</span>nce/blog/2019/09/stop-using-soliditys-tr<span class="cupd">a</span>n<span class="cupd">s</span>fer-now/[Le<span class="cupd">a</span>rn<span class="cupd"> </span>more].
     *
     * IMPORTANT: <span class="cupd">b</span>ec<span class="cupd">a</span>use <span class="cupd">c</span>ontrol<span class="cupd"> </span>is t<span class="cupd">r</span>ansf<span class="cupd">e</span>rr<span class="cupd">e</span>d to `<span class="cupd">r</span>ecipien<span class="cupd">t</span>`,<span class="cupd"> </span>ca<span class="cupd">re</span> mu<span class="cupd">s</span>t<span class="cupd"> </span>b<span class="cupd">e</span>
     * take<span class="cupd">n </span><span class="cupd">t</span>o not c<span class="cupd">r</span><span class="cupd">e</span>a<span class="cupd">t</span>e<span class="cupd"> re</span>entrancy <span class="cupd">v</span>uln<span class="cupd">er</span>abili<span class="cupd">t</span>ie<span class="cupd">s. </span>Consider<span class="cupd"> </span>using<span class="cupd">
   </span>  <span class="cupd">* </span>{ReentrancyGuard}<span class="cupd"> </span>or<span class="cupd"> </span>the<span class="cupd">
  </span>   <span class="cupd">* </span>https://solidity.readthedocs.io/en/<span class="cupd">v</span>0.8.20/security-consider<span class="cupd">a</span>t<span class="cupd">i</span>ons.htm<span class="cupd">l</span>#use-the-checks-effects-inter<span class="cupd">a</span>ctions-patt<span class="cupd">e</span>rn[check<span class="cupd">s</span>-effects-<span class="cupd">in</span>tera<span class="cupd">c</span>tions patt<span class="cupd">e</span>rn]<span class="cupd">.</span><span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-133"></span><span class="token mv" id="move-dst-6" data-title="contract_body/function_definition">function sendValue(address payable recipient, uint256 amount) internal {
        <span class="marker" id="mapping-134"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-135"></span><span class="token mv" id="move-dst-7" data-title="if_statement/binary_expression">address(this).balance <span class="marker" id="mapping-136"></span><span class="token add" data-title="binary_expression/<">&lt;</span> amount</span>) <span class="marker" id="mapping-137"></span><span class="token add" data-title="if_statement/block_statement">{
            revert AddressInsufficientBalance(address(this));
        }</span></span>

        (bool success, ) = recipient.call{value: amount}("");
        <span class="marker" id="mapping-138"></span><span class="token add" data-title="function_body/if_statement">if (!success) {
            revert FailedInnerCall();
        }</span>
    }</span>

    <span class="marker" id="mapping-139"></span><span class="token upd" id="move-dst-12" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Perfor<span class="cupd">m</span>s<span class="cupd"> a</span><span class="cupd"> </span>Soli<span class="cupd">d</span>ity <span class="cupd">function</span> c<span class="cupd">all</span> using <span class="cupd">a</span> low l<span class="cupd">e</span>v<span class="cupd">e</span>l <span class="cupd">`</span><span class="cupd">c</span><span class="cupd">all`</span>.<span class="cupd"> </span>A<span class="cupd">
    </span> <span class="cupd">* </span>plain<span class="cupd"> </span>`c<span class="cupd">al</span>l` i<span class="cupd">s</span><span class="cupd"> </span><span class="cupd">an</span> un<span class="cupd">s</span>a<span class="cupd">fe</span> <span class="cupd">r</span>eplacement fo<span class="cupd">r</span> a funct<span class="cupd">i</span>o<span class="cupd">n</span><span class="cupd"> </span>c<span class="cupd">al</span>l: <span class="cupd">u</span>s<span class="cupd">e</span><span class="cupd"> </span>th<span class="cupd">i</span>s<span class="cupd">
</span>     * func<span class="cupd">t</span>i<span class="cupd">o</span>n<span class="cupd"> </span>ins<span class="cupd">t</span>e<span class="cupd">a</span>d<span class="cupd">.
     *
     * </span>If `targ<span class="cupd">e</span>t` reverts w<span class="cupd">i</span>th a <span class="cupd">re</span>v<span class="cupd">e</span>rt reaso<span class="cupd">n</span> or cus<span class="cupd">t</span>om error, it i<span class="cupd">s</span><span class="cupd"> </span>bubbled<span class="cupd">
    </span> <span class="cupd">* </span>up<span class="cupd"> </span>by<span class="cupd"> </span>this<span class="cupd"> </span>function<span class="cupd"> </span>(like<span class="cupd"> </span>regular<span class="cupd"> </span>Solidity<span class="cupd"> </span>func<span class="cupd">t</span>ion calls). However, if
     * t<span class="cupd">he call</span> reverted w<span class="cupd">i</span>th <span class="cupd">n</span>o<span class="cupd"> </span>returned reason, this fun<span class="cupd">c</span>ti<span class="cupd">on</span> rever<span class="cupd">t</span>s with a
     * {FailedInne<span class="cupd">r</span>C<span class="cupd">a</span>ll} error.
     *
     * Re<span class="cupd">t</span><span class="cupd">u</span>rn<span class="cupd">s</span> <span class="cupd">t</span><span class="cupd">h</span><span class="cupd">e </span>r<span class="cupd">a</span>w retur<span class="cupd">n</span>ed<span class="cupd"> </span>data. <span class="cupd">T</span>o<span class="cupd"> </span>co<span class="cupd">n</span>v<span class="cupd">e</span>rt<span class="cupd"> </span>t<span class="cupd">o</span><span class="cupd"> </span><span class="cupd">t</span>he<span class="cupd"> </span><span class="cupd">e</span>xpec<span class="cupd">t</span>ed<span class="cupd"> </span>return <span class="cupd">value</span>,<span class="cupd">
     * </span>use<span class="cupd"> </span>h<span class="cupd">t</span>tps://solidity.readt<span class="cupd">he</span>do<span class="cupd">c</span>s.io/en/l<span class="cupd">a</span>test/units-and-g<span class="cupd">l</span>oba<span class="cupd">l</span>-variabl<span class="cupd">e</span>s.html?highlight=abi.<span class="cupd">d</span>ec<span class="cupd">o</span>de#ab<span class="cupd">i</span>-enco<span class="cupd">di</span>ng-and-decoding-<span class="cupd">function</span><span class="cupd">s</span>[<span class="cupd">`</span><span class="cupd">a</span><span class="cupd">b</span>i.d<span class="cupd">e</span>code<span class="cupd">`</span>]<span class="cupd">.
     *
     * </span>Requ<span class="cupd">i</span>rements:
     *
     * - `t<span class="cupd">a</span>rget` must <span class="cupd">b</span>e a contract.
     * - ca<span class="cupd">l</span>ling `targ<span class="cupd">e</span>t`<span class="cupd"> </span>with `data` mu<span class="cupd">s</span>t <span class="cupd">n</span>ot r<span class="cupd">e</span><span class="cupd">v</span>ert<span class="cupd">.</span><span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-140"></span><span class="token mv" id="move-dst-11" data-title="contract_body/function_definition">function functionCall(address target, bytes memory data) internal returns (bytes memory) {
        return functionCallWithValue(target, data, 0);
    }</span>

    <span class="marker" id="mapping-141"></span><span class="token upd" id="move-dst-14" data-title="contract_body/comment"><span class="cupd">/**
     * @dev Same as {xref-Address-functionCall</span><span class="cupd">-address-bytes-</span><span class="cupd">}[`functionCall</span><span class="cupd">`],
</span><span class="cupd">     </span><span class="cupd">* </span>bu<span class="cupd">t</span><span class="cupd"> </span>als<span class="cupd">o</span> t<span class="cupd">r</span><span class="cupd">a</span>n<span class="cupd">s</span><span class="cupd">f</span><span class="cupd">e</span><span class="cupd">r</span><span class="cupd">r</span>i<span class="cupd">n</span>g<span class="cupd"> </span>`value` <span class="cupd">w</span><span class="cupd">e</span>i<span class="cupd"> </span>to <span class="cupd">`target`</span>.<span class="cupd">
</span>     *
     * Requi<span class="cupd">re</span>m<span class="cupd">e</span>n<span class="cupd">ts</span>:<span class="cupd">
     *
     * </span>- the c<span class="cupd">a</span>ll<span class="cupd">i</span>ng contr<span class="cupd">a</span>ct must have an ETH <span class="cupd">b</span>a<span class="cupd">l</span>anc<span class="cupd">e </span>of at lea<span class="cupd">s</span>t `value`.
     * - the called Sol<span class="cupd">i</span>dity fu<span class="cupd">nc</span>tion must b<span class="cupd">e </span>`payable`<span class="cupd">.</span><span class="cupd">
     */</span></span>
    function functionCallWithValue(address target, bytes memory data, uint256 value) internal returns (bytes memory) {
        <span class="marker" id="mapping-142"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-143"></span><span class="token mv" id="move-dst-15" data-title="if_statement/binary_expression">address(this).balance <span class="marker" id="mapping-144"></span><span class="token add" data-title="binary_expression/<">&lt;</span> value</span>) <span class="marker" id="mapping-145"></span><span class="token add" data-title="if_statement/block_statement">{
            revert AddressInsufficientBalance(address(this));
        }</span></span>
        (bool success, bytes memory returndata) = target.call{value: value}(data);
        return <span class="marker" id="mapping-146"></span><span class="token upd" id="move-dst-16" data-title="call_expression/identifier"><span class="cupd">verifyCallResult</span>FromTarget</span>(<span class="marker" id="mapping-147"></span><span class="token mv" id="move-dst-13" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-148"></span><span class="token mv" id="move-dst-17" data-title="call_expression/call_argument">success</span>, <span class="marker" id="mapping-149"></span><span class="token mv" id="move-dst-18" data-title="call_expression/call_argument">returndata</span>);
    }

    <span class="marker" id="mapping-150"></span><span class="token upd" id="move-dst-19" data-title="contract_body/comment"><span class="cupd">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-}[`functionCall`],
     * but performing a static call.
     *</span>/</span>
    function functionStaticCall(address target, bytes memory data) internal view returns (bytes memory) {
        (bool success, bytes memory returndata) = target.staticcall(data);
        return <span class="marker" id="mapping-151"></span><span class="token upd" id="move-dst-24" data-title="call_expression/identifier"><span class="cupd">verifyCallResult</span>FromTarget</span>(<span class="marker" id="mapping-152"></span><span class="token mv" id="move-dst-21" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-153"></span><span class="token mv" id="move-dst-25" data-title="call_expression/call_argument">success</span>, <span class="marker" id="mapping-154"></span><span class="token mv" id="move-dst-26" data-title="call_expression/call_argument">returndata</span>);
    }

    <span class="marker" id="mapping-155"></span><span class="token mv" id="move-dst-23" data-title="contract_body/comment"><span class="marker" id="mapping-156"></span><span class="token upd" id="move-dst-23" data-title="contract_body/comment"><span class="cupd">/**
     * @dev Same as {xref-Address-functionCall-address-bytes-</span><span class="cupd">}[`functionCall`],
     * but performing a </span>deleg<span class="cupd">at</span>e<span class="cupd"> call.
     *</span>/</span></span>
    <span class="marker" id="mapping-157"></span><span class="token mv" id="move-dst-33" data-title="contract_body/function_definition">function functionDelegateCall(address target, bytes memory data) internal returns (bytes memory) {
        (bool success, bytes memory returndata) = target.delegatecall(data);
        return <span class="marker" id="mapping-158"></span><span class="token upd" id="move-dst-34" data-title="call_expression/identifier"><span class="cupd">verifyCallResult</span>FromTarget</span>(<span class="marker" id="mapping-159"></span><span class="token mv" id="move-dst-31" data-title="call_expression/call_argument">target</span>, <span class="marker" id="mapping-160"></span><span class="token mv" id="move-dst-35" data-title="call_expression/call_argument">success</span>, <span class="marker" id="mapping-161"></span><span class="token mv" id="move-dst-36" data-title="call_expression/call_argument">returndata</span>);
    }</span>

    <span class="marker" id="mapping-162"></span><span class="token upd" id="move-dst-27" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Tool to verify th<span class="cupd">a</span>t a low l<span class="cupd">e</span>vel<span class="cupd"> </span>c<span class="cupd">a</span>ll to <span class="cupd">s</span>ma<span class="cupd">r</span>t<span class="cupd">-</span>cont<span class="cupd">r</span>act was succ<span class="cupd">ess</span><span class="cupd">fu</span><span class="cupd">l</span>, <span class="cupd">a</span>n<span class="cupd">d</span> <span class="cupd">re</span>ver<span class="cupd">t</span><span class="cupd">s</span> i<span class="cupd">f</span> <span class="cupd">t</span>he t<span class="cupd">a</span>rget<span class="cupd">
     * </span>was no<span class="cupd">t </span>a cont<span class="cupd">r</span>act <span class="cupd">or</span> bubbl<span class="cupd">ing </span>up<span class="cupd"> </span>th<span class="cupd">e</span> r<span class="cupd">e</span>ver<span class="cupd">t</span> r<span class="cupd">e</span>ason<span class="cupd"> </span>(f<span class="cupd">all</span>ing<span class="cupd"> </span>back<span class="cupd"> </span>to<span class="cupd"> </span>{FailedInnerCall})<span class="cupd"> </span>in<span class="cupd"> </span>case<span class="cupd"> </span>of<span class="cupd"> </span>an<span class="cupd">
    </span> <span class="cupd">* </span>un<span class="cupd">s</span>u<span class="cupd">c</span>c<span class="cupd">e</span>ssful<span class="cupd"> </span>call<span class="cupd">.</span><span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-163"></span><span class="token add" data-title="contract_body/function_definition">function verifyCallResultFromTarget(
        <span class="marker" id="mapping-164"></span><span class="token mv" id="move-dst-28" data-title="function_definition/parameter">address target</span>,
        <span class="marker" id="mapping-165"></span><span class="token add" data-title="function_definition/parameter">bool success</span>,
        <span class="marker" id="mapping-166"></span><span class="token add" data-title="function_definition/parameter">bytes memory returndata</span>
    ) <span class="marker" id="mapping-167"></span><span class="token mv" id="move-dst-29" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-168"></span><span class="token mv" id="move-dst-20" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-169"></span><span class="token mv" id="move-dst-30" data-title="function_definition/return_type_definition">returns (bytes memory)</span> <span class="marker" id="mapping-170"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-171"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-172"></span><span class="token add" data-title="if_statement/unary_expression">!success</span>) <span class="marker" id="mapping-173"></span><span class="token add" data-title="if_statement/block_statement">{
            _revert(returndata);
        }</span> else <span class="marker" id="mapping-174"></span><span class="token add" data-title="if_statement/block_statement">{
            // only check if target is a contract if the call was successful and the return data is empty
            // otherwise we already know that it was a contract
            <span class="marker" id="mapping-175"></span><span class="token add" data-title="block_statement/if_statement">if (<span class="marker" id="mapping-176"></span><span class="token add" data-title="if_statement/binary_expression">returndata.length == 0 &amp;&amp; target.code.length == 0</span>) <span class="marker" id="mapping-177"></span><span class="token add" data-title="if_statement/block_statement">{
                <span class="marker" id="mapping-178"></span><span class="token add" data-title="block_statement/revert_statement">revert AddressEmptyCode<span class="marker" id="mapping-179"></span><span class="token add" data-title="revert_statement/revert_arguments">(<span class="marker" id="mapping-180"></span><span class="token mv" id="move-dst-9" data-title="revert_arguments/call_argument">target</span>)</span>;</span>
            }</span></span>
            <span class="marker" id="mapping-181"></span><span class="token add" data-title="block_statement/return_statement">return returndata;</span>
        }</span></span>
    }</span></span>

    <span class="marker" id="mapping-182"></span><span class="token upd" id="move-dst-32" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Tool to v<span class="cupd">e</span>rify<span class="cupd"> </span>th<span class="cupd">a</span>t<span class="cupd"> </span>a low l<span class="cupd">e</span>v<span class="cupd">e</span>l <span class="cupd">c</span><span class="cupd">all</span> w<span class="cupd">a</span><span class="cupd">s</span> <span class="cupd">s</span>ucc<span class="cupd">es</span><span class="cupd">s</span><span class="cupd">fu</span><span class="cupd">l</span><span class="cupd">, </span>and<span class="cupd"> </span>reverts<span class="cupd"> </span>if<span class="cupd"> </span>it<span class="cupd"> </span>wasn't,<span class="cupd"> </span>either<span class="cupd"> b</span>y b<span class="cupd">u</span>bbl<span class="cupd">ing </span><span class="cupd">t</span>h<span class="cupd">e
</span><span class="cupd">     </span><span class="cupd">* </span>revert<span class="cupd"> </span>reason<span class="cupd"> </span>or<span class="cupd"> </span>with<span class="cupd"> </span>a<span class="cupd"> </span>default<span class="cupd"> </span>{F<span class="cupd">ail</span>edInnerC<span class="cupd">a</span><span class="cupd">l</span>l}<span class="cupd"> </span><span class="cupd">e</span>rror<span class="cupd">.</span><span class="cupd">
     */</span></span>
    <span class="marker" id="mapping-183"></span><span class="token add" data-title="contract_body/function_definition">function verifyCallResult(<span class="marker" id="mapping-184"></span><span class="token mv" id="move-dst-39" data-title="function_definition/parameter">bool success</span>, <span class="marker" id="mapping-185"></span><span class="token add" data-title="function_definition/parameter">bytes memory returndata</span>) <span class="marker" id="mapping-186"></span><span class="token mv" id="move-dst-40" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-187"></span><span class="token add" data-title="function_definition/state_mutability">pure</span> <span class="marker" id="mapping-188"></span><span class="token mv" id="move-dst-41" data-title="function_definition/return_type_definition">returns (bytes memory)</span> <span class="marker" id="mapping-189"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-190"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-191"></span><span class="token add" data-title="if_statement/unary_expression">!success</span>) <span class="marker" id="mapping-192"></span><span class="token add" data-title="if_statement/block_statement">{
            _revert(returndata);
        }</span> else <span class="marker" id="mapping-193"></span><span class="token mv" id="move-dst-42" data-title="if_statement/block_statement">{
            return returndata;
        }</span></span>
    }</span></span>

    <span class="marker" id="mapping-194"></span><span class="token upd" id="move-dst-37" data-title="contract_body/comment"><span class="cupd">/**
     * @dev </span>Re<span class="cupd">ver</span>t<span class="cupd">s </span>wi<span class="cupd">th</span><span class="cupd"> </span>r<span class="cupd">e</span>t<span class="cupd">u</span>r<span class="cupd">nd</span>a<span class="cupd">t</span>a<span class="cupd"> if </span>pre<span class="cupd">s</span>e<span class="cupd">n</span><span class="cupd">t</span>.<span class="cupd"> </span>O<span class="cupd">ther</span>w<span class="cupd">i</span>s<span class="cupd">e </span><span class="cupd">revert</span><span class="cupd">s</span><span class="cupd"> </span>w<span class="cupd">i</span><span class="cupd">th</span><span class="cupd"> </span>{Fa<span class="cupd">i</span>l<span class="cupd">ed</span>I<span class="cupd">n</span>n<span class="cupd">e</span>rC<span class="cupd">a</span><span class="cupd">l</span><span class="cupd">l</span>}<span class="cupd">.</span><span class="cupd">
     */</span></span>
    function <span class="marker" id="mapping-195"></span><span class="token upd" id="move-dst-38" data-title="function_definition/identifier">_re<span class="cupd">ver</span>t</span>(bytes memory returndata) <span class="marker" id="mapping-196"></span><span class="token add" data-title="function_definition/visibility">private</span> pure {
        <span class="marker" id="mapping-197"></span><span class="token add" data-title="function_body/comment">// Look for revert reason and bubble it up if present</span>
        <span class="marker" id="mapping-198"></span><span class="token mv" id="move-dst-43" data-title="function_body/if_statement">if (returndata.length &gt; 0) {
            // The easiest way to bubble the revert reason is using memory via assembly
            <span class="marker" id="mapping-199"></span><span class="token add" data-title="block_statement/comment">/// @solidity memory-safe-assembly</span>
            assembly {
                let returndata_size := mload(returndata)
                revert(add(32, returndata), returndata_size)
            }
        } else {
            revert <span class="marker" id="mapping-200"></span><span class="token add" data-title="revert_statement/identifier">FailedInnerCall</span><span class="marker" id="mapping-201"></span><span class="token add" data-title="revert_statement/revert_arguments">()</span>;
        }</span>
    }
}
</pre></div></div></div></body></html>