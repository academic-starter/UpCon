<html lang="en"><head><meta charset="utf8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>GumTree</title><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"><style type="text/css">/*
 * This file is part of GumTree.
 *
 * GumTree is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * GumTree is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with GumTree.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Copyright 2011-2015 Jean-Rémy Falleri <jr.falleri@gmail.com>
 * Copyright 2011-2015 Floréal Morandat <florealm@gmail.com>
 */

.add {
	border: 1px solid black;
	background-color: MediumSeaGreen;
}

.del {
	border: 1px solid black;
	background-color: IndianRed;
}

.mv {
	border: 1px solid black;
	background-color: Plum;
}

.upd {
	border: 1px solid black;
	background-color: DarkOrange;
	font-weight: bold;
}

.cupd {
	font-weight: normal;
	color: DimGray;
}

.selected {
	background-color: Gold;
}

.marker {
	margin: 0;
	padding: 0;
}

div {
	margin: 0px;
	padding: 0px;
}

.pre-scrollable {
	margin: 0px;
	padding: 0px;
	font-size: 10pt;
	color: black;
	max-height: 90vh;
	background-color: white;
	border: 1px solid black;
	font-family: "Hack, Inconsolata", "Consolas", "Liberation Sans Regular", "DejaVu Sans Mono", monospace;
}

.tooltip-inner {
    max-width: none;
}
</style><script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script><script type="text/javascript">/*
 * This file is part of GumTree.
 *
 * GumTree is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * GumTree is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with GumTree.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Copyright 2011-2015 Jean-Rémy Falleri <jr.falleri@gmail.com>
 * Copyright 2011-2015 Floréal Morandat <florealm@gmail.com>
 */

$(function(){
    let popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'))
    let popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
      return new bootstrap.Popover(popoverTriggerEl)
    })

    $("body").keypress(function (event) {
        switch (event.which) {
            case 116:
                $('html, body').animate({scrollTop: 0}, 100);
                break;
            case 98:
                $("html, body").animate({ scrollTop: $(document).height() }, 100);
                break;
            case 113:
                window.location = "/quit";
                break;
            case 108:
                window.location = "/list";
                break;
        }
    });
});
</script><script type="text/javascript">/*
 * This file is part of GumTree.
 *
 * GumTree is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Lesser General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * GumTree is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public License
 * along with GumTree.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Copyright 2011-2015 Jean-Rémy Falleri <jr.falleri@gmail.com>
 * Copyright 2011-2015 Floréal Morandat <florealm@gmail.com>
 */

currentMapping = 0;

if (typeof String.prototype.startsWith != 'function') {
  String.prototype.startsWith = function (str){
    return this.slice(0, str.length) == str;
  };
}

function getMappedElement(eltId) {
	if (eltId.startsWith("move-src")) {
		return eltId.replace("src","dst");  	 	
  	}
  	else {
  		return eltId.replace("dst","src");
  	}
}

function nextMapping() {
	if (currentMapping == 0) {
		currentMapping = 1;
		return "#mapping-" + currentMapping.toString();
	} else {
		currentMapping++;
		
		if ($("#mapping-" + currentMapping.toString()).length > 0) {
			return "#mapping-" + currentMapping.toString();
		} else {
			currentMapping = 1;
			return "#mapping-" + currentMapping.toString();		
		}		
	}
}

function isSrc(eltId) {
	return eltId.startsWith("move-src");
}

$(function() {
    $("body").keypress(function (event) {
        switch(event.which) {
            case 110:
                const mapping = $(nextMapping());
                const pre = mapping.closest("pre");
                pre.animate({scrollTop: pre.scrollTop() + mapping.position().top - 200}, 100);
                break;
        }
    });

    // highlight
    $("span.mv.token, span.token.upd").click(function(event) {
        if ($(this).hasClass("selected")) {
            $("span.mv.token, span.token.upd").removeClass("selected");
        } else {
            $("span.mv.token, span.token.upd").removeClass("selected");
            const refElt = $("#" + getMappedElement($(this).attr("id")));
            $(this).addClass("selected");
            refElt.addClass("selected");
            const pre = refElt.closest("pre");
            console.log(pre);
            pre.animate({scrollTop: pre.scrollTop() + refElt.position().top - 200}, 100);
        }
        event.stopPropagation();
    });
    
    $("span.add.token, span.token.del").click(function(event) {
        $("span.mv.token, span.token.upd").removeClass("selected");
        event.stopPropagation();
    });

    // tooltip
    $("span.token").hover(
    	function (event) {
    		$(this).tooltip('show');
    		event.stopPropagation();
    	},
    	function (event) {
    		$(this).tooltip('hide');
    		event.stopPropagation();
    	}
    );
});
</script></head><body><div class="container-fluid"><div class="row"><div class="col"><div class="btn-toolbar justify-content-end"><div class="btn-group mr-2"><button class="btn btn-primary btn-sm" id="legend" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-html="true" data-bs-content="<span class='del'>&nbsp;&nbsp;</span> deleted<br><span class='add'>&nbsp;&nbsp;</span> added<br><span class='mv'>&nbsp;&nbsp;</span> moved<br><span class='upd';>&nbsp;&nbsp;</span> updated<br>">Legend</button><button class="btn btn-primary btn-sm" id="shortcuts" data-bs-toggle="popover" data-bs-placement="bottom" data-bs-html="true" data-bs-content="<b>q</b> quit<br><b>l</b> list<br><b>n</b> next<br><b>t</b> top<br><b>b</b> bottom">Shortcuts</button></div><div class="btn-group"><a href="/list" class="btn btn-default btn-sm btn-primary">Back</a><a href="/quit" class="btn btn-default btn-sm btn-danger">Quit</a></div></div></div></div><div class="row"><div class="col-6"><h5>0xc97787c9054c3ede4b96b74aba3f32a336045d6c.etherscan.io-TrueUSD.sol</h5><pre class="pre-scrollable">pragma solidity ^0.4.23;

// File: openzeppelin-solidity/contracts/token/ERC20/ERC20Basic.sol

/**
 * @title ERC20Basic
 * @dev Simpler version of ERC20 interface
 * @dev see https://github.com/ethereum/EIPs/issues/179
 */
contract ERC20Basic {
  function totalSupply() public view returns (uint256);
  function balanceOf(address who) public view returns (uint256);
  function transfer(address to, uint256 value) public returns (bool);
  event Transfer(address indexed from, address indexed to, uint256 value);
}

// File: openzeppelin-solidity/contracts/token/ERC20/ERC20.sol

/**
 * @title ERC20 interface
 * @dev see https://github.com/ethereum/EIPs/issues/20
 */
contract ERC20 is ERC20Basic {
  function allowance(address owner, address spender) public view returns (uint256);
  function transferFrom(address from, address to, uint256 value) public returns (bool);
  function approve(address spender, uint256 value) public returns (bool);
  event Approval(address indexed owner, address indexed spender, uint256 value);
}

// File: registry/contracts/Registry.sol

contract Registry {
    struct AttributeData {
        uint256 value;
        bytes32 notes;
        address adminAddr;
        uint256 timestamp;
    }
    
    address public owner;
    address public pendingOwner;
    bool <span class="marker" id="mapping-1"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> initialized;

    // Stores arbitrary attributes for users. An example use case is an ERC20
    // token that requires its users to go through a KYC/AML check - in this case
    // a validator can set an account's "hasPassedKYC/AML" attribute to 1 to indicate
    // that account can use the token. This mapping stores that value (1, in the
    // example) as well as which validator last set the value and at what time,
    // so that e.g. the check can be renewed at appropriate intervals.
    mapping(address =&gt; mapping(bytes32 =&gt; AttributeData)) <span class="marker" id="mapping-2"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> attributes;
    // The logic governing who is allowed to set what attributes is abstracted as
    // this accessManager, so that it may be replaced by the owner as needed

    bytes32 <span class="marker" id="mapping-3"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant WRITE_PERMISSION = keccak256("canWriteTo-");
    <span class="marker" id="mapping-4"></span><span class="token mv" id="move-src-1" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-5"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-6"></span><span class="token upd" id="move-src-2" data-title="state_variable_declaration/identifier"><span class="cupd">IS_</span>BLACKL<span class="cupd">ISTE</span>D</span> = "isBlacklisted";</span>
    <span class="marker" id="mapping-7"></span><span class="token mv" id="move-src-3" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-8"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant IS_DEPOSIT_ADDRESS = "isDepositAddress";</span> 
    <span class="marker" id="mapping-9"></span><span class="token del" data-title="contract_body/state_variable_declaration"><span class="marker" id="mapping-10"></span><span class="token mv" id="move-src-4" data-title="state_variable_declaration/type_name">bytes32</span> <span class="marker" id="mapping-11"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant IS_REGISTERED_CONTRACT = <span class="marker" id="mapping-12"></span><span class="token mv" id="move-src-5" data-title="state_variable_declaration/string_literal">"isRegisteredContract"</span>;</span> 
    <span class="marker" id="mapping-13"></span><span class="token del" data-title="contract_body/state_variable_declaration"><span class="marker" id="mapping-14"></span><span class="token mv" id="move-src-6" data-title="state_variable_declaration/type_name">bytes32</span> <span class="marker" id="mapping-15"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant HAS_PASSED_KYC_AML = <span class="marker" id="mapping-16"></span><span class="token del" data-title="state_variable_declaration/string_literal">"hasPassedKYC/AML"</span>;</span>
    <span class="marker" id="mapping-17"></span><span class="token del" data-title="contract_body/state_variable_declaration">bytes32 public constant CAN_BURN = "canBurn";</span>

    event OwnershipTransferred(
        address indexed previousOwner,
        address indexed newOwner
    );
    event SetAttribute(address indexed who, bytes32 attribute, uint256 value, bytes32 notes, address indexed adminAddr);
    event SetManager(address indexed oldManager, address indexed newManager);


    <span class="marker" id="mapping-18"></span><span class="token del" data-title="contract_body/function_definition">function initialize() <span class="marker" id="mapping-19"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-20"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-21"></span><span class="token mv" id="move-src-7" data-title="function_body/expression_statement">require(<span class="marker" id="mapping-22"></span><span class="token del" data-title="call_argument/unary_expression">!initialized</span>, "already initialized");</span>
        <span class="marker" id="mapping-23"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-24"></span><span class="token del" data-title="expression_statement/assignment_expression">owner = <span class="marker" id="mapping-25"></span><span class="token mv" id="move-src-8" data-title="assignment_expression/member_expression">msg.sender</span></span>;</span>
        <span class="marker" id="mapping-26"></span><span class="token del" data-title="function_body/expression_statement">initialized = true;</span>
    }</span></span>

    <span class="marker" id="mapping-27"></span><span class="token mv" id="move-src-9" data-title="contract_body/function_definition">function <span class="marker" id="mapping-28"></span><span class="token upd" id="move-src-10" data-title="function_definition/identifier">writeAttrib<span class="cupd">u</span>teFor</span>(<span class="marker" id="mapping-29"></span><span class="token mv" id="move-src-11" data-title="function_definition/parameter">bytes32 _attribute</span>) <span class="marker" id="mapping-30"></span><span class="token del" data-title="visibility/public">public</span> pure returns (bytes32) <span class="marker" id="mapping-31"></span><span class="token del" data-title="function_definition/function_body">{
        return keccak256(WRITE_PERMISSION ^ _attribute);
    }</span></span>

    // Allows a write if either a) the writer is that Registry's owner, or
    // b) the writer is writing to attribute foo and that writer already has
    // the canWriteTo-foo attribute set (in that same Registry)
    function confirmWrite(bytes32 _attribute, address _admin) <span class="marker" id="mapping-32"></span><span class="token del" data-title="visibility/public">public</span> view returns (bool) {
        return (_admin == owner || hasAttribute(_admin, keccak256(WRITE_PERMISSION ^ _attribute)));
    }

    // Writes are allowed only if the accessManager approves
    function setAttribute(address _who, bytes32 _attribute, uint256 _value, bytes32 _notes) public {
        require(confirmWrite(_attribute, msg.sender));
        attributes[_who][_attribute] = AttributeData(_value, _notes, msg.sender, block.timestamp);
        emit SetAttribute(_who, _attribute, _value, _notes, msg.sender);
    }

    function setAttributeValue(address _who, bytes32 _attribute, uint256 _value) public {
        require(confirmWrite(_attribute, msg.sender));
        attributes[_who][_attribute] = AttributeData(_value, "", msg.sender, block.timestamp);
        emit SetAttribute(_who, _attribute, _value, "", msg.sender);
    }

    // Returns true if the uint256 value stored for this attribute is non-zero
    function hasAttribute(address _who, bytes32 _attribute) public view returns (bool) {
        return attributes[_who][_attribute].value != 0;
    }

    <span class="marker" id="mapping-33"></span><span class="token del" data-title="contract_body/function_definition">function hasBothAttributes(<span class="marker" id="mapping-34"></span><span class="token mv" id="move-src-12" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-35"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute1</span>, <span class="marker" id="mapping-36"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute2</span>) <span class="marker" id="mapping-37"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-38"></span><span class="token mv" id="move-src-13" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-39"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-40"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who][_attribute1].value != 0 &amp;&amp; attributes[_who][_attribute2].value != 0;
    }</span></span>

    <span class="marker" id="mapping-41"></span><span class="token del" data-title="contract_body/function_definition">function hasEitherAttribute(<span class="marker" id="mapping-42"></span><span class="token mv" id="move-src-14" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-43"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute1</span>, <span class="marker" id="mapping-44"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute2</span>) <span class="marker" id="mapping-45"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-46"></span><span class="token mv" id="move-src-15" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-47"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-48"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who][_attribute1].value != 0 || attributes[_who][_attribute2].value != 0;
    }</span></span>

    <span class="marker" id="mapping-49"></span><span class="token del" data-title="contract_body/function_definition">function hasAttribute1ButNotAttribute2(<span class="marker" id="mapping-50"></span><span class="token mv" id="move-src-16" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-51"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute1</span>, <span class="marker" id="mapping-52"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute2</span>) <span class="marker" id="mapping-53"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-54"></span><span class="token mv" id="move-src-17" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-55"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-56"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who][_attribute1].value != 0 &amp;&amp; attributes[_who][_attribute2].value == 0;
    }</span></span>

    <span class="marker" id="mapping-57"></span><span class="token del" data-title="contract_body/function_definition">function bothHaveAttribute(<span class="marker" id="mapping-58"></span><span class="token mv" id="move-src-18" data-title="function_definition/parameter"><span class="marker" id="mapping-59"></span><span class="token mv" id="move-src-19" data-title="parameter/type_name">address</span> <span class="marker" id="mapping-60"></span><span class="token upd" id="move-src-20" data-title="parameter/identifier">_who1</span></span>, <span class="marker" id="mapping-61"></span><span class="token del" data-title="function_definition/parameter"><span class="marker" id="mapping-62"></span><span class="token mv" id="move-src-21" data-title="parameter/type_name">address</span> _who2</span>, <span class="marker" id="mapping-63"></span><span class="token mv" id="move-src-22" data-title="function_definition/parameter">bytes32 _attribute</span>) <span class="marker" id="mapping-64"></span><span class="token mv" id="move-src-23" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-65"></span><span class="token mv" id="move-src-24" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-66"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-67"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who1][_attribute].value != 0 &amp;&amp; attributes[_who2][_attribute].value != 0;
    }</span></span>
    
    <span class="marker" id="mapping-68"></span><span class="token del" data-title="contract_body/function_definition">function eitherHaveAttribute(<span class="marker" id="mapping-69"></span><span class="token del" data-title="function_definition/parameter"><span class="marker" id="mapping-70"></span><span class="token mv" id="move-src-25" data-title="parameter/type_name">address</span> _who1</span>, <span class="marker" id="mapping-71"></span><span class="token del" data-title="function_definition/parameter"><span class="marker" id="mapping-72"></span><span class="token mv" id="move-src-26" data-title="parameter/type_name">address</span> _who2</span>, <span class="marker" id="mapping-73"></span><span class="token mv" id="move-src-27" data-title="function_definition/parameter">bytes32 _attribute</span>) <span class="marker" id="mapping-74"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-75"></span><span class="token mv" id="move-src-28" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-76"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-77"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who1][_attribute].value != 0 || attributes[_who2][_attribute].value != 0;
    }</span></span>

    <span class="marker" id="mapping-78"></span><span class="token del" data-title="contract_body/function_definition">function haveAttributes(<span class="marker" id="mapping-79"></span><span class="token del" data-title="function_definition/parameter"><span class="marker" id="mapping-80"></span><span class="token mv" id="move-src-29" data-title="parameter/type_name">address</span> _who1</span>, <span class="marker" id="mapping-81"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute1</span>, <span class="marker" id="mapping-82"></span><span class="token del" data-title="function_definition/parameter">address _who2</span>, <span class="marker" id="mapping-83"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute2</span>) <span class="marker" id="mapping-84"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-85"></span><span class="token mv" id="move-src-30" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-86"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-87"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who1][_attribute1].value != 0 &amp;&amp; attributes[_who2][_attribute2].value != 0;
    }</span></span>

    <span class="marker" id="mapping-88"></span><span class="token del" data-title="contract_body/function_definition">function haveEitherAttribute(<span class="marker" id="mapping-89"></span><span class="token del" data-title="function_definition/parameter">address _who1</span>, <span class="marker" id="mapping-90"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute1</span>, <span class="marker" id="mapping-91"></span><span class="token del" data-title="function_definition/parameter">address _who2</span>, <span class="marker" id="mapping-92"></span><span class="token del" data-title="function_definition/parameter">bytes32 _attribute2</span>) <span class="marker" id="mapping-93"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-94"></span><span class="token mv" id="move-src-31" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-95"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-96"></span><span class="token del" data-title="function_definition/function_body">{
        return attributes[_who1][_attribute1].value != 0 || attributes[_who2][_attribute2].value != 0;
    }</span></span>

    <span class="marker" id="mapping-97"></span><span class="token del" data-title="contract_body/function_definition">function isDepositAddress(<span class="marker" id="mapping-98"></span><span class="token mv" id="move-src-32" data-title="function_definition/parameter">address _who</span>) <span class="marker" id="mapping-99"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-100"></span><span class="token mv" id="move-src-33" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-101"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-102"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-103"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-104"></span><span class="token del" data-title="return_statement/binary_expression"><span class="marker" id="mapping-105"></span><span class="token del" data-title="binary_expression/member_expression"><span class="marker" id="mapping-106"></span><span class="token del" data-title="member_expression/array_access"><span class="marker" id="mapping-107"></span><span class="token mv" id="move-src-34" data-title="array_access/array_access"><span class="marker" id="mapping-108"></span><span class="token del" data-title="array_access/identifier">attributes</span>[address(uint256(<span class="marker" id="mapping-109"></span><span class="token mv" id="move-src-35" data-title="type_cast_expression/call_argument">_who</span>) &gt;&gt; 20)]</span>[IS_DEPOSIT_ADDRESS]</span>.value</span> != 0</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-110"></span><span class="token del" data-title="contract_body/function_definition">function getDepositAddress(<span class="marker" id="mapping-111"></span><span class="token mv" id="move-src-36" data-title="function_definition/parameter">address _who</span>) <span class="marker" id="mapping-112"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-113"></span><span class="token mv" id="move-src-37" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-114"></span><span class="token del" data-title="function_definition/return_type_definition">returns (address)</span> <span class="marker" id="mapping-115"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-116"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-117"></span><span class="token del" data-title="return_statement/type_cast_expression"><span class="marker" id="mapping-118"></span><span class="token mv" id="move-src-38" data-title="type_cast_expression/primitive_type">address</span>(<span class="marker" id="mapping-119"></span><span class="token del" data-title="type_cast_expression/call_argument"><span class="marker" id="mapping-120"></span><span class="token del" data-title="call_argument/member_expression"><span class="marker" id="mapping-121"></span><span class="token del" data-title="member_expression/array_access"><span class="marker" id="mapping-122"></span><span class="token del" data-title="array_access/array_access">attributes[<span class="marker" id="mapping-123"></span><span class="token del" data-title="array_access/type_cast_expression"><span class="marker" id="mapping-124"></span><span class="token mv" id="move-src-39" data-title="type_cast_expression/primitive_type">address</span>(<span class="marker" id="mapping-125"></span><span class="token del" data-title="type_cast_expression/call_argument"><span class="marker" id="mapping-126"></span><span class="token mv" id="move-src-40" data-title="call_argument/binary_expression">uint256(<span class="marker" id="mapping-127"></span><span class="token mv" id="move-src-41" data-title="type_cast_expression/call_argument">_who</span>) <span class="marker" id="mapping-128"></span><span class="token del" data-title="binary_expression/>>">&gt;&gt;</span> <span class="marker" id="mapping-129"></span><span class="token del" data-title="binary_expression/number_literal">20</span></span></span>)</span>]</span>[IS_DEPOSIT_ADDRESS]</span>.value</span></span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-130"></span><span class="token mv" id="move-src-42" data-title="contract_body/function_definition">function requireCanTransfer(address _from, address _to) public view returns (address, bool) {
        require (attributes[_from][IS_BLACKLISTED].value == 0, "blacklisted");
        uint256 depositAddressValue = attributes[address(uint256(_to) &gt;&gt; 20)][IS_DEPOSIT_ADDRESS].value;
        if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }
        require (attributes[_to][IS_BLACKLISTED].value == 0, "blacklisted");
        return (_to, attributes[_to][IS_REGISTERED_CONTRACT].value != 0);
    }</span>

    <span class="marker" id="mapping-131"></span><span class="token mv" id="move-src-43" data-title="contract_body/function_definition">function requireCanTransferFrom(address _sender, address _from, address _to) public view returns (address, bool) {
        require (attributes[_sender][IS_BLACKLISTED].value == 0, "blacklisted");
        return requireCanTransfer(_from, _to);
    }</span>

    <span class="marker" id="mapping-132"></span><span class="token mv" id="move-src-44" data-title="contract_body/function_definition">function requireCanMint(address _to) public view returns (address, bool) {
        <span class="marker" id="mapping-133"></span><span class="token del" data-title="function_body/expression_statement">require (attributes[_to][HAS_PASSED_KYC_AML].value != 0);</span>
        require (attributes[_to][IS_BLACKLISTED].value == 0, "blacklisted");
        uint256 depositAddressValue = attributes[address(uint256(_to) &gt;&gt; 20)][IS_DEPOSIT_ADDRESS].value;
        if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }
        return (_to, attributes[_to][IS_REGISTERED_CONTRACT].value != 0);
    }</span>

    <span class="marker" id="mapping-134"></span><span class="token mv" id="move-src-45" data-title="contract_body/function_definition">function requireCanBurn(address _from) public view {
        require (attributes[_from][CAN_BURN].value != 0);
        require (attributes[_from][IS_BLACKLISTED].value == 0);
    }</span>

    // Returns the exact value of the attribute, as well as its metadata
    function getAttribute(address _who, bytes32 _attribute) public view returns (uint256, bytes32, address, uint256) {
        AttributeData memory data = attributes[_who][_attribute];
        return (data.value, data.notes, data.adminAddr, data.timestamp);
    }

    function getAttributeValue(address _who, bytes32 _attribute) public view returns (uint256) {
        return attributes[_who][_attribute].value;
    }

    function getAttributeAdminAddr(address _who, bytes32 _attribute) public view returns (address) {
        return attributes[_who][_attribute].adminAddr;
    }

    function getAttributeTimestamp(address _who, bytes32 _attribute) public view returns (uint256) {
        return attributes[_who][_attribute].timestamp;
    }

    function reclaimEther(address _to) external onlyOwner {
        _to.transfer(address(this).balance);
    }

    function reclaimToken(ERC20 token, address _to) external onlyOwner {
        uint256 balance = token.balanceOf(this);
        token.transfer(_to, balance);
    }

    <span class="marker" id="mapping-135"></span><span class="token mv" id="move-src-46" data-title="contract_body/comment"><span class="marker" id="mapping-136"></span><span class="token upd" id="move-src-47" data-title="contract_body/comment"><span class="cupd">/</span>**<span class="cupd"></span>
    * @<span class="cupd">de</span>v <span class="cupd">s</span>et<span class="cupd">s</span> the <span class="cupd">o</span>riginal `ow<span class="cupd">n</span>er`<span class="cupd"> </span>of t<span class="cupd">he</span> c<span class="cupd">o</span>ntrac<span class="cupd">t</span><span class="cupd"> t</span>o the send<span class="cupd">e</span>r
    <span class="cupd">*</span> at construction. Must <span class="cupd">t</span>h<span class="cupd">e</span>n b<span class="cupd">e</span> <span class="cupd">r</span>eini<span class="cupd">t</span><span class="cupd">i</span>alized 
    */</span></span>
    <span class="marker" id="mapping-137"></span><span class="token del" data-title="contract_body/constructor_definition">constructor() public <span class="marker" id="mapping-138"></span><span class="token del" data-title="constructor_definition/function_body">{
        <span class="marker" id="mapping-139"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-140"></span><span class="token del" data-title="expression_statement/assignment_expression">owner = <span class="marker" id="mapping-141"></span><span class="token mv" id="move-src-48" data-title="assignment_expression/member_expression">msg.sender</span></span>;</span>
        <span class="marker" id="mapping-142"></span><span class="token mv" id="move-src-49" data-title="function_body/emit_statement">emit <span class="marker" id="mapping-143"></span><span class="token upd" id="move-src-50" data-title="emit_statement/identifier">Ownership<span class="cupd">Transfer</span>red</span>(<span class="marker" id="mapping-144"></span><span class="token mv" id="move-src-51" data-title="emit_statement/call_argument">address(0)</span>, <span class="marker" id="mapping-145"></span><span class="token del" data-title="emit_statement/call_argument">owner</span>);</span>
    }</span></span>

    /**
    * @dev Throws if called by any account other than the owner.
    */
    modifier onlyOwner() {
        require(msg.sender == owner, "only Owner");
        _;
    }

    /**
    * @dev Modifier throws if called by any account other than the pendingOwner.
    */
    modifier onlyPendingOwner() {
        require(msg.sender == pendingOwner);
        _;
    }

    /**
    * @dev Allows the current owner to set the pendingOwner address.
    * @param newOwner The address to transfer ownership to.
    */
    function transferOwnership(address newOwner) public onlyOwner {
        pendingOwner = newOwner;
    }

    /**
    * @dev Allows the pendingOwner address to finalize the transfer.
    */
    function claimOwnership() public onlyPendingOwner {
        emit OwnershipTransferred(owner, pendingOwner);
        owner = pendingOwner;
        pendingOwner = address(0);
    }
}

// File: openzeppelin-solidity/contracts/ownership/Ownable.sol

/**
 * @title Ownable
 * @dev The Ownable contract has an owner address, and provides basic authorization control
 * functions, this simplifies the implementation of "user permissions".
 */
contract Ownable {
  address public owner;


  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);


  /**
   * @dev The Ownable constructor sets the original `owner` of the contract to the sender
   * account.
   */
  function Ownable() public {
    owner = msg.sender;
  }

  /**
   * @dev Throws if called by any account other than the owner.
   */
  modifier onlyOwner() {
    require(msg.sender == owner);
    _;
  }

  /**
   * @dev Allows the current owner to transfer control of the contract to a newOwner.
   * @param newOwner The address to transfer ownership to.
   */
  function transferOwnership(address newOwner) public onlyOwner {
    require(newOwner != address(0));
    emit OwnershipTransferred(owner, newOwner);
    owner = newOwner;
  }

}

// File: openzeppelin-solidity/contracts/ownership/Claimable.sol

/**
 * @title Claimable
 * @dev Extension for the Ownable contract, where the ownership needs to be claimed.
 * This allows the new owner to accept the transfer.
 */
contract Claimable is Ownable {
  address public pendingOwner;

  /**
   * @dev Modifier throws if called by any account other than the pendingOwner.
   */
  modifier onlyPendingOwner() {
    require(msg.sender == pendingOwner);
    _;
  }

  /**
   * @dev Allows the current owner to set the pendingOwner address.
   * @param newOwner The address to transfer ownership to.
   */
  function transferOwnership(address newOwner) onlyOwner public {
    pendingOwner = newOwner;
  }

  /**
   * @dev Allows the pendingOwner address to finalize the transfer.
   */
  function claimOwnership() onlyPendingOwner public {
    emit OwnershipTransferred(owner, pendingOwner);
    owner = pendingOwner;
    pendingOwner = address(0);
  }
}

// File: openzeppelin-solidity/contracts/math/SafeMath.sol

/**
 * @title SafeMath
 * @dev Math operations with safety checks that throw on error
 */
library SafeMath {

  /**
  * @dev Multiplies two numbers, throws on overflow.
  */
  function mul(uint256 a, uint256 b) internal pure returns (uint256 c) {
    if (a == 0) {
      return 0;
    }
    c = a * b;
    assert(c / a == b);
    return c;
  }

  /**
  * @dev Integer division of two numbers, truncating the quotient.
  */
  function div(uint256 a, uint256 b) internal pure returns (uint256) {
    // assert(b &gt; 0); // Solidity automatically throws when dividing by 0
    // uint256 c = a / b;
    // assert(a == b * c + a % b); // There is no case in which this doesn't hold
    return a / b;
  }

  /**
  * @dev Subtracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).
  */
  function sub(uint256 a, uint256 b) internal pure returns (uint256) {
    assert(b &lt;= a);
    return a - b;
  }

  /**
  * @dev Adds two numbers, throws on overflow.
  */
  function add(uint256 a, uint256 b) internal pure returns (uint256 c) {
    c = a + b;
    assert(c &gt;= a);
    return c;
  }
}

// File: contracts/modularERC20/BalanceSheet.sol

// A wrapper around the balanceOf mapping.
contract BalanceSheet is Claimable {
    using SafeMath for uint256;

    mapping (address =&gt; uint256) public balanceOf;

    function addBalance(address _addr, uint256 _value) public onlyOwner {
        balanceOf[_addr] = balanceOf[_addr].add(_value);
    }

    function subBalance(address _addr, uint256 _value) public onlyOwner {
        balanceOf[_addr] = balanceOf[_addr].sub(_value);
    }

    function setBalance(address _addr, uint256 _value) public onlyOwner {
        balanceOf[_addr] = _value;
    }
}

// File: contracts/modularERC20/AllowanceSheet.sol

// A wrapper around the allowanceOf mapping.
contract AllowanceSheet is Claimable {
    using SafeMath for uint256;

    mapping (address =&gt; mapping (address =&gt; uint256)) public allowanceOf;

    function addAllowance(address _tokenHolder, address _spender, uint256 _value) public onlyOwner {
        allowanceOf[_tokenHolder][_spender] = allowanceOf[_tokenHolder][_spender].add(_value);
    }

    function subAllowance(address _tokenHolder, address _spender, uint256 _value) public onlyOwner {
        allowanceOf[_tokenHolder][_spender] = allowanceOf[_tokenHolder][_spender].sub(_value);
    }

    function setAllowance(address _tokenHolder, address _spender, uint256 _value) public onlyOwner {
        allowanceOf[_tokenHolder][_spender] = _value;
    }
}

// File: contracts/ProxyStorage.sol

<span class="marker" id="mapping-146"></span><span class="token mv" id="move-src-52" data-title="source_file/comment"><span class="marker" id="mapping-147"></span><span class="token upd" id="move-src-53" data-title="source_file/comment"><span class="cupd">/</span>*<span class="cupd"></span>
De<span class="cupd">f</span>ines the storage<span class="cupd"> </span>layout of t<span class="cupd">h</span><span class="cupd">e</span> implementaiton (TrueUSD)<span class="cupd"> contrac</span>t. Any newly declared <span class="cupd"></span>
state <span class="cupd">v</span>ariables in<span class="cupd"> </span>fut<span class="cupd">u</span>re upgrades <span class="cupd">s</span>hould be ap<span class="cupd">p</span><span class="cupd">e</span>ned to <span class="cupd">t</span>he bottom. <span class="cupd">Nev</span>er remov<span class="cupd">e</span> state variables<span class="cupd">
</span>from this list
 */</span></span>
contract ProxyStorage {
    address public owner;
    address public pendingOwner;

    bool <span class="marker" id="mapping-148"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> initialized;
    
    BalanceSheet <span class="marker" id="mapping-149"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> <span class="marker" id="mapping-150"></span><span class="token upd" id="move-src-54" data-title="state_variable_declaration/identifier"><span class="cupd">balances</span></span>;
    AllowanceSheet <span class="marker" id="mapping-151"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> <span class="marker" id="mapping-152"></span><span class="token upd" id="move-src-55" data-title="state_variable_declaration/identifier"><span class="cupd">allowances</span></span>;

    uint256 totalSupply_;
    
    bool private paused_Deprecated = false;
    address private globalPause_Deprecated;

    uint256 public burnMin = 0;
    uint256 public burnMax = 0;

    Registry public registry;

    string <span class="marker" id="mapping-153"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> <span class="marker" id="mapping-154"></span><span class="token upd" id="move-src-56" data-title="state_variable_declaration/identifier"><span class="cupd">name</span></span> <span class="marker" id="mapping-155"></span><span class="token del" data-title="state_variable_declaration/=">=</span> <span class="marker" id="mapping-156"></span><span class="token del" data-title="state_variable_declaration/string_literal">"TrueUSD"</span>;
    string <span class="marker" id="mapping-157"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> <span class="marker" id="mapping-158"></span><span class="token upd" id="move-src-57" data-title="state_variable_declaration/identifier"><span class="cupd">symbol</span></span> <span class="marker" id="mapping-159"></span><span class="token del" data-title="state_variable_declaration/=">=</span> <span class="marker" id="mapping-160"></span><span class="token del" data-title="state_variable_declaration/string_literal">"TUSD"</span>;

    uint[] <span class="marker" id="mapping-161"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> <span class="marker" id="mapping-162"></span><span class="token upd" id="move-src-58" data-title="state_variable_declaration/identifier"><span class="cupd">gasRefundPool</span></span>;
    uint256 private redemptionAddressCount_Deprecated;
    uint256 public minimumGasPriceForFutureRefunds;
}

// File: contracts/HasOwner.sol

/**
 * @title HasOwner
 * @dev The HasOwner contract is a copy of Claimable Contract by Zeppelin. 
 and provides basic authorization control functions. Inherits storage layout of 
 ProxyStorage.
 */
contract HasOwner is ProxyStorage {

    event OwnershipTransferred(
        address indexed previousOwner,
        address indexed newOwner
    );

    /**
    * @dev sets the original `owner` of the contract to the sender
    * at construction. Must then be reinitialized 
    */
    constructor() public {
        owner = msg.sender;
        emit OwnershipTransferred(address(0), owner);
    }

    /**
    * @dev Throws if called by any account other than the owner.
    */
    modifier onlyOwner() {
        require(msg.sender == owner, "only Owner");
        _;
    }

    /**
    * @dev Modifier throws if called by any account other than the pendingOwner.
    */
    modifier onlyPendingOwner() {
        require(msg.sender == pendingOwner);
        _;
    }

    /**
    * @dev Allows the current owner to set the pendingOwner address.
    * @param newOwner The address to transfer ownership to.
    */
    function transferOwnership(address newOwner) public onlyOwner {
        pendingOwner = newOwner;
    }

    /**
    * @dev Allows the pendingOwner address to finalize the transfer.
    */
    function claimOwnership() public onlyPendingOwner {
        emit OwnershipTransferred(owner, pendingOwner);
        owner = pendingOwner;
        pendingOwner = address(0);
    }
}

<span class="marker" id="mapping-163"></span><span class="token mv" id="move-src-59" data-title="source_file/comment">// File: contracts/modularERC20/ModularBasicToken.sol</span>

<span class="marker" id="mapping-164"></span><span class="token mv" id="move-src-60" data-title="source_file/comment"><span class="marker" id="mapping-165"></span><span class="token upd" id="move-src-61" data-title="source_file/comment"><span class="cupd">/</span>/<span class="cupd"> </span>V<span class="cupd">e</span>rs<span class="cupd">i</span>o<span class="cupd">n</span><span class="cupd"> </span><span class="cupd">o</span><span class="cupd">f </span>Op<span class="cupd">e</span><span class="cupd">n</span>Ze<span class="cupd">p</span>p<span class="cupd">e</span>l<span class="cupd">i</span><span class="cupd">n</span>'s<span class="cupd"> </span>Basi<span class="cupd">c</span>T<span class="cupd">o</span>ke<span class="cupd">n</span><span class="cupd"> </span><span class="cupd">w</span>ho<span class="cupd">s</span><span class="cupd">e </span><span class="cupd">b</span>a<span class="cupd">l</span>a<span class="cupd">n</span>c<span class="cupd">e</span><span class="cupd">s </span>m<span class="cupd">app</span>i<span class="cupd">n</span>g<span class="cupd"> </span><span class="cupd">h</span>as<span class="cupd"> b</span><span class="cupd">e</span><span class="cupd">e</span>n<span class="cupd"> re</span>pl<span class="cupd">a</span>ced</span></span>
<span class="marker" id="mapping-166"></span><span class="token upd" id="move-src-62" data-title="source_file/comment"><span class="cupd">// </span>w<span class="cupd">i</span>th a separate Ba<span class="cupd">l</span>anc<span class="cupd">e</span>Sheet<span class="cupd"> contract</span>. r<span class="cupd">e</span><span class="cupd">m</span><span class="cupd">o</span>v<span class="cupd">e</span> the <span class="cupd">n</span>eed t<span class="cupd">o</span> copy over balances.</span>
/**
 * @title Basic token
 * @dev Basic version of StandardToken, with no allowances.
 */
contract ModularBasicToken is HasOwner {
    using SafeMath for uint256;

    <span class="marker" id="mapping-167"></span><span class="token del" data-title="contract_body/event_definition">event BalanceSheetSet(address indexed sheet);</span>
    event Transfer(address indexed from, address indexed to, uint256 value);

    <span class="marker" id="mapping-168"></span><span class="token del" data-title="contract_body/comment">/**
    * @dev claim ownership of the balancesheet contract
    * @param _sheet The address to of the balancesheet to claim.
    */</span>
    <span class="marker" id="mapping-169"></span><span class="token del" data-title="contract_body/function_definition">function setBalanceSheet(<span class="marker" id="mapping-170"></span><span class="token mv" id="move-src-63" data-title="function_definition/parameter"><span class="marker" id="mapping-171"></span><span class="token mv" id="move-src-64" data-title="parameter/type_name">address</span> <span class="marker" id="mapping-172"></span><span class="token upd" id="move-src-65" data-title="parameter/identifier">_s<span class="cupd">h</span>eet</span></span>) <span class="marker" id="mapping-173"></span><span class="token mv" id="move-src-66" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-174"></span><span class="token mv" id="move-src-67" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-175"></span><span class="token mv" id="move-src-68" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-176"></span><span class="token del" data-title="function_definition/function_body">{
        balances = BalanceSheet(_sheet);
        balances.claimOwnership();
        emit BalanceSheetSet(_sheet);
        return true;
    }</span></span>

    /**
    * @dev total number of tokens in existence
    */
    function totalSupply() public view returns (uint256) {
        return totalSupply_;
    }

    <span class="marker" id="mapping-177"></span><span class="token del" data-title="contract_body/comment">/**
    * @dev transfer token for a specified address
    * @param _to The address to transfer to.
    * @param _value The amount to be transferred.
    */</span>
    <span class="marker" id="mapping-178"></span><span class="token del" data-title="contract_body/function_definition">function transfer(<span class="marker" id="mapping-179"></span><span class="token mv" id="move-src-69" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-180"></span><span class="token mv" id="move-src-70" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-181"></span><span class="token del" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-182"></span><span class="token del" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-183"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-184"></span><span class="token mv" id="move-src-71" data-title="function_body/expression_statement"><span class="marker" id="mapping-185"></span><span class="token upd" id="move-src-72" data-title="call_expression/identifier"><span class="cupd">_</span>t<span class="cupd">r</span><span class="cupd">an</span><span class="cupd">sfer</span>AllArgs</span>(msg.sender, <span class="marker" id="mapping-186"></span><span class="token mv" id="move-src-73" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-187"></span><span class="token mv" id="move-src-74" data-title="call_expression/call_argument">_value</span>);</span>
        <span class="marker" id="mapping-188"></span><span class="token del" data-title="function_body/return_statement">return true;</span>
    }</span></span>


    <span class="marker" id="mapping-189"></span><span class="token del" data-title="contract_body/function_definition">function _transferAllArgs(<span class="marker" id="mapping-190"></span><span class="token mv" id="move-src-75" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-191"></span><span class="token mv" id="move-src-76" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-192"></span><span class="token mv" id="move-src-77" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-193"></span><span class="token mv" id="move-src-78" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-194"></span><span class="token del" data-title="function_definition/function_body">{
        // SafeMath.sub will throw if there is not enough balance.
        <span class="marker" id="mapping-195"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-196"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-197"></span><span class="token del" data-title="call_expression/member_expression">balances.subBalance</span>(<span class="marker" id="mapping-198"></span><span class="token mv" id="move-src-79" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-199"></span><span class="token mv" id="move-src-80" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-200"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-201"></span><span class="token mv" id="move-src-81" data-title="expression_statement/call_expression"><span class="marker" id="mapping-202"></span><span class="token del" data-title="call_expression/member_expression">balances.addBalance</span>(_to, _value)</span>;</span>
        <span class="marker" id="mapping-203"></span><span class="token mv" id="move-src-82" data-title="function_body/emit_statement">emit Transfer(_from, _to, _value);</span>
    }</span></span>
    

    <span class="marker" id="mapping-204"></span><span class="token del" data-title="contract_body/comment">/**
    * @dev Gets the balance of the specified address.
    * @param _owner The address to query the the balance of.
    * @return An uint256 representing the amount owned by the passed address.
    */</span>
    <span class="marker" id="mapping-205"></span><span class="token del" data-title="contract_body/function_definition">function balanceOf(<span class="marker" id="mapping-206"></span><span class="token mv" id="move-src-83" data-title="function_definition/parameter"><span class="marker" id="mapping-207"></span><span class="token mv" id="move-src-84" data-title="parameter/type_name">address</span> <span class="marker" id="mapping-208"></span><span class="token upd" id="move-src-85" data-title="parameter/identifier">_ow<span class="cupd">n</span><span class="cupd">er</span></span></span>) <span class="marker" id="mapping-209"></span><span class="token mv" id="move-src-86" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-210"></span><span class="token mv" id="move-src-87" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-211"></span><span class="token mv" id="move-src-88" data-title="function_definition/return_type_definition">returns (uint256 <span class="marker" id="mapping-212"></span><span class="token upd" id="move-src-89" data-title="parameter/identifier">balance</span>)</span> <span class="marker" id="mapping-213"></span><span class="token del" data-title="function_definition/function_body">{
        return balances.balanceOf(_owner);
    }</span></span>
}

// File: contracts/modularERC20/ModularStandardToken.sol

/**
 * @title Standard ERC20 token
 *
 * @dev Implementation of the basic standard token.
 * @dev https://github.com/ethereum/EIPs/issues/20
 * @dev Based on code by FirstBlood: https://github.com/Firstbloodio/token/blob/master/smart_contract/FirstBloodToken.sol
 */
contract ModularStandardToken is ModularBasicToken {
    
    <span class="marker" id="mapping-214"></span><span class="token del" data-title="contract_body/event_definition">event AllowanceSheetSet(address indexed sheet);</span>
    event Approval(address indexed owner, address indexed spender, uint256 value);
    
    <span class="marker" id="mapping-215"></span><span class="token del" data-title="contract_body/comment">/**
    * @dev claim ownership of the AllowanceSheet contract
    * @param _sheet The address to of the AllowanceSheet to claim.
    */</span>
    <span class="marker" id="mapping-216"></span><span class="token del" data-title="contract_body/function_definition">function setAllowanceSheet(<span class="marker" id="mapping-217"></span><span class="token mv" id="move-src-90" data-title="function_definition/parameter"><span class="marker" id="mapping-218"></span><span class="token mv" id="move-src-91" data-title="parameter/type_name">address</span> <span class="marker" id="mapping-219"></span><span class="token upd" id="move-src-92" data-title="parameter/identifier">_s<span class="cupd">h</span>eet</span></span>) <span class="marker" id="mapping-220"></span><span class="token mv" id="move-src-93" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-221"></span><span class="token mv" id="move-src-94" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-222"></span><span class="token mv" id="move-src-95" data-title="function_definition/return_type_definition">returns(bool)</span> <span class="marker" id="mapping-223"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-224"></span><span class="token del" data-title="function_body/expression_statement">allowances = AllowanceSheet(_sheet);</span>
        <span class="marker" id="mapping-225"></span><span class="token del" data-title="function_body/expression_statement">allowances.claimOwnership();</span>
        <span class="marker" id="mapping-226"></span><span class="token del" data-title="function_body/emit_statement">emit AllowanceSheetSet(_sheet);</span>
        <span class="marker" id="mapping-227"></span><span class="token mv" id="move-src-96" data-title="function_body/return_statement">return true;</span>
    }</span></span>

    <span class="marker" id="mapping-228"></span><span class="token del" data-title="contract_body/comment">/**
     * @dev Transfer tokens from one address to another
     * @param _from address The address which you want to send tokens from
     * @param _to address The address which you want to transfer to
     * @param _value uint256 the amount of tokens to be transferred
     */</span>
    <span class="marker" id="mapping-229"></span><span class="token mv" id="move-src-97" data-title="contract_body/function_definition">function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {
        <span class="marker" id="mapping-230"></span><span class="token mv" id="move-src-98" data-title="function_body/expression_statement">_transferFromAllArgs(_from, _to, _value, msg.sender);</span>
        return true;
    }</span>

    <span class="marker" id="mapping-231"></span><span class="token mv" id="move-src-99" data-title="contract_body/function_definition">function <span class="marker" id="mapping-232"></span><span class="token upd" id="move-src-100" data-title="function_definition/identifier">_<span class="cupd">transfer</span>FromAllArgs</span>(<span class="marker" id="mapping-233"></span><span class="token mv" id="move-src-101" data-title="function_definition/parameter">address _from</span><span class="marker" id="mapping-234"></span><span class="token mv" id="move-src-102" data-title="function_definition/,">,</span> address _to<span class="marker" id="mapping-235"></span><span class="token del" data-title="function_definition/,">,</span> uint256 _value<span class="marker" id="mapping-236"></span><span class="token del" data-title="function_definition/,">,</span> <span class="marker" id="mapping-237"></span><span class="token mv" id="move-src-103" data-title="function_definition/parameter">address _spender</span>) <span class="marker" id="mapping-238"></span><span class="token mv" id="move-src-104" data-title="function_definition/visibility">internal</span> {
        <span class="marker" id="mapping-239"></span><span class="token mv" id="move-src-105" data-title="function_body/expression_statement">_transferAllArgs(_from, _to, _value);</span>
        <span class="marker" id="mapping-240"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-241"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-242"></span><span class="token del" data-title="call_expression/member_expression">allowances.subAllowance</span>(<span class="marker" id="mapping-243"></span><span class="token mv" id="move-src-106" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-244"></span><span class="token mv" id="move-src-107" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-245"></span><span class="token mv" id="move-src-108" data-title="call_expression/call_argument">_value</span>)</span>;</span>
    }</span>

    /**
     * @dev Approve the passed address to spend the specified amount of tokens on behalf of msg.sender.
     *
     * Beware that changing an allowance with this method brings the risk that someone may use both the old
     * and the new allowance by unfortunate transaction ordering. One possible solution to mitigate this
     * race condition is to first reduce the spender's allowance to 0 and set the desired value afterwards:
     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729
     * @param _spender The address which will spend the funds.
     * @param _value The amount of tokens to be spent.
     */
    function approve(address _spender, uint256 _value) public returns (bool) {
        _approveAllArgs(_spender, _value, msg.sender);
        return true;
    }

    function _approveAllArgs(address _spender, uint256 _value, address _tokenHolder) internal {
        <span class="marker" id="mapping-246"></span><span class="token mv" id="move-src-109" data-title="function_body/expression_statement"><span class="marker" id="mapping-247"></span><span class="token del" data-title="call_expression/member_expression">allowances.setAllowance</span>(_tokenHolder, _spender, <span class="marker" id="mapping-248"></span><span class="token mv" id="move-src-110" data-title="call_expression/call_argument">_value</span>);</span>
        emit Approval(_tokenHolder, _spender, _value);
    }

    <span class="marker" id="mapping-249"></span><span class="token del" data-title="contract_body/comment">/**
     * @dev Function to check the amount of tokens that an owner allowed to a spender.
     * @param _owner address The address which owns the funds.
     * @param _spender address The address which will spend the funds.
     * @return A uint256 specifying the amount of tokens still available for the spender.
     */</span>
    <span class="marker" id="mapping-250"></span><span class="token mv" id="move-src-111" data-title="contract_body/function_definition">function allowance(<span class="marker" id="mapping-251"></span><span class="token mv" id="move-src-112" data-title="parameter/type_name">address</span> <span class="marker" id="mapping-252"></span><span class="token upd" id="move-src-113" data-title="parameter/identifier"><span class="cupd">_</span>owner</span>, address _spender) public view returns (uint256) {
        return <span class="marker" id="mapping-253"></span><span class="token del" data-title="call_expression/member_expression">allowances.allowanceOf</span>(<span class="marker" id="mapping-254"></span><span class="token del" data-title="call_expression/call_argument">_owner</span>, _spender);
    }</span>

    /**
     * @dev Increase the amount of tokens that an owner allowed to a spender.
     *
     * approve should be called when allowed[_spender] == 0. To increment
     * allowed value is better to use this function to avoid 2 calls (and wait until
     * the first transaction is mined)
     * From MonolithDAO Token.sol
     * @param _spender The address which will spend the funds.
     * @param _addedValue The amount of tokens to increase the allowance by.
     */
    function increaseApproval(address _spender, uint _addedValue) public returns (bool) {
        _increaseApprovalAllArgs(_spender, _addedValue, msg.sender);
        return true;
    }

    function _increaseApprovalAllArgs(address _spender, uint256 _addedValue, address _tokenHolder) internal {
        <span class="marker" id="mapping-255"></span><span class="token del" data-title="call_expression/member_expression">allowances.addAllowance</span>(_tokenHolder, _spender, _addedValue);
        emit Approval(<span class="marker" id="mapping-256"></span><span class="token mv" id="move-src-114" data-title="emit_statement/call_argument">_tokenHolder</span>, <span class="marker" id="mapping-257"></span><span class="token mv" id="move-src-115" data-title="emit_statement/call_argument">_spender</span>, <span class="marker" id="mapping-258"></span><span class="token del" data-title="call_expression/member_expression">allowances.allowanceOf</span>(_tokenHolder, _spender));
    }

    /**
     * @dev Decrease the amount of tokens that an owner allowed to a spender.
     *
     * approve should be called when allowed[_spender] == 0. To decrement
     * allowed value is better to use this function to avoid 2 calls (and wait until
     * the first transaction is mined)
     * From MonolithDAO Token.sol
     * @param _spender The address which will spend the funds.
     * @param _subtractedValue The amount of tokens to decrease the allowance by.
     */
    function decreaseApproval(address _spender, uint _subtractedValue) public returns (bool) {
        _decreaseApprovalAllArgs(_spender, _subtractedValue, msg.sender);
        return true;
    }

    function _decreaseApprovalAllArgs(address _spender, uint256 _subtractedValue, address _tokenHolder) internal {
        uint256 oldValue = <span class="marker" id="mapping-259"></span><span class="token del" data-title="call_expression/member_expression">allowances.allowanceOf</span>(_tokenHolder, _spender);
        if (_subtractedValue &gt; oldValue) <span class="marker" id="mapping-260"></span><span class="token del" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-261"></span><span class="token del" data-title="block_statement/expression_statement"><span class="marker" id="mapping-262"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-263"></span><span class="token del" data-title="call_expression/member_expression">allowances.setAllowance</span>(<span class="marker" id="mapping-264"></span><span class="token del" data-title="call_expression/call_argument">_tokenHolder</span>, <span class="marker" id="mapping-265"></span><span class="token mv" id="move-src-116" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-266"></span><span class="token del" data-title="call_expression/call_argument">0</span>)</span>;</span>
        }</span> else <span class="marker" id="mapping-267"></span><span class="token del" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-268"></span><span class="token mv" id="move-src-117" data-title="block_statement/expression_statement"><span class="marker" id="mapping-269"></span><span class="token del" data-title="call_expression/member_expression">allowances.subAllowance</span>(_tokenHolder, _spender, <span class="marker" id="mapping-270"></span><span class="token del" data-title="call_expression/call_argument">_subtractedValue</span>);</span>
        }</span>
        emit Approval(<span class="marker" id="mapping-271"></span><span class="token mv" id="move-src-118" data-title="emit_statement/call_argument">_tokenHolder</span>,<span class="marker" id="mapping-272"></span><span class="token mv" id="move-src-119" data-title="emit_statement/call_argument">_spender</span>, <span class="marker" id="mapping-273"></span><span class="token del" data-title="call_argument/call_expression"><span class="marker" id="mapping-274"></span><span class="token del" data-title="call_expression/member_expression">allowances.allowanceOf</span>(<span class="marker" id="mapping-275"></span><span class="token del" data-title="call_expression/call_argument">_tokenHolder</span>, <span class="marker" id="mapping-276"></span><span class="token mv" id="move-src-120" data-title="call_expression/call_argument">_spender</span>)</span>);
    }
}

// File: contracts/modularERC20/ModularBurnableToken.sol

/**
 * @title Burnable Token
 * @dev Token that can be irreversibly burned (destroyed).
 */
contract ModularBurnableToken is ModularStandardToken {
    event Burn(address indexed burner, uint256 value);

    <span class="marker" id="mapping-277"></span><span class="token del" data-title="contract_body/comment">/**
     * @dev Burns a specific amount of tokens.
     * @param _value The amount of token to be burned.
     */</span>
    function burn(uint256 _value) <span class="marker" id="mapping-278"></span><span class="token mv" id="move-src-121" data-title="function_definition/visibility">public</span> {
        _burnAllArgs(msg.sender, <span class="marker" id="mapping-279"></span><span class="token mv" id="move-src-122" data-title="call_expression/call_argument">_value</span>);
    }

    function _burnAllArgs(<span class="marker" id="mapping-280"></span><span class="token del" data-title="function_definition/parameter"><span class="marker" id="mapping-281"></span><span class="token mv" id="move-src-123" data-title="parameter/type_name">address</span> _burner</span>, uint256 _value) internal {
        // no need to require value &lt;= totalSupply, since that would imply the
        // sender's balance is greater than the totalSupply, which *should* be an assertion failure
        <span class="marker" id="mapping-282"></span><span class="token del" data-title="function_body/comment">/* uint burnAmount = _value / (10 **16) * (10 **16); */</span>
        <span class="marker" id="mapping-283"></span><span class="token del" data-title="call_expression/member_expression">balances.subBalance</span>(<span class="marker" id="mapping-284"></span><span class="token del" data-title="call_expression/call_argument">_burner</span>, <span class="marker" id="mapping-285"></span><span class="token mv" id="move-src-124" data-title="call_expression/call_argument">_value</span>);
        totalSupply_ = totalSupply_.sub(_value);
        <span class="marker" id="mapping-286"></span><span class="token del" data-title="function_body/emit_statement">emit Burn(<span class="marker" id="mapping-287"></span><span class="token del" data-title="emit_statement/call_argument">_burner</span>, <span class="marker" id="mapping-288"></span><span class="token mv" id="move-src-125" data-title="emit_statement/call_argument">_value</span>);</span>
        <span class="marker" id="mapping-289"></span><span class="token mv" id="move-src-126" data-title="function_body/emit_statement">emit Transfer(<span class="marker" id="mapping-290"></span><span class="token del" data-title="emit_statement/call_argument">_burner</span>, address(0), _value);</span>
    }
}

<span class="marker" id="mapping-291"></span><span class="token mv" id="move-src-127" data-title="source_file/comment"><span class="marker" id="mapping-292"></span><span class="token upd" id="move-src-128" data-title="source_file/comment"><span class="cupd">// F</span>ile:<span class="cupd"> </span>c<span class="cupd">o</span><span class="cupd">n</span>tracts/modu<span class="cupd">l</span>arERC20/ModularM<span class="cupd">in</span>t<span class="cupd">a</span>ble<span class="cupd">Token</span>.sol</span></span>

<span class="marker" id="mapping-293"></span><span class="token mv" id="move-src-129" data-title="source_file/comment"><span class="marker" id="mapping-294"></span><span class="token upd" id="move-src-130" data-title="source_file/comment"><span class="cupd">/</span>**<span class="cupd"></span>
 * @<span class="cupd">t</span>i<span class="cupd">tl</span><span class="cupd">e</span> Mintable <span class="cupd">t</span>ok<span class="cupd">e</span>n
 * @dev Simple ERC20 Token example, <span class="cupd">w</span>ith mintable token<span class="cupd"> </span>c<span class="cupd">r</span>eation
 * @dev Issue: * https://gith<span class="cupd">u</span>b.com/OpenZeppelin/openzeppelin-sol<span class="cupd">i</span>dit<span class="cupd">y</span>/iss<span class="cupd">u</span>es/120
<span class="cupd"> *</span><span class="cupd"> </span>Bas<span class="cupd">e</span>d o<span class="cupd">n</span> code<span class="cupd"> by T</span>okenMarketNet: https://gi<span class="cupd">t</span>hub.com/TokenMarketNet/ico/blo<span class="cupd">b</span>/mast<span class="cupd">e</span>r/contracts/MintableToken.sol
 */</span></span>
<span class="marker" id="mapping-295"></span><span class="token del" data-title="source_file/contract_declaration">contract ModularMintableToken is <span class="marker" id="mapping-296"></span><span class="token mv" id="move-src-131" data-title="contract_declaration/inheritance_specifier">ModularBurnableToken</span> <span class="marker" id="mapping-297"></span><span class="token del" data-title="contract_declaration/contract_body">{
    <span class="marker" id="mapping-298"></span><span class="token mv" id="move-src-132" data-title="contract_body/event_definition">event Mint(address indexed to, uint256 value);</span>

    /**
     * @dev Function to mint tokens
     * @param _to The address that will receive the minted tokens.
     * @param _value The amount of tokens to mint.
     * @return A boolean that indicates if the operation was successful.
     */
    <span class="marker" id="mapping-299"></span><span class="token del" data-title="contract_body/function_definition">function mint(<span class="marker" id="mapping-300"></span><span class="token mv" id="move-src-133" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-301"></span><span class="token mv" id="move-src-134" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-302"></span><span class="token mv" id="move-src-135" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-303"></span><span class="token del" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-304"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-305"></span><span class="token del" data-title="function_body/expression_statement">require(_to != address(0), "to address cannot be zero");</span>
        <span class="marker" id="mapping-306"></span><span class="token del" data-title="function_body/expression_statement">totalSupply_ = totalSupply_.add(_value);</span>
        <span class="marker" id="mapping-307"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-308"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-309"></span><span class="token del" data-title="call_expression/member_expression">balances.addBalance</span>(<span class="marker" id="mapping-310"></span><span class="token mv" id="move-src-136" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-311"></span><span class="token mv" id="move-src-137" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-312"></span><span class="token del" data-title="function_body/emit_statement">emit Mint(<span class="marker" id="mapping-313"></span><span class="token mv" id="move-src-138" data-title="emit_statement/call_argument">_to</span>, <span class="marker" id="mapping-314"></span><span class="token mv" id="move-src-139" data-title="emit_statement/call_argument">_value</span>);</span>
        <span class="marker" id="mapping-315"></span><span class="token mv" id="move-src-140" data-title="function_body/emit_statement">emit Transfer(<span class="marker" id="mapping-316"></span><span class="token mv" id="move-src-141" data-title="emit_statement/call_argument">address(0)</span>, <span class="marker" id="mapping-317"></span><span class="token mv" id="move-src-142" data-title="emit_statement/call_argument">_to</span>, _value);</span>
    }</span></span>
}</span></span>

// File: contracts/BurnableTokenWithBounds.sol

/**
 * @title Burnable Token WithBounds
 * @dev Burning functions as redeeming money from the system. The platform will keep track of who burns coins,
 * and will send them back the equivalent amount of money (rounded down to the nearest cent).
 */
contract BurnableTokenWithBounds is <span class="marker" id="mapping-318"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">ModularMintableToken</span> {

    event SetBurnBounds(uint256 newMin, uint256 newMax);

    function _burnAllArgs(address _burner, uint256 _value) internal {
        require(_value &gt;= burnMin, "below min burn bound");
        require(_value &lt;= burnMax, "exceeds max burn bound");
        super._burnAllArgs(_burner, _value);
    }

    //Change the minimum and maximum amount that can be burned at once. Burning
    //may be disabled by setting both to 0 (this will not be done under normal
    //operation, but we can't add checks to disallow it without losing a lot of
    //flexibility since burning could also be as good as disabled
    //by setting the minimum extremely high, and we don't want to lock
    //in any particular cap for the minimum)
    function setBurnBounds(uint256 _min, uint256 _max) <span class="marker" id="mapping-319"></span><span class="token mv" id="move-src-143" data-title="function_definition/visibility">public</span> onlyOwner {
        require(_min &lt;= _max, "min &gt; max");
        burnMin = _min;
        burnMax = _max;
        emit SetBurnBounds(_min, _max);
    }
}

<span class="marker" id="mapping-320"></span><span class="token upd" id="move-src-144" data-title="source_file/comment"><span class="cupd">/</span>/<span class="cupd"> </span>F<span class="cupd">i</span><span class="cupd">le</span>:<span class="cupd"> </span>c<span class="cupd">o</span><span class="cupd">n</span><span class="cupd">t</span><span class="cupd">r</span><span class="cupd">a</span><span class="cupd">c</span><span class="cupd">t</span>s/C<span class="cupd">o</span><span class="cupd">mp</span><span class="cupd">l</span><span class="cupd">i</span>a<span class="cupd">n</span><span class="cupd">t</span>T<span class="cupd">o</span>k<span class="cupd">e</span><span class="cupd">n</span>.<span class="cupd">s</span>ol</span>

<span class="marker" id="mapping-321"></span><span class="token del" data-title="source_file/contract_declaration">contract CompliantToken is <span class="marker" id="mapping-322"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">ModularMintableToken</span> <span class="marker" id="mapping-323"></span><span class="token del" data-title="contract_declaration/contract_body">{
    // In order to deposit USD and receive newly minted TrueUSD, or to burn TrueUSD to
    // redeem it for USD, users must first go through a KYC/AML check (which includes proving they
    // control their ethereum address using AddressValidation.sol).
    <span class="marker" id="mapping-324"></span><span class="token mv" id="move-src-145" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-325"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-326"></span><span class="token upd" id="move-src-146" data-title="state_variable_declaration/identifier">HA<span class="cupd">S_</span>P<span class="cupd">A</span><span class="cupd">S</span>S<span class="cupd">ED</span>_KYC_AML</span> = "hasPassedKYC/AML";</span>
    // Redeeming ("burning") TrueUSD tokens for USD requires a separate flag since
    // users must not only be KYC/AML'ed but must also have bank information on file.
    <span class="marker" id="mapping-327"></span><span class="token mv" id="move-src-147" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-328"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-329"></span><span class="token upd" id="move-src-148" data-title="state_variable_declaration/identifier">C<span class="cupd">A</span>N_BURN</span> = "canBurn";</span>
    // Addresses can also be blacklisted, preventing them from sending or receiving
    // TrueUSD. This can be used to prevent the use of TrueUSD by bad actors in
    // accordance with law enforcement. See [TrueCoin Terms of Use](https://www.trusttoken.com/trueusd/terms-of-use)
    <span class="marker" id="mapping-330"></span><span class="token mv" id="move-src-149" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-331"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-332"></span><span class="token upd" id="move-src-150" data-title="state_variable_declaration/identifier"><span class="cupd">I</span><span class="cupd">S_</span>BLA<span class="cupd">C</span>KLISTED</span> = "isBlacklisted";</span>

    <span class="marker" id="mapping-333"></span><span class="token mv" id="move-src-151" data-title="contract_body/event_definition">event WipeBlacklistedAccount(address indexed account, uint256 balance);</span>
    <span class="marker" id="mapping-334"></span><span class="token mv" id="move-src-152" data-title="contract_body/event_definition">event SetRegistry(address indexed registry);</span>
    
    /**
    * @dev Point to the registry that contains all compliance related data
    @param _registry The address of the registry instance
    */
    <span class="marker" id="mapping-335"></span><span class="token mv" id="move-src-153" data-title="contract_body/function_definition">function setRegistry(Registry _registry) public onlyOwner {
        registry = _registry;
        emit SetRegistry(registry);
    }</span>

    <span class="marker" id="mapping-336"></span><span class="token mv" id="move-src-154" data-title="contract_body/function_definition">function _burnAllArgs(address <span class="marker" id="mapping-337"></span><span class="token upd" id="move-src-155" data-title="parameter/identifier"><span class="cupd">_</span>burner</span>, <span class="marker" id="mapping-338"></span><span class="token mv" id="move-src-156" data-title="function_definition/parameter">uint256 _value</span>) internal {
        <span class="marker" id="mapping-339"></span><span class="token del" data-title="call_expression/member_expression">registry.requireCanBurn</span>(<span class="marker" id="mapping-340"></span><span class="token upd" id="move-src-157" data-title="call_argument/identifier"><span class="cupd">_</span>burner</span>);
        super._burnAllArgs(<span class="marker" id="mapping-341"></span><span class="token del" data-title="call_expression/call_argument">_burner</span>, _value);
    }</span>

    // Destroy the tokens owned by a blacklisted account
    <span class="marker" id="mapping-342"></span><span class="token mv" id="move-src-158" data-title="contract_body/function_definition">function wipeBlacklistedAccount(address _account) public onlyOwner {
        require(<span class="marker" id="mapping-343"></span><span class="token mv" id="move-src-159" data-title="call_argument/call_expression">registry.hasAttribute(_account, IS_BLACKLISTED)</span>, "_account is not blacklisted");
        uint256 oldValue = <span class="marker" id="mapping-344"></span><span class="token upd" id="move-src-160" data-title="call_expression/identifier">b<span class="cupd">alance</span>Of</span>(_account);
        <span class="marker" id="mapping-345"></span><span class="token del" data-title="call_expression/member_expression">balances.setBalance</span>(_account, 0);
        totalSupply_ = totalSupply_.sub(oldValue);
        emit WipeBlacklistedAccount(_account, oldValue);
        emit Transfer(_account, address(0), oldValue);
    }</span>
}</span></span>

<span class="marker" id="mapping-346"></span><span class="token mv" id="move-src-161" data-title="source_file/comment"><span class="marker" id="mapping-347"></span><span class="token upd" id="move-src-162" data-title="source_file/comment"><span class="cupd">// File: contracts/Dep</span>osi<span class="cupd">t</span>Tok<span class="cupd">e</span><span class="cupd">n</span><span class="cupd">.sol</span></span></span>

<span class="marker" id="mapping-348"></span><span class="token mv" id="move-src-163" data-title="source_file/comment"><span class="marker" id="mapping-349"></span><span class="token upd" id="move-src-164" data-title="source_file/comment"><span class="cupd">/</span>**<span class="cupd"> </span>@t<span class="cupd">i</span>t<span class="cupd">le</span><span class="cupd"> </span>Deposit Token
Allows us<span class="cupd">e</span>rs to <span class="cupd">regis</span>t<span class="cupd">e</span>r their address <span class="cupd">s</span>o<span class="cupd"> </span>that all <span class="cupd">tr</span>ansfers<span class="cupd"> </span>to dep<span class="cupd">o</span>sit ad<span class="cupd">d</span>resses<span class="cupd"></span>
of the r<span class="cupd">eg</span>istered address<span class="cupd"> </span>will be<span class="cupd"> </span>fo<span class="cupd">r</span>wa<span class="cupd">r</span>ded to the <span class="cupd">regi</span>s<span class="cupd">t</span>ered addre<span class="cupd">s</span>s.  
For example for ad<span class="cupd">d</span>ress 0x9052BE99C9C8C5545743859e4559A751bDe4c923,
its<span class="cupd"> </span>deposit addresses are all addresses between
0x9052BE99C9C8C5545743859e4559A75100000 and 0x9052BE99C9C8C5545743859e4559A751fffff
Transfers to 0x9052BE99C9C8C5545743859e4559A75100005 will be forwared to 0x9052BE99C9C8C5545743859e4559A751bDe4c923
 */</span></span>
<span class="marker" id="mapping-350"></span><span class="token del" data-title="source_file/contract_declaration">contract DepositToken is <span class="marker" id="mapping-351"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">ModularMintableToken</span> <span class="marker" id="mapping-352"></span><span class="token del" data-title="contract_declaration/contract_body">{
    
    <span class="marker" id="mapping-353"></span><span class="token mv" id="move-src-165" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-354"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-355"></span><span class="token upd" id="move-src-166" data-title="state_variable_declaration/identifier"><span class="cupd">IS_</span>D<span class="cupd">E</span>PO<span class="cupd">S</span>I<span class="cupd">T</span><span class="cupd">_</span>ADDRESS</span> = "isDepositAddress";</span> 

}</span></span>

<span class="marker" id="mapping-356"></span><span class="token mv" id="move-src-167" data-title="source_file/comment"><span class="marker" id="mapping-357"></span><span class="token upd" id="move-src-168" data-title="source_file/comment"><span class="cupd">// File: contracts/</span>T<span class="cupd">r</span>ue<span class="cupd">Co</span><span class="cupd">i</span><span class="cupd">n</span>R<span class="cupd">e</span>c<span class="cupd">e</span><span class="cupd">i</span>ver<span class="cupd">.sol</span></span></span>

<span class="marker" id="mapping-358"></span><span class="token mv" id="move-src-169" data-title="source_file/contract_declaration">contract TrueCoinReceiver {
    function tokenFallback( address from, uint256 value ) external;
}</span>

<span class="marker" id="mapping-359"></span><span class="token mv" id="move-src-170" data-title="source_file/comment"><span class="marker" id="mapping-360"></span><span class="token upd" id="move-src-171" data-title="source_file/comment"><span class="cupd">// </span>Fi<span class="cupd">l</span><span class="cupd">e</span>:<span class="cupd"> </span>c<span class="cupd">o</span><span class="cupd">n</span>t<span class="cupd">ra</span>c<span class="cupd">t</span>s/T<span class="cupd">o</span>ke<span class="cupd">n</span>Wi<span class="cupd">t</span>hH<span class="cupd">o</span>ok.sol</span></span>

<span class="marker" id="mapping-361"></span><span class="token mv" id="move-src-172" data-title="source_file/comment"><span class="marker" id="mapping-362"></span><span class="token upd" id="move-src-173" data-title="source_file/comment"><span class="cupd">/</span>**<span class="cupd"> </span>@t<span class="cupd">i</span>t<span class="cupd">le</span><span class="cupd"> </span>Token With Hook
If tokens are transferred to a Registered Token R<span class="cupd">e</span>ceiver <span class="cupd">contrac</span>t, <span class="cupd">t</span>rigger the <span class="cupd">t</span>okenFallback function in the 
Token Rec<span class="cupd">e</span>iver contract. Assume all R<span class="cupd">eg</span>istered Token Re<span class="cupd">c</span>eiver<span class="cupd"> c</span>on<span class="cupd">t</span>ract i<span class="cupd">m</span>plements th<span class="cupd">e Tr</span>ueCoinReceiver 
interf<span class="cupd">a</span>ce. If th<span class="cupd">e</span> tokenFallback reverts, the entire transaction reverts. 
 */</span></span>
<span class="marker" id="mapping-363"></span><span class="token del" data-title="source_file/contract_declaration">contract TokenWithHook is <span class="marker" id="mapping-364"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">ModularMintableToken</span> <span class="marker" id="mapping-365"></span><span class="token del" data-title="contract_declaration/contract_body">{
    
    <span class="marker" id="mapping-366"></span><span class="token mv" id="move-src-174" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-367"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-368"></span><span class="token upd" id="move-src-175" data-title="state_variable_declaration/identifier"><span class="cupd">IS_</span>REG<span class="cupd">ISTE</span>RED_CONTRACT</span> = "isRegisteredContract";</span> 

}</span></span>

// File: contracts/CompliantDepositTokenWithHook.sol

contract CompliantDepositTokenWithHook is <span class="marker" id="mapping-369"></span><span class="token upd" id="move-src-176" data-title="user_defined_type/identifier">Comp<span class="cupd">l</span><span class="cupd">i</span>ant<span class="cupd">Token</span></span>, <span class="marker" id="mapping-370"></span><span class="token upd" id="move-src-177" data-title="user_defined_type/identifier">D<span class="cupd">e</span>po<span class="cupd">s</span>i<span class="cupd">t</span>T<span class="cupd">o</span>ken</span>, <span class="marker" id="mapping-371"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">TokenWithHook</span> {

    <span class="marker" id="mapping-372"></span><span class="token del" data-title="contract_body/function_definition">function _transferFromAllArgs(<span class="marker" id="mapping-373"></span><span class="token mv" id="move-src-178" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-374"></span><span class="token mv" id="move-src-179" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-375"></span><span class="token mv" id="move-src-180" data-title="function_definition/parameter">uint256 _value</span>, <span class="marker" id="mapping-376"></span><span class="token del" data-title="function_definition/parameter">address _sender</span>) <span class="marker" id="mapping-377"></span><span class="token mv" id="move-src-181" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-378"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-379"></span><span class="token mv" id="move-src-182" data-title="function_body/variable_declaration_statement">bool hasHook;</span>
        <span class="marker" id="mapping-380"></span><span class="token del" data-title="function_body/variable_declaration_statement">address originalTo = _to;</span>
        <span class="marker" id="mapping-381"></span><span class="token mv" id="move-src-183" data-title="function_body/expression_statement">(_to, hasHook) = <span class="marker" id="mapping-382"></span><span class="token del" data-title="call_expression/member_expression">registry.requireCanTransferFrom</span>(<span class="marker" id="mapping-383"></span><span class="token del" data-title="call_expression/call_argument">_sender</span><span class="marker" id="mapping-384"></span><span class="token del" data-title="call_expression/,">,</span> <span class="marker" id="mapping-385"></span><span class="token mv" id="move-src-184" data-title="call_expression/call_argument">_from</span><span class="marker" id="mapping-386"></span><span class="token del" data-title="call_expression/,">,</span> _to);</span>
        <span class="marker" id="mapping-387"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-388"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-389"></span><span class="token del" data-title="call_expression/member_expression">allowances.subAllowance</span>(<span class="marker" id="mapping-390"></span><span class="token mv" id="move-src-185" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-391"></span><span class="token del" data-title="call_expression/call_argument">_sender</span>, <span class="marker" id="mapping-392"></span><span class="token mv" id="move-src-186" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-393"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-394"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-395"></span><span class="token del" data-title="call_expression/member_expression">balances.subBalance</span>(<span class="marker" id="mapping-396"></span><span class="token mv" id="move-src-187" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-397"></span><span class="token mv" id="move-src-188" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-398"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-399"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-400"></span><span class="token del" data-title="call_expression/member_expression">balances.addBalance</span>(<span class="marker" id="mapping-401"></span><span class="token mv" id="move-src-189" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-402"></span><span class="token mv" id="move-src-190" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-403"></span><span class="token del" data-title="function_body/emit_statement">emit Transfer(_from, originalTo, _value);</span>
        <span class="marker" id="mapping-404"></span><span class="token del" data-title="function_body/if_statement">if (originalTo != _to) {
            emit Transfer(originalTo, _to, _value);
            if (hasHook) {
                TrueCoinReceiver(_to).tokenFallback(originalTo, _value);
            }
        } else {
            if (hasHook) {
                TrueCoinReceiver(_to).tokenFallback(_from, _value);
            }
        }</span>
    }</span></span>

    function <span class="marker" id="mapping-405"></span><span class="token upd" id="move-src-191" data-title="function_definition/identifier"><span class="cupd">_transfer</span><span class="cupd">AllArgs</span></span>(address _from, address _to, uint256 _value) internal {
        bool hasHook;
        address originalTo = _to;
        (_to, hasHook) = <span class="marker" id="mapping-406"></span><span class="token del" data-title="call_expression/member_expression">registry.requireCanTransfer</span>(<span class="marker" id="mapping-407"></span><span class="token mv" id="move-src-192" data-title="call_expression/call_argument">_from</span>, _to);
        <span class="marker" id="mapping-408"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-409"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-410"></span><span class="token del" data-title="call_expression/member_expression">balances.subBalance</span>(<span class="marker" id="mapping-411"></span><span class="token mv" id="move-src-193" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-412"></span><span class="token mv" id="move-src-194" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-413"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-414"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-415"></span><span class="token del" data-title="call_expression/member_expression">balances.addBalance</span>(<span class="marker" id="mapping-416"></span><span class="token mv" id="move-src-195" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-417"></span><span class="token mv" id="move-src-196" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        emit Transfer(_from, originalTo, _value);
        if (originalTo != _to) {
            emit Transfer(originalTo, _to, _value);
            if (hasHook) {
                TrueCoinReceiver(_to).tokenFallback(originalTo, _value);
            }
        } else {
            if (hasHook) {
                TrueCoinReceiver(_to).tokenFallback(_from, _value);
            }
        }
    }

    function mint(address _to, uint256 _value) public onlyOwner {
        require(_to != address(0), "to address cannot be zero");
        bool hasHook;
        address originalTo = _to;
        <span class="marker" id="mapping-418"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-419"></span><span class="token del" data-title="expression_statement/assignment_expression"><span class="marker" id="mapping-420"></span><span class="token del" data-title="assignment_expression/tuple_expression">(_to, hasHook)</span> = <span class="marker" id="mapping-421"></span><span class="token del" data-title="assignment_expression/call_expression"><span class="marker" id="mapping-422"></span><span class="token del" data-title="call_expression/member_expression">registry.requireCanMint</span>(<span class="marker" id="mapping-423"></span><span class="token mv" id="move-src-197" data-title="call_expression/call_argument">_to</span>)</span></span>;</span>
        totalSupply_ = totalSupply_.add(_value);
        emit Mint(originalTo, _value);
        emit Transfer(address(0), originalTo, _value);
        if (_to != originalTo) {
            emit Transfer(originalTo, _to, _value);
        }
        <span class="marker" id="mapping-424"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-425"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-426"></span><span class="token del" data-title="call_expression/member_expression">balances.addBalance</span>(<span class="marker" id="mapping-427"></span><span class="token mv" id="move-src-198" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-428"></span><span class="token mv" id="move-src-199" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        if (hasHook) {
            if (_to != originalTo) {
                TrueCoinReceiver(_to).tokenFallback(originalTo, _value);
            } else {
                TrueCoinReceiver(_to).tokenFallback(address(0), _value);
            }
        }
    }
}

<span class="marker" id="mapping-429"></span><span class="token del" data-title="source_file/comment">// File: contracts/RedeemableToken.sol</span>

<span class="marker" id="mapping-430"></span><span class="token del" data-title="source_file/comment">/** @title Redeemable Token 
Makes transfers to 0x0 alias to Burn
Implement Redemption Addresses
*/</span>
<span class="marker" id="mapping-431"></span><span class="token del" data-title="source_file/contract_declaration">contract RedeemableToken is <span class="marker" id="mapping-432"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">ModularMintableToken</span> <span class="marker" id="mapping-433"></span><span class="token del" data-title="contract_declaration/contract_body">{

    <span class="marker" id="mapping-434"></span><span class="token del" data-title="contract_body/event_definition">event RedemptionAddress(address indexed addr);</span>

    <span class="marker" id="mapping-435"></span><span class="token mv" id="move-src-200" data-title="contract_body/state_variable_declaration">uint256 <span class="marker" id="mapping-436"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant REDEMPTION_ADDRESS_COUNT = 0x100000;</span>

    <span class="marker" id="mapping-437"></span><span class="token del" data-title="contract_body/function_definition">function _transferAllArgs(<span class="marker" id="mapping-438"></span><span class="token mv" id="move-src-201" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-439"></span><span class="token mv" id="move-src-202" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-440"></span><span class="token mv" id="move-src-203" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-441"></span><span class="token mv" id="move-src-204" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-442"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-443"></span><span class="token del" data-title="function_body/if_statement">if (<span class="marker" id="mapping-444"></span><span class="token mv" id="move-src-205" data-title="if_statement/binary_expression"><span class="marker" id="mapping-445"></span><span class="token del" data-title="binary_expression/identifier">_to</span> == address(<span class="marker" id="mapping-446"></span><span class="token del" data-title="call_argument/number_literal">0</span>)</span>) <span class="marker" id="mapping-447"></span><span class="token del" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-448"></span><span class="token del" data-title="block_statement/revert_statement">revert<span class="marker" id="mapping-449"></span><span class="token del" data-title="revert_statement/parenthesized_expression">(<span class="marker" id="mapping-450"></span><span class="token mv" id="move-src-206" data-title="parenthesized_expression/string_literal">"_to address is 0x0"</span>)</span>;</span>
        }</span> else <span class="marker" id="mapping-451"></span><span class="token mv" id="move-src-207" data-title="if_statement/if_statement">if (<span class="marker" id="mapping-452"></span><span class="token del" data-title="type_cast_expression/primitive_type">uint</span>(_to) &lt; REDEMPTION_ADDRESS_COUNT) {
            <span class="marker" id="mapping-453"></span><span class="token del" data-title="block_statement/comment">// Transfers to redemption addresses becomes burn</span>
            <span class="marker" id="mapping-454"></span><span class="token del" data-title="call_expression/member_expression">super._transferAllArgs</span>(_from, _to, _value);
            <span class="marker" id="mapping-455"></span><span class="token mv" id="move-src-208" data-title="block_statement/expression_statement"><span class="marker" id="mapping-456"></span><span class="token del" data-title="call_expression/identifier">_burnAllArgs</span>(_to, _value);</span>
        } else {
            <span class="marker" id="mapping-457"></span><span class="token del" data-title="block_statement/expression_statement"><span class="marker" id="mapping-458"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-459"></span><span class="token del" data-title="call_expression/member_expression">super._transferAllArgs</span>(<span class="marker" id="mapping-460"></span><span class="token mv" id="move-src-209" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-461"></span><span class="token mv" id="move-src-210" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-462"></span><span class="token mv" id="move-src-211" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        }</span></span>
    }</span></span>

    <span class="marker" id="mapping-463"></span><span class="token del" data-title="contract_body/function_definition">function _transferFromAllArgs(<span class="marker" id="mapping-464"></span><span class="token mv" id="move-src-212" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-465"></span><span class="token mv" id="move-src-213" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-466"></span><span class="token mv" id="move-src-214" data-title="function_definition/parameter">uint256 _value</span>, <span class="marker" id="mapping-467"></span><span class="token mv" id="move-src-215" data-title="function_definition/parameter">address _sender</span>) <span class="marker" id="mapping-468"></span><span class="token mv" id="move-src-216" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-469"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-470"></span><span class="token del" data-title="function_body/if_statement">if (<span class="marker" id="mapping-471"></span><span class="token del" data-title="if_statement/binary_expression">_to == <span class="marker" id="mapping-472"></span><span class="token del" data-title="binary_expression/type_cast_expression"><span class="marker" id="mapping-473"></span><span class="token mv" id="move-src-217" data-title="type_cast_expression/primitive_type">address</span>(<span class="marker" id="mapping-474"></span><span class="token del" data-title="type_cast_expression/call_argument">0</span>)</span></span>) <span class="marker" id="mapping-475"></span><span class="token del" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-476"></span><span class="token del" data-title="block_statement/revert_statement">revert<span class="marker" id="mapping-477"></span><span class="token del" data-title="revert_statement/parenthesized_expression">(<span class="marker" id="mapping-478"></span><span class="token mv" id="move-src-218" data-title="parenthesized_expression/string_literal">"_to address is 0x0"</span>)</span>;</span>
        }</span> else <span class="marker" id="mapping-479"></span><span class="token mv" id="move-src-219" data-title="if_statement/if_statement">if (<span class="marker" id="mapping-480"></span><span class="token del" data-title="if_statement/binary_expression"><span class="marker" id="mapping-481"></span><span class="token del" data-title="binary_expression/type_cast_expression"><span class="marker" id="mapping-482"></span><span class="token del" data-title="type_cast_expression/primitive_type">uint</span>(<span class="marker" id="mapping-483"></span><span class="token mv" id="move-src-220" data-title="type_cast_expression/call_argument">_to</span>)</span> &lt; REDEMPTION_ADDRESS_COUNT</span>) {
            <span class="marker" id="mapping-484"></span><span class="token del" data-title="block_statement/comment">// Transfers to redemption addresses becomes burn</span>
            <span class="marker" id="mapping-485"></span><span class="token mv" id="move-src-221" data-title="block_statement/expression_statement"><span class="marker" id="mapping-486"></span><span class="token del" data-title="call_expression/member_expression">super._transferFromAllArgs</span>(_from, _to, _value<span class="marker" id="mapping-487"></span><span class="token del" data-title="call_expression/,">,</span> <span class="marker" id="mapping-488"></span><span class="token del" data-title="call_expression/call_argument">_sender</span>);</span>
            <span class="marker" id="mapping-489"></span><span class="token del" data-title="expression_statement/call_expression">_burnAllArgs(<span class="marker" id="mapping-490"></span><span class="token mv" id="move-src-222" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-491"></span><span class="token mv" id="move-src-223" data-title="call_expression/call_argument">_value</span>)</span>;
        } else {
            <span class="marker" id="mapping-492"></span><span class="token del" data-title="block_statement/expression_statement"><span class="marker" id="mapping-493"></span><span class="token del" data-title="expression_statement/call_expression"><span class="marker" id="mapping-494"></span><span class="token del" data-title="call_expression/member_expression">super._transferFromAllArgs</span>(<span class="marker" id="mapping-495"></span><span class="token mv" id="move-src-224" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-496"></span><span class="token mv" id="move-src-225" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-497"></span><span class="token mv" id="move-src-226" data-title="call_expression/call_argument">_value</span>, <span class="marker" id="mapping-498"></span><span class="token del" data-title="call_expression/call_argument">_sender</span>)</span>;</span>
        }</span></span>
    }</span></span>
}</span></span>

<span class="marker" id="mapping-499"></span><span class="token del" data-title="source_file/comment">// File: contracts/GasRefundToken.sol</span>

<span class="marker" id="mapping-500"></span><span class="token del" data-title="source_file/comment">/**  
@title Gas Refund Token
Allow any user to sponsor gas refunds for transfer and mints. Utilitzes the gas refund mechanism in EVM
Each time an non-empty storage slot is set to 0, evm refund 15,000 (19,000 after Constantinople) to the sender
of the transaction. 
*/</span>
<span class="marker" id="mapping-501"></span><span class="token mv" id="move-src-227" data-title="source_file/contract_declaration">contract <span class="marker" id="mapping-502"></span><span class="token upd" id="move-src-228" data-title="contract_declaration/identifier"><span class="cupd">GasRefund</span>Token</span> is <span class="marker" id="mapping-503"></span><span class="token upd" id="move-src-229" data-title="user_defined_type/identifier">M<span class="cupd">o</span>dula<span class="cupd">r</span>Mint<span class="cupd">a</span>bleToken</span> {

    <span class="marker" id="mapping-504"></span><span class="token del" data-title="contract_body/function_definition">function sponsorGas() <span class="marker" id="mapping-505"></span><span class="token mv" id="move-src-230" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-506"></span><span class="token mv" id="move-src-231" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-507"></span><span class="token mv" id="move-src-232" data-title="function_body/variable_declaration_statement">uint256 len = <span class="marker" id="mapping-508"></span><span class="token upd" id="move-src-233" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span></span>.length;</span>
        uint256 refundPrice = minimumGasPriceForFutureRefunds;
        require(refundPrice &gt; 0);
        <span class="marker" id="mapping-509"></span><span class="token upd" id="move-src-234" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span></span>.length = len + 9;
        <span class="marker" id="mapping-510"></span><span class="token upd" id="move-src-235" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len] = refundPrice;
        <span class="marker" id="mapping-511"></span><span class="token upd" id="move-src-236" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 1] = refundPrice;
        <span class="marker" id="mapping-512"></span><span class="token upd" id="move-src-237" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 2] = refundPrice;
        <span class="marker" id="mapping-513"></span><span class="token upd" id="move-src-238" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 3] = refundPrice;
        <span class="marker" id="mapping-514"></span><span class="token upd" id="move-src-239" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 4] = refundPrice;
        <span class="marker" id="mapping-515"></span><span class="token upd" id="move-src-240" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 5] = refundPrice;
        <span class="marker" id="mapping-516"></span><span class="token upd" id="move-src-241" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 6] = refundPrice;
        <span class="marker" id="mapping-517"></span><span class="token upd" id="move-src-242" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 7] = refundPrice;
        <span class="marker" id="mapping-518"></span><span class="token upd" id="move-src-243" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span></span>[len + 8] = refundPrice;
    }</span></span>

    <span class="marker" id="mapping-519"></span><span class="token del" data-title="contract_body/function_definition">function minimumGasPriceForRefund() <span class="marker" id="mapping-520"></span><span class="token mv" id="move-src-244" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-521"></span><span class="token mv" id="move-src-245" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-522"></span><span class="token mv" id="move-src-246" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-523"></span><span class="token mv" id="move-src-247" data-title="function_definition/function_body">{
        uint256 len = <span class="marker" id="mapping-524"></span><span class="token upd" id="move-src-248" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span></span>.length;
        if (<span class="marker" id="mapping-525"></span><span class="token mv" id="move-src-249" data-title="if_statement/binary_expression">len &gt; 0</span>) {
          <span class="marker" id="mapping-526"></span><span class="token del" data-title="block_statement/return_statement">return <span class="marker" id="mapping-527"></span><span class="token del" data-title="return_statement/binary_expression"><span class="marker" id="mapping-528"></span><span class="token del" data-title="binary_expression/array_access">gasRefundPool[<span class="marker" id="mapping-529"></span><span class="token mv" id="move-src-250" data-title="array_access/binary_expression">len - 1</span>]</span> + 1</span>;</span>
        }
        <span class="marker" id="mapping-530"></span><span class="token del" data-title="function_body/return_statement">return <span class="marker" id="mapping-531"></span><span class="token del" data-title="return_statement/type_cast_expression"><span class="marker" id="mapping-532"></span><span class="token mv" id="move-src-251" data-title="type_cast_expression/primitive_type">uint256</span>(<span class="marker" id="mapping-533"></span><span class="token del" data-title="type_cast_expression/call_argument">-1</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-534"></span><span class="token del" data-title="contract_body/comment">/**  
    @dev refund 45,000 gas for functions with gasRefund modifier.
    */</span>
    modifier <span class="marker" id="mapping-535"></span><span class="token upd" id="move-src-252" data-title="modifier_definition/identifier">g<span class="cupd">asRefund</span></span> {
        uint256 len = <span class="marker" id="mapping-536"></span><span class="token upd" id="move-src-253" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span></span>.length;
        if (len &gt; 2 &amp;&amp; tx.gasprice &gt; <span class="marker" id="mapping-537"></span><span class="token upd" id="move-src-254" data-title="binary_expression/identifier"><span class="cupd">gasRefundPool</span></span>[len-1]) {
            <span class="marker" id="mapping-538"></span><span class="token upd" id="move-src-255" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span></span>.length = len - 3;
        }
        <span class="marker" id="mapping-539"></span><span class="token mv" id="move-src-256" data-title="function_body/expression_statement">_;</span>
    }

    <span class="marker" id="mapping-540"></span><span class="token del" data-title="contract_body/comment">/**  
    *@dev Return the remaining sponsored gas slots
    */</span>
    <span class="marker" id="mapping-541"></span><span class="token del" data-title="contract_body/function_definition">function remainingGasRefundPool() <span class="marker" id="mapping-542"></span><span class="token mv" id="move-src-257" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-543"></span><span class="token mv" id="move-src-258" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-544"></span><span class="token del" data-title="function_definition/return_type_definition">returns (uint)</span> <span class="marker" id="mapping-545"></span><span class="token del" data-title="function_definition/function_body">{
        return gasRefundPool.length;
    }</span></span>

    <span class="marker" id="mapping-546"></span><span class="token mv" id="move-src-259" data-title="contract_body/function_definition">function <span class="marker" id="mapping-547"></span><span class="token upd" id="move-src-260" data-title="function_definition/identifier"><span class="cupd">remaining</span>Spon<span class="cupd">s</span>or<span class="cupd">e</span><span class="cupd">d</span>Transactions</span>() public view returns (uint) {
        <span class="marker" id="mapping-548"></span><span class="token del" data-title="function_body/return_statement">return gasRefundPool.length / 3;</span>
    }</span>

    <span class="marker" id="mapping-549"></span><span class="token mv" id="move-src-261" data-title="contract_body/function_definition">function <span class="marker" id="mapping-550"></span><span class="token upd" id="move-src-262" data-title="function_definition/identifier"><span class="cupd">_</span>t<span class="cupd">r</span>ansf<span class="cupd">e</span><span class="cupd">r</span>A<span class="cupd">l</span>lArgs</span>(address _from<span class="marker" id="mapping-551"></span><span class="token del" data-title="function_definition/,">,</span> <span class="marker" id="mapping-552"></span><span class="token mv" id="move-src-263" data-title="function_definition/parameter">address _to</span><span class="marker" id="mapping-553"></span><span class="token del" data-title="function_definition/,">,</span> <span class="marker" id="mapping-554"></span><span class="token mv" id="move-src-264" data-title="function_definition/parameter">uint256 _value</span>) internal <span class="marker" id="mapping-555"></span><span class="token del" data-title="function_definition/modifier_invocation">gasRefund</span> {
        <span class="marker" id="mapping-556"></span><span class="token mv" id="move-src-265" data-title="member_expression/identifier"><span class="marker" id="mapping-557"></span><span class="token upd" id="move-src-266" data-title="member_expression/identifier">s<span class="cupd">u</span>p<span class="cupd">e</span>r</span></span>.<span class="marker" id="mapping-558"></span><span class="token del" data-title="member_expression/identifier">_transferAllArgs</span>(_from<span class="marker" id="mapping-559"></span><span class="token del" data-title="call_expression/,">,</span> <span class="marker" id="mapping-560"></span><span class="token mv" id="move-src-267" data-title="call_expression/call_argument">_to</span><span class="marker" id="mapping-561"></span><span class="token del" data-title="call_expression/,">,</span> <span class="marker" id="mapping-562"></span><span class="token mv" id="move-src-268" data-title="call_expression/call_argument">_value</span>);
    }</span>

    <span class="marker" id="mapping-563"></span><span class="token mv" id="move-src-269" data-title="contract_body/function_definition">function <span class="marker" id="mapping-564"></span><span class="token upd" id="move-src-270" data-title="function_definition/identifier"><span class="cupd">_</span>t<span class="cupd">r</span><span class="cupd">an</span><span class="cupd">sferFrom</span>AllArgs</span>(<span class="marker" id="mapping-565"></span><span class="token mv" id="move-src-271" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-566"></span><span class="token mv" id="move-src-272" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-567"></span><span class="token mv" id="move-src-273" data-title="function_definition/parameter">uint256 _value</span><span class="marker" id="mapping-568"></span><span class="token del" data-title="function_definition/,">,</span> <span class="marker" id="mapping-569"></span><span class="token del" data-title="function_definition/parameter">address _sender</span>) <span class="marker" id="mapping-570"></span><span class="token mv" id="move-src-274" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-571"></span><span class="token del" data-title="function_definition/modifier_invocation">gasRefund</span> {
        <span class="marker" id="mapping-572"></span><span class="token del" data-title="function_body/expression_statement"><span class="marker" id="mapping-573"></span><span class="token mv" id="move-src-275" data-title="expression_statement/call_expression"><span class="marker" id="mapping-574"></span><span class="token mv" id="move-src-276" data-title="member_expression/identifier"><span class="marker" id="mapping-575"></span><span class="token upd" id="move-src-277" data-title="member_expression/identifier">s<span class="cupd">u</span>p<span class="cupd">e</span>r</span></span>.<span class="marker" id="mapping-576"></span><span class="token del" data-title="member_expression/identifier">_transferFromAllArgs</span>(<span class="marker" id="mapping-577"></span><span class="token mv" id="move-src-278" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-578"></span><span class="token mv" id="move-src-279" data-title="call_expression/call_argument">_to</span>, <span class="marker" id="mapping-579"></span><span class="token mv" id="move-src-280" data-title="call_expression/call_argument">_value</span><span class="marker" id="mapping-580"></span><span class="token del" data-title="call_expression/,">,</span> <span class="marker" id="mapping-581"></span><span class="token mv" id="move-src-281" data-title="call_expression/call_argument">_sender</span>)</span>;</span>
    }</span>

    <span class="marker" id="mapping-582"></span><span class="token del" data-title="contract_body/function_definition">function mint(<span class="marker" id="mapping-583"></span><span class="token mv" id="move-src-282" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-584"></span><span class="token mv" id="move-src-283" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-585"></span><span class="token mv" id="move-src-284" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-586"></span><span class="token del" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-587"></span><span class="token del" data-title="function_definition/modifier_invocation">gasRefund</span> <span class="marker" id="mapping-588"></span><span class="token del" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-589"></span><span class="token mv" id="move-src-285" data-title="function_body/expression_statement"><span class="marker" id="mapping-590"></span><span class="token del" data-title="call_expression/member_expression">super.mint</span>(_to, _value);</span>
    }</span></span>

    <span class="marker" id="mapping-591"></span><span class="token mv" id="move-src-286" data-title="contract_body/state_variable_declaration">bytes32 <span class="marker" id="mapping-592"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-593"></span><span class="token upd" id="move-src-287" data-title="state_variable_declaration/identifier"><span class="cupd">CAN_</span>SET_F<span class="cupd">U</span>TU<span class="cupd">R</span>E_REFUND_MIN_GAS_PRICE</span> = "canSetFutureRefundMinGasPrice";</span>

    <span class="marker" id="mapping-594"></span><span class="token mv" id="move-src-288" data-title="contract_body/function_definition">function setMinimumGasPriceForFutureRefunds(uint256 _minimumGasPriceForFutureRefunds) public {
        require(registry.hasAttribute(msg.sender, CAN_SET_FUTURE_REFUND_MIN_GAS_PRICE));
        minimumGasPriceForFutureRefunds = _minimumGasPriceForFutureRefunds;
    }</span>
}</span>

// File: contracts/DelegateERC20.sol

/** @title DelegateERC20
Accept forwarding delegation calls from the old TrueUSD (V1) contract. This way the all the ERC20
functions in the old contract still works (except Burn). 
*/
contract DelegateERC20 is <span class="marker" id="mapping-595"></span><span class="token upd" id="move-src-289" data-title="user_defined_type/identifier">M<span class="cupd">o</span>du<span class="cupd">l</span><span class="cupd">a</span>rS<span class="cupd">t</span>andard<span class="cupd">Token</span></span> {

    address <span class="marker" id="mapping-596"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant DELEGATE_FROM = 0x8dd5fbCe2F6a956C3022bA3663759011Dd51e73E;
    
    modifier onlyDelegateFrom() {
        require(msg.sender == DELEGATE_FROM);
        _;
    }

    function delegateTotalSupply() public view returns (uint256) {
        return totalSupply();
    }

    function delegateBalanceOf(address who) public view returns (uint256) {
        return <span class="marker" id="mapping-597"></span><span class="token upd" id="move-src-290" data-title="call_expression/identifier">b<span class="cupd">alance</span>Of</span>(who);
    }

    function delegateTransfer(address to, uint256 value, address origSender) public onlyDelegateFrom returns (bool) {
        _transferAllArgs(origSender, to, value);
        return true;
    }

    function delegateAllowance(address owner, address spender) public view returns (uint256) {
        return <span class="marker" id="mapping-598"></span><span class="token upd" id="move-src-291" data-title="call_expression/identifier">a<span class="cupd">llowance</span></span>(owner, spender);
    }

    function delegateTransferFrom(address from, address to, uint256 value, address origSender) public onlyDelegateFrom returns (bool) {
        _transferFromAllArgs(from, to, value, origSender);
        return true;
    }

    function delegateApprove(address spender, uint256 value, address origSender) public onlyDelegateFrom returns (bool) {
        _approveAllArgs(spender, value, origSender);
        return true;
    }

    function delegateIncreaseApproval(address spender, uint addedValue, address origSender) public onlyDelegateFrom returns (bool) {
        _increaseApprovalAllArgs(spender, addedValue, origSender);
        return true;
    }

    function delegateDecreaseApproval(address spender, uint subtractedValue, address origSender) public onlyDelegateFrom returns (bool) {
        _decreaseApprovalAllArgs(spender, subtractedValue, origSender);
        return true;
    }
}

// File: contracts/TrueUSD.sol

/** @title TrueUSD
* @dev This is the top-level ERC20 contract, but most of the interesting functionality is
* inherited - see the documentation on the corresponding contracts.
*/
<span class="marker" id="mapping-599"></span><span class="token mv" id="move-src-292" data-title="source_file/contract_declaration">contract <span class="marker" id="mapping-600"></span><span class="token upd" id="move-src-293" data-title="contract_declaration/identifier"><span class="cupd">T</span>rueUSD</span> is 
<span class="marker" id="mapping-601"></span><span class="token upd" id="move-src-294" data-title="user_defined_type/identifier">Modul<span class="cupd">a</span>rMi<span class="cupd">n</span>tableToken</span><span class="marker" id="mapping-602"></span><span class="token del" data-title="contract_declaration/,">,</span> 
<span class="marker" id="mapping-603"></span><span class="token mv" id="move-src-295" data-title="contract_declaration/inheritance_specifier">CompliantDepositTokenWithHook</span><span class="marker" id="mapping-604"></span><span class="token del" data-title="contract_declaration/,">,</span>
<span class="marker" id="mapping-605"></span><span class="token mv" id="move-src-296" data-title="contract_declaration/inheritance_specifier">BurnableTokenWithBounds</span><span class="marker" id="mapping-606"></span><span class="token del" data-title="contract_declaration/,">,</span> 
<span class="marker" id="mapping-607"></span><span class="token del" data-title="contract_declaration/inheritance_specifier">RedeemableToken</span><span class="marker" id="mapping-608"></span><span class="token del" data-title="contract_declaration/,">,</span>
<span class="marker" id="mapping-609"></span><span class="token mv" id="move-src-297" data-title="contract_declaration/inheritance_specifier">DelegateERC20</span><span class="marker" id="mapping-610"></span><span class="token del" data-title="contract_declaration/,">,</span>
<span class="marker" id="mapping-611"></span><span class="token mv" id="move-src-298" data-title="contract_declaration/inheritance_specifier">GasRefundToken</span> {
    <span class="marker" id="mapping-612"></span><span class="token del" data-title="contract_body/using_directive">using SafeMath for *;</span>

    <span class="marker" id="mapping-613"></span><span class="token mv" id="move-src-299" data-title="contract_body/state_variable_declaration">uint8 <span class="marker" id="mapping-614"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-615"></span><span class="token upd" id="move-src-300" data-title="state_variable_declaration/identifier"><span class="cupd">D</span>ECIMALS</span> = <span class="marker" id="mapping-616"></span><span class="token upd" id="move-src-301" data-title="state_variable_declaration/number_literal">18</span>;</span>
    <span class="marker" id="mapping-617"></span><span class="token mv" id="move-src-302" data-title="contract_body/state_variable_declaration">uint8 <span class="marker" id="mapping-618"></span><span class="token del" data-title="state_variable_declaration/visibility">public</span> constant <span class="marker" id="mapping-619"></span><span class="token upd" id="move-src-303" data-title="state_variable_declaration/identifier">ROUN<span class="cupd">D</span>ING</span> = <span class="marker" id="mapping-620"></span><span class="token upd" id="move-src-304" data-title="state_variable_declaration/number_literal">2</span>;</span>

    <span class="marker" id="mapping-621"></span><span class="token del" data-title="contract_body/event_definition">event ChangeTokenName(string newName, string newSymbol);</span>

    <span class="marker" id="mapping-622"></span><span class="token mv" id="move-src-305" data-title="contract_body/function_definition">function decimals() public pure returns (uint8) {
        return DECIMALS;
    }</span>

    <span class="marker" id="mapping-623"></span><span class="token mv" id="move-src-306" data-title="contract_body/function_definition">function rounding() public pure returns (uint8) {
        return ROUNDING;
    }</span>

    <span class="marker" id="mapping-624"></span><span class="token del" data-title="contract_body/function_definition">function changeTokenName(<span class="marker" id="mapping-625"></span><span class="token mv" id="move-src-307" data-title="function_definition/parameter">string <span class="marker" id="mapping-626"></span><span class="token del" data-title="parameter/identifier">_name</span></span>, <span class="marker" id="mapping-627"></span><span class="token mv" id="move-src-308" data-title="function_definition/parameter">string <span class="marker" id="mapping-628"></span><span class="token del" data-title="parameter/identifier">_symbol</span></span>) <span class="marker" id="mapping-629"></span><span class="token mv" id="move-src-309" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-630"></span><span class="token del" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-631"></span><span class="token del" data-title="function_definition/function_body">{
        name = _name;
        symbol = _symbol;
        emit ChangeTokenName(_name, _symbol);
    }</span></span>

    <span class="marker" id="mapping-632"></span><span class="token upd" id="move-src-310" data-title="contract_body/comment"><span class="cupd">/**  
    *@dev send all eth balance in the</span> TrueUSD<span class="cupd"> contract to another address
    </span>*/</span>
    function reclaimEther(address _to) external onlyOwner {
        _to.transfer(address(this).balance);
    }

    <span class="marker" id="mapping-633"></span><span class="token upd" id="move-src-311" data-title="contract_body/comment"><span class="cupd">/**  
    *@dev send all token balance of an arbitary erc20 token
    in th</span>e TrueUS<span class="cupd">D contract to another address
   </span> */</span>
    function reclaimToken(ERC20 token, address _to) external onlyOwner {
        uint256 balance = token.balanceOf(this);
        token.transfer(_to, balance);
    }

    <span class="marker" id="mapping-634"></span><span class="token mv" id="move-src-312" data-title="contract_body/function_definition">function paused() public pure returns (bool) {
        return false;
    }</span>

    <span class="marker" id="mapping-635"></span><span class="token upd" id="move-src-313" data-title="contract_body/comment"><span class="cupd">/**  
    *@dev allows owner of</span> Tr<span class="cupd">u</span>eUS<span class="cupd">D</span><span class="cupd"> </span><span class="cupd">to gain ownership of any contract that</span> Tr<span class="cupd">u</span>eUS<span class="cupd">D </span><span class="cupd">currently owns
    </span>*/</span>
    function reclaimContract(Ownable _ownable) external onlyOwner {
        _ownable.transferOwnership(owner);
    }

    <span class="marker" id="mapping-636"></span><span class="token del" data-title="contract_body/function_definition">function _burnAllArgs(<span class="marker" id="mapping-637"></span><span class="token del" data-title="function_definition/parameter">address _burner</span>, <span class="marker" id="mapping-638"></span><span class="token mv" id="move-src-314" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-639"></span><span class="token mv" id="move-src-315" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-640"></span><span class="token del" data-title="function_definition/function_body">{
        //round down burn amount so that the lowest amount allowed is 1 cent
        <span class="marker" id="mapping-641"></span><span class="token del" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-642"></span><span class="token del" data-title="variable_declaration_statement/variable_declaration">uint burnAmount</span> = <span class="marker" id="mapping-643"></span><span class="token del" data-title="variable_declaration_statement/call_expression"><span class="marker" id="mapping-644"></span><span class="token del" data-title="call_expression/member_expression"><span class="marker" id="mapping-645"></span><span class="token del" data-title="member_expression/call_expression"><span class="marker" id="mapping-646"></span><span class="token del" data-title="call_expression/member_expression">_value.div</span>(<span class="marker" id="mapping-647"></span><span class="token del" data-title="call_expression/call_argument"><span class="marker" id="mapping-648"></span><span class="token del" data-title="call_argument/binary_expression">10 ** <span class="marker" id="mapping-649"></span><span class="token del" data-title="binary_expression/type_cast_expression"><span class="marker" id="mapping-650"></span><span class="token mv" id="move-src-316" data-title="type_cast_expression/primitive_type">uint256</span>(<span class="marker" id="mapping-651"></span><span class="token del" data-title="type_cast_expression/call_argument">DECIMALS - ROUNDING</span>)</span></span></span>)</span>.mul</span>(<span class="marker" id="mapping-652"></span><span class="token del" data-title="call_expression/call_argument"><span class="marker" id="mapping-653"></span><span class="token del" data-title="call_argument/binary_expression">10 ** <span class="marker" id="mapping-654"></span><span class="token del" data-title="binary_expression/type_cast_expression"><span class="marker" id="mapping-655"></span><span class="token mv" id="move-src-317" data-title="type_cast_expression/primitive_type">uint256</span>(<span class="marker" id="mapping-656"></span><span class="token del" data-title="type_cast_expression/call_argument">DECIMALS - ROUNDING</span>)</span></span></span>)</span>;</span>
        <span class="marker" id="mapping-657"></span><span class="token del" data-title="function_body/expression_statement">super._burnAllArgs(_burner, burnAmount);</span>
    }</span></span>
}</span></pre></div><div class="col-6"><h5>0x137ceae7ea876986d280f5916832d51832f79985.etherscan.io-ProvisionalTrueUSD.sol</h5><pre class="pre-scrollable">pragma solidity ^0.4.23;

<span class="marker" id="mapping-658"></span><span class="token mv" id="move-dst-53" data-title="source_file/comment"><span class="marker" id="mapping-659"></span><span class="token upd" id="move-dst-53" data-title="source_file/comment"><span class="cupd">/</span>/<span class="cupd"> </span>F<span class="cupd">i</span><span class="cupd">l</span><span class="cupd">e</span>:<span class="cupd"> </span><span class="cupd">contract</span><span class="cupd">s</span>/T<span class="cupd">r</span><span class="cupd">u</span><span class="cupd">e</span>C<span class="cupd">o</span>i<span class="cupd">n</span>R<span class="cupd">e</span>c<span class="cupd">e</span>i<span class="cupd">ver</span>.<span class="cupd">s</span><span class="cupd">o</span>l</span></span>

<span class="marker" id="mapping-660"></span><span class="token mv" id="move-dst-169" data-title="source_file/contract_declaration">contract TrueCoinReceiver {
    function tokenFallback( address from, uint256 value ) external;
}</span>

// File: openzeppelin-solidity/contracts/token/ERC20/ERC20Basic.sol

/**
 * @title ERC20Basic
 * @dev Simpler version of ERC20 interface
 * @dev see https://github.com/ethereum/EIPs/issues/179
 */
contract ERC20Basic {
  function totalSupply() public view returns (uint256);
  function balanceOf(address who) public view returns (uint256);
  function transfer(address to, uint256 value) public returns (bool);
  event Transfer(address indexed from, address indexed to, uint256 value);
}

// File: openzeppelin-solidity/contracts/token/ERC20/ERC20.sol

/**
 * @title ERC20 interface
 * @dev see https://github.com/ethereum/EIPs/issues/20
 */
contract ERC20 is ERC20Basic {
  function allowance(address owner, address spender) public view returns (uint256);
  function transferFrom(address from, address to, uint256 value) public returns (bool);
  function approve(address spender, uint256 value) public returns (bool);
  event Approval(address indexed owner, address indexed spender, uint256 value);
}

// File: registry/contracts/Registry.sol

<span class="marker" id="mapping-661"></span><span class="token add" data-title="source_file/interface_declaration">interface RegistryClone {
    function syncAttributeValue(address _who, bytes32 _attribute, uint256 _value) external;
}</span>

contract Registry {
    struct AttributeData {
        uint256 value;
        bytes32 notes;
        address adminAddr;
        uint256 timestamp;
    }
    
    <span class="marker" id="mapping-662"></span><span class="token mv" id="move-dst-47" data-title="contract_body/comment"><span class="marker" id="mapping-663"></span><span class="token upd" id="move-dst-47" data-title="contract_body/comment"><span class="cupd">/</span>/<span class="cupd"> </span>n<span class="cupd">ev</span><span class="cupd">e</span>r<span class="cupd"> </span><span class="cupd">r</span><span class="cupd">e</span>m<span class="cupd">o</span>v<span class="cupd">e </span>a<span class="cupd">n</span>y<span class="cupd"> </span>s<span class="cupd">to</span><span class="cupd">r</span><span class="cupd">a</span>g<span class="cupd">e</span><span class="cupd"> </span>va<span class="cupd">r</span><span class="cupd">i</span><span class="cupd">a</span>b<span class="cupd">l</span>es</span></span>
    address public owner;
    address public pendingOwner;
    bool initialized;

    // Stores arbitrary attributes for users. An example use case is an ERC20
    // token that requires its users to go through a KYC/AML check - in this case
    // a validator can set an account's "hasPassedKYC/AML" attribute to 1 to indicate
    // that account can use the token. This mapping stores that value (1, in the
    // example) as well as which validator last set the value and at what time,
    // so that e.g. the check can be renewed at appropriate intervals.
    mapping(address =&gt; mapping(bytes32 =&gt; AttributeData)) attributes;
    // The logic governing who is allowed to set what attributes is abstracted as
    // this accessManager, so that it may be replaced by the owner as needed
    bytes32 constant WRITE_PERMISSION = keccak256("canWriteTo-");
    <span class="marker" id="mapping-664"></span><span class="token add" data-title="contract_body/state_variable_declaration">mapping(bytes32 =&gt; RegistryClone[]) subscribers;</span>

    event OwnershipTransferred(
        address indexed previousOwner,
        address indexed newOwner
    );
    event SetAttribute(address indexed who, bytes32 attribute, uint256 value, bytes32 notes, address indexed adminAddr);
    event SetManager(address indexed oldManager, address indexed newManager);
    <span class="marker" id="mapping-665"></span><span class="token add" data-title="contract_body/event_definition">event StartSubscription(<span class="marker" id="mapping-666"></span><span class="token add" data-title="event_definition/event_paramater"><span class="marker" id="mapping-667"></span><span class="token mv" id="move-dst-4" data-title="event_paramater/type_name">bytes32</span> indexed attribute</span>, <span class="marker" id="mapping-668"></span><span class="token add" data-title="event_definition/event_paramater">RegistryClone indexed subscriber</span>);</span>
    <span class="marker" id="mapping-669"></span><span class="token add" data-title="contract_body/event_definition">event StopSubscription(<span class="marker" id="mapping-670"></span><span class="token add" data-title="event_definition/event_paramater"><span class="marker" id="mapping-671"></span><span class="token mv" id="move-dst-6" data-title="event_paramater/type_name">bytes32</span> indexed attribute</span>, <span class="marker" id="mapping-672"></span><span class="token add" data-title="event_definition/event_paramater">RegistryClone indexed subscriber</span>);</span>

    // Allows a write if either a) the writer is that Registry's owner, or
    // b) the writer is writing to attribute foo and that writer already has
    // the canWriteTo-foo attribute set (in that same Registry)
    function confirmWrite(bytes32 _attribute, address _admin) <span class="marker" id="mapping-673"></span><span class="token add" data-title="visibility/internal">internal</span> view returns (bool) {
        return (_admin == owner || hasAttribute(_admin, keccak256(WRITE_PERMISSION ^ _attribute)));
    }

    // Writes are allowed only if the accessManager approves
    function setAttribute(address _who, bytes32 _attribute, uint256 _value, bytes32 _notes) public {
        require(confirmWrite(_attribute, msg.sender));
        attributes[_who][_attribute] = AttributeData(_value, _notes, msg.sender, block.timestamp);
        emit SetAttribute(_who, _attribute, _value, _notes, msg.sender);

        <span class="marker" id="mapping-674"></span><span class="token add" data-title="function_body/variable_declaration_statement">RegistryClone[] storage targets = subscribers[_attribute];</span>
        <span class="marker" id="mapping-675"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 index = targets.length;</span>
        <span class="marker" id="mapping-676"></span><span class="token add" data-title="function_body/while_statement">while (<span class="marker" id="mapping-677"></span><span class="token add" data-title="while_statement/binary_expression">index --&gt; 0</span>) <span class="marker" id="mapping-678"></span><span class="token add" data-title="while_statement/block_statement">{
            <span class="marker" id="mapping-679"></span><span class="token add" data-title="block_statement/expression_statement"><span class="marker" id="mapping-680"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-681"></span><span class="token add" data-title="call_expression/member_expression">targets[index].syncAttributeValue</span>(<span class="marker" id="mapping-682"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-683"></span><span class="token add" data-title="call_expression/call_argument">_attribute</span>, <span class="marker" id="mapping-684"></span><span class="token mv" id="move-dst-186" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        }</span></span>
    }

    <span class="marker" id="mapping-685"></span><span class="token add" data-title="contract_body/function_definition">function subscribe(<span class="marker" id="mapping-686"></span><span class="token mv" id="move-dst-11" data-title="function_definition/parameter">bytes32 _attribute</span>, <span class="marker" id="mapping-687"></span><span class="token add" data-title="function_definition/parameter">RegistryClone _syncer</span>) <span class="marker" id="mapping-688"></span><span class="token add" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-689"></span><span class="token mv" id="move-dst-67" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-690"></span><span class="token add" data-title="function_definition/function_body">{
        subscribers[_attribute].push(_syncer);
        emit StartSubscription(_attribute, _syncer);
    }</span></span>

    <span class="marker" id="mapping-691"></span><span class="token add" data-title="contract_body/function_definition">function unsubscribe(<span class="marker" id="mapping-692"></span><span class="token add" data-title="function_definition/parameter">bytes32 _attribute</span>, <span class="marker" id="mapping-693"></span><span class="token add" data-title="function_definition/parameter">uint256 _index</span>) <span class="marker" id="mapping-694"></span><span class="token add" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-695"></span><span class="token mv" id="move-dst-94" data-title="function_definition/modifier_invocation">onlyOwner</span> <span class="marker" id="mapping-696"></span><span class="token add" data-title="function_definition/function_body">{
        uint256 length = subscribers[_attribute].length;
        require(_index &lt; length);
        emit StopSubscription(_attribute, subscribers[_attribute][_index]);
        subscribers[_attribute][_index] = subscribers[_attribute][length - 1];
        subscribers[_attribute].length = length - 1;
    }</span></span>

    <span class="marker" id="mapping-697"></span><span class="token add" data-title="contract_body/function_definition">function subscriberCount(<span class="marker" id="mapping-698"></span><span class="token mv" id="move-dst-22" data-title="function_definition/parameter">bytes32 _attribute</span>) <span class="marker" id="mapping-699"></span><span class="token mv" id="move-dst-23" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-700"></span><span class="token mv" id="move-dst-24" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-701"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-702"></span><span class="token add" data-title="function_definition/function_body">{
        return subscribers[_attribute].length;
    }</span></span>

    function setAttributeValue(address _who, bytes32 _attribute, uint256 _value) public {
        require(confirmWrite(_attribute, msg.sender));
        attributes[_who][_attribute] = AttributeData(_value, "", msg.sender, block.timestamp);
        emit SetAttribute(_who, _attribute, _value, "", msg.sender);
        <span class="marker" id="mapping-703"></span><span class="token add" data-title="function_body/variable_declaration_statement">RegistryClone[] storage targets = subscribers[_attribute];</span>
        <span class="marker" id="mapping-704"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 index = targets.length;</span>
        <span class="marker" id="mapping-705"></span><span class="token add" data-title="function_body/while_statement">while (<span class="marker" id="mapping-706"></span><span class="token add" data-title="while_statement/binary_expression">index --&gt; 0</span>) <span class="marker" id="mapping-707"></span><span class="token add" data-title="while_statement/block_statement">{
            <span class="marker" id="mapping-708"></span><span class="token add" data-title="block_statement/expression_statement"><span class="marker" id="mapping-709"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-710"></span><span class="token add" data-title="call_expression/member_expression">targets[index].syncAttributeValue</span>(<span class="marker" id="mapping-711"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-712"></span><span class="token add" data-title="call_expression/call_argument">_attribute</span>, <span class="marker" id="mapping-713"></span><span class="token mv" id="move-dst-122" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        }</span></span>
    }

    // Returns true if the uint256 value stored for this attribute is non-zero
    function hasAttribute(address _who, bytes32 _attribute) public view returns (bool) {
        return attributes[_who][_attribute].value != 0;
    }


    // Returns the exact value of the attribute, as well as its metadata
    function getAttribute(address _who, bytes32 _attribute) public view returns (uint256, bytes32, address, uint256) {
        AttributeData memory data = attributes[_who][_attribute];
        return (data.value, data.notes, data.adminAddr, data.timestamp);
    }

    function getAttributeValue(address _who, bytes32 _attribute) public view returns (uint256) {
        return attributes[_who][_attribute].value;
    }

    function getAttributeAdminAddr(address _who, bytes32 _attribute) public view returns (address) {
        return attributes[_who][_attribute].adminAddr;
    }

    function getAttributeTimestamp(address _who, bytes32 _attribute) public view returns (uint256) {
        return attributes[_who][_attribute].timestamp;
    }

    <span class="marker" id="mapping-714"></span><span class="token add" data-title="contract_body/function_definition">function syncAttribute(<span class="marker" id="mapping-715"></span><span class="token mv" id="move-dst-27" data-title="function_definition/parameter">bytes32 _attribute</span>, <span class="marker" id="mapping-716"></span><span class="token add" data-title="function_definition/parameter">uint256 _startIndex</span>, <span class="marker" id="mapping-717"></span><span class="token mv" id="move-dst-18" data-title="function_definition/parameter"><span class="marker" id="mapping-718"></span><span class="token add" data-title="parameter/type_name"><span class="marker" id="mapping-719"></span><span class="token mv" id="move-dst-19" data-title="type_name/type_name">address</span>[]</span> <span class="marker" id="mapping-720"></span><span class="token upd" id="move-dst-20" data-title="parameter/identifier">_addresses</span></span>) <span class="marker" id="mapping-721"></span><span class="token add" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-722"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-723"></span><span class="token add" data-title="function_body/variable_declaration_statement">RegistryClone[] storage targets = subscribers[_attribute];</span>
        <span class="marker" id="mapping-724"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 index = targets.length;</span>
        <span class="marker" id="mapping-725"></span><span class="token add" data-title="function_body/while_statement">while (<span class="marker" id="mapping-726"></span><span class="token add" data-title="while_statement/binary_expression">index --&gt; _startIndex</span>) <span class="marker" id="mapping-727"></span><span class="token add" data-title="while_statement/block_statement">{
            <span class="marker" id="mapping-728"></span><span class="token add" data-title="block_statement/variable_declaration_statement">RegistryClone target = targets[index];</span>
            <span class="marker" id="mapping-729"></span><span class="token add" data-title="block_statement/for_statement">for (<span class="marker" id="mapping-730"></span><span class="token add" data-title="for_statement/variable_declaration_statement">uint256 i = _addresses.length;</span> <span class="marker" id="mapping-731"></span><span class="token add" data-title="for_statement/expression_statement">i --&gt; 0;</span> ) <span class="marker" id="mapping-732"></span><span class="token add" data-title="for_statement/block_statement">{
                <span class="marker" id="mapping-733"></span><span class="token add" data-title="block_statement/variable_declaration_statement"><span class="marker" id="mapping-734"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration"><span class="marker" id="mapping-735"></span><span class="token mv" id="move-dst-29" data-title="variable_declaration/type_name">address</span> who</span> = <span class="marker" id="mapping-736"></span><span class="token add" data-title="variable_declaration_statement/array_access">_addresses[i]</span>;</span>
                <span class="marker" id="mapping-737"></span><span class="token add" data-title="block_statement/expression_statement">target.syncAttributeValue(who, _attribute, attributes[who][_attribute].value);</span>
            }</span></span>
        }</span></span>
    }</span></span>

    function reclaimEther(address _to) external onlyOwner {
        _to.transfer(address(this).balance);
    }

    function reclaimToken(ERC20 token, address _to) external onlyOwner {
        uint256 balance = token.balanceOf(this);
        token.transfer(_to, balance);
    }

   /**
    * @dev Throws if called by any account other than the owner.
    */
    modifier onlyOwner() {
        require(msg.sender == owner, "only Owner");
        _;
    }

    /**
    * @dev Modifier throws if called by any account other than the pendingOwner.
    */
    modifier onlyPendingOwner() {
        require(msg.sender == pendingOwner);
        _;
    }

    /**
    * @dev Allows the current owner to set the pendingOwner address.
    * @param newOwner The address to transfer ownership to.
    */
    function transferOwnership(address newOwner) public onlyOwner {
        pendingOwner = newOwner;
    }

    /**
    * @dev Allows the pendingOwner address to finalize the transfer.
    */
    function claimOwnership() public onlyPendingOwner {
        emit OwnershipTransferred(owner, pendingOwner);
        owner = pendingOwner;
        pendingOwner = address(0);
    }
}

// File: openzeppelin-solidity/contracts/ownership/Ownable.sol

/**
 * @title Ownable
 * @dev The Ownable contract has an owner address, and provides basic authorization control
 * functions, this simplifies the implementation of "user permissions".
 */
contract Ownable {
  address public owner;


  event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);


  /**
   * @dev The Ownable constructor sets the original `owner` of the contract to the sender
   * account.
   */
  function Ownable() public {
    owner = msg.sender;
  }

  /**
   * @dev Throws if called by any account other than the owner.
   */
  modifier onlyOwner() {
    require(msg.sender == owner);
    _;
  }

  /**
   * @dev Allows the current owner to transfer control of the contract to a newOwner.
   * @param newOwner The address to transfer ownership to.
   */
  function transferOwnership(address newOwner) public onlyOwner {
    require(newOwner != address(0));
    emit OwnershipTransferred(owner, newOwner);
    owner = newOwner;
  }

}

// File: openzeppelin-solidity/contracts/ownership/Claimable.sol

/**
 * @title Claimable
 * @dev Extension for the Ownable contract, where the ownership needs to be claimed.
 * This allows the new owner to accept the transfer.
 */
contract Claimable is Ownable {
  address public pendingOwner;

  /**
   * @dev Modifier throws if called by any account other than the pendingOwner.
   */
  modifier onlyPendingOwner() {
    require(msg.sender == pendingOwner);
    _;
  }

  /**
   * @dev Allows the current owner to set the pendingOwner address.
   * @param newOwner The address to transfer ownership to.
   */
  function transferOwnership(address newOwner) onlyOwner public {
    pendingOwner = newOwner;
  }

  /**
   * @dev Allows the pendingOwner address to finalize the transfer.
   */
  function claimOwnership() onlyPendingOwner public {
    emit OwnershipTransferred(owner, pendingOwner);
    owner = pendingOwner;
    pendingOwner = address(0);
  }
}

// File: openzeppelin-solidity/contracts/math/SafeMath.sol

/**
 * @title SafeMath
 * @dev Math operations with safety checks that throw on error
 */
library SafeMath {

  /**
  * @dev Multiplies two numbers, throws on overflow.
  */
  function mul(uint256 a, uint256 b) internal pure returns (uint256 c) {
    if (a == 0) {
      return 0;
    }
    c = a * b;
    assert(c / a == b);
    return c;
  }

  /**
  * @dev Integer division of two numbers, truncating the quotient.
  */
  function div(uint256 a, uint256 b) internal pure returns (uint256) {
    // assert(b &gt; 0); // Solidity automatically throws when dividing by 0
    // uint256 c = a / b;
    // assert(a == b * c + a % b); // There is no case in which this doesn't hold
    return a / b;
  }

  /**
  * @dev Subtracts two numbers, throws on overflow (i.e. if subtrahend is greater than minuend).
  */
  function sub(uint256 a, uint256 b) internal pure returns (uint256) {
    assert(b &lt;= a);
    return a - b;
  }

  /**
  * @dev Adds two numbers, throws on overflow.
  */
  function add(uint256 a, uint256 b) internal pure returns (uint256 c) {
    c = a + b;
    assert(c &gt;= a);
    return c;
  }
}

// File: contracts/modularERC20/BalanceSheet.sol

// A wrapper around the balanceOf mapping.
contract BalanceSheet is Claimable {
    using SafeMath for uint256;

    mapping (address =&gt; uint256) public balanceOf;

    function addBalance(address _addr, uint256 _value) public onlyOwner {
        balanceOf[_addr] = balanceOf[_addr].add(_value);
    }

    function subBalance(address _addr, uint256 _value) public onlyOwner {
        balanceOf[_addr] = balanceOf[_addr].sub(_value);
    }

    function setBalance(address _addr, uint256 _value) public onlyOwner {
        balanceOf[_addr] = _value;
    }
}

// File: contracts/modularERC20/AllowanceSheet.sol

// A wrapper around the allowanceOf mapping.
contract AllowanceSheet is Claimable {
    using SafeMath for uint256;

    mapping (address =&gt; mapping (address =&gt; uint256)) public allowanceOf;

    function addAllowance(address _tokenHolder, address _spender, uint256 _value) public onlyOwner {
        allowanceOf[_tokenHolder][_spender] = allowanceOf[_tokenHolder][_spender].add(_value);
    }

    function subAllowance(address _tokenHolder, address _spender, uint256 _value) public onlyOwner {
        allowanceOf[_tokenHolder][_spender] = allowanceOf[_tokenHolder][_spender].sub(_value);
    }

    function setAllowance(address _tokenHolder, address _spender, uint256 _value) public onlyOwner {
        allowanceOf[_tokenHolder][_spender] = _value;
    }
}

// File: contracts/ProxyStorage.sol

<span class="marker" id="mapping-738"></span><span class="token mv" id="move-dst-61" data-title="source_file/comment"><span class="marker" id="mapping-739"></span><span class="token upd" id="move-dst-61" data-title="source_file/comment"><span class="cupd">/</span>*<span class="cupd"></span>
<span class="cupd">D</span>e<span class="cupd">f</span><span class="cupd">i</span>ne<span class="cupd">s</span> the s<span class="cupd">t</span>orage layout <span class="cupd">of</span> t<span class="cupd">h</span>e tok<span class="cupd">e</span>n i<span class="cupd">m</span>p<span class="cupd">l</span>ement<span class="cupd">a</span>it<span class="cupd">o</span><span class="cupd">n</span><span class="cupd"> </span><span class="cupd">c</span><span class="cupd">o</span>ntract<span class="cupd">.</span> Any n<span class="cupd">e</span>wly declared<span class="cupd"></span>
st<span class="cupd">at</span>e var<span class="cupd">i</span><span class="cupd">a</span>bles<span class="cupd"> </span>in fut<span class="cupd">u</span>re upgra<span class="cupd">de</span>s should b<span class="cupd">e a</span>p<span class="cupd">p</span>en<span class="cupd">e</span>d to<span class="cupd"> </span>t<span class="cupd">he</span> bottom.<span class="cupd"> </span>N<span class="cupd">e</span>v<span class="cupd">er </span>remove <span class="cupd">s</span>tate variables
from this list
 */</span></span>
contract ProxyStorage {
    address public owner;
    address public pendingOwner;

    bool initialized;
    
    BalanceSheet <span class="marker" id="mapping-740"></span><span class="token upd" id="move-dst-54" data-title="state_variable_declaration/identifier"><span class="cupd">balances</span>_Deprecated</span>;
    AllowanceSheet <span class="marker" id="mapping-741"></span><span class="token upd" id="move-dst-55" data-title="state_variable_declaration/identifier"><span class="cupd">allowances</span>_Deprecated</span>;

    uint256 totalSupply_;
    
    bool private paused_Deprecated = false;
    address private globalPause_Deprecated;

    uint256 public burnMin = 0;
    uint256 public burnMax = 0;

    Registry public registry;

    string <span class="marker" id="mapping-742"></span><span class="token upd" id="move-dst-56" data-title="state_variable_declaration/identifier"><span class="cupd">name</span>_Deprecated</span>;
    string <span class="marker" id="mapping-743"></span><span class="token upd" id="move-dst-57" data-title="state_variable_declaration/identifier"><span class="cupd">symbol</span>_Deprecated</span>;

    uint[] <span class="marker" id="mapping-744"></span><span class="token upd" id="move-dst-58" data-title="state_variable_declaration/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>;
    uint256 private redemptionAddressCount_Deprecated;
    uint256 public minimumGasPriceForFutureRefunds;

    <span class="marker" id="mapping-745"></span><span class="token add" data-title="contract_body/state_variable_declaration"><span class="marker" id="mapping-746"></span><span class="token add" data-title="state_variable_declaration/type_name">mapping (<span class="marker" id="mapping-747"></span><span class="token mv" id="move-dst-39" data-title="type_name/primitive_type">address</span> =&gt; <span class="marker" id="mapping-748"></span><span class="token add" data-title="type_name/type_name">uint256</span>)</span> _balanceOf;</span>
    <span class="marker" id="mapping-749"></span><span class="token add" data-title="contract_body/state_variable_declaration">mapping (address =&gt; mapping (address =&gt; uint256)) _allowance;</span>
    <span class="marker" id="mapping-750"></span><span class="token add" data-title="contract_body/state_variable_declaration">mapping (bytes32 =&gt; mapping (address =&gt; uint256)) attributes;</span>


    <span class="marker" id="mapping-751"></span><span class="token add" data-title="contract_body/comment">/* Additionally, we have several keccak-based storage locations.
     * If you add more keccak-based storage mappings, such as mappings, you must document them here.
     * If the length of the keccak input is the same as an existing mapping, it is possible there could be a preimage collision.
     * A preimage collision can be used to attack the contract by treating one storage location as another,
     * which would always be a critical issue.
     *************************************************************************
     ** length     input                              usage
     *************************************************************************
     ** 19         "trueXXX.proxy.owner"              Proxy Owner
     ** 20         address                            balanceOf
     ** 27         "trueXXX.pending.proxy.owner"      Pending Proxy Owner
     ** 28         "trueXXX.proxy.implementation"     Proxy Implementation
     ** 32         uint256(11)                        gasRefundPool_Deprecated
     ** 40         address,address                    allowance
     ** 52         address,bytes32                    Registry attributes
    **/</span>
}

// File: contracts/HasOwner.sol

/**
 * @title HasOwner
 * @dev The HasOwner contract is a copy of Claimable Contract by Zeppelin. 
 and provides basic authorization control functions. Inherits storage layout of 
 ProxyStorage.
 */
contract HasOwner is ProxyStorage {

    event OwnershipTransferred(
        address indexed previousOwner,
        address indexed newOwner
    );

    /**
    * @dev sets the original `owner` of the contract to the sender
    * at construction. Must then be reinitialized 
    */
    constructor() public {
        owner = msg.sender;
        emit OwnershipTransferred(address(0), owner);
    }

    /**
    * @dev Throws if called by any account other than the owner.
    */
    modifier onlyOwner() {
        require(msg.sender == owner, "only Owner");
        _;
    }

    /**
    * @dev Modifier throws if called by any account other than the pendingOwner.
    */
    modifier onlyPendingOwner() {
        require(msg.sender == pendingOwner);
        _;
    }

    /**
    * @dev Allows the current owner to set the pendingOwner address.
    * @param newOwner The address to transfer ownership to.
    */
    function transferOwnership(address newOwner) public onlyOwner {
        pendingOwner = newOwner;
    }

    /**
    * @dev Allows the pendingOwner address to finalize the transfer.
    */
    function claimOwnership() public onlyPendingOwner {
        emit OwnershipTransferred(owner, pendingOwner);
        owner = pendingOwner;
        pendingOwner = address(0);
    }
}

<span class="marker" id="mapping-752"></span><span class="token upd" id="move-dst-62" data-title="source_file/comment"><span class="cupd">// </span>F<span class="cupd">i</span><span class="cupd">l</span><span class="cupd">e</span>:<span class="cupd"> contract</span>s/R<span class="cupd">e</span>clai<span class="cupd">m</span>erT<span class="cupd">o</span>k<span class="cupd">e</span><span class="cupd">n</span>.s<span class="cupd">o</span>l</span>

<span class="marker" id="mapping-753"></span><span class="token mv" id="move-dst-292" data-title="source_file/contract_declaration">contract <span class="marker" id="mapping-754"></span><span class="token upd" id="move-dst-293" data-title="contract_declaration/identifier">Reclaimer<span class="cupd">T</span>oken</span> is <span class="marker" id="mapping-755"></span><span class="token upd" id="move-dst-294" data-title="user_defined_type/identifier">H<span class="cupd">a</span>sOw<span class="cupd">n</span>er</span> {
    <span class="marker" id="mapping-756"></span><span class="token upd" id="move-dst-310" data-title="contract_body/comment"><span class="cupd">/**  
    *@dev send all eth balance in the</span><span class="cupd"> contract to another address
    </span>*/</span>
    function reclaimEther(address _to) external onlyOwner {
        _to.transfer(address(this).balance);
    }

    <span class="marker" id="mapping-757"></span><span class="token upd" id="move-dst-311" data-title="contract_body/comment"><span class="cupd">/**  
    *@dev send all token balance of an arbitary erc20 token
    in th</span><span class="cupd">e contract to another address
   </span> */</span>
    function reclaimToken(ERC20 token, address _to) external onlyOwner {
        uint256 balance = token.balanceOf(this);
        token.transfer(_to, balance);
    }

    <span class="marker" id="mapping-758"></span><span class="token upd" id="move-dst-313" data-title="contract_body/comment"><span class="cupd">/**  
    *@dev allows owner of</span> t<span class="cupd">h</span><span class="cupd">e</span> co<span class="cupd">n</span>tract <span class="cupd">to gain ownership of any contract that</span> t<span class="cupd">h</span><span class="cupd">e </span>contract <span class="cupd">currently owns
    </span>*/</span>
    function reclaimContract(Ownable _ownable) external onlyOwner {
        _ownable.transferOwnership(owner);
    }

}</span>

<span class="marker" id="mapping-759"></span><span class="token mv" id="move-dst-59" data-title="source_file/comment">// File: contracts/modularERC20/ModularBasicToken.sol</span>

<span class="marker" id="mapping-760"></span><span class="token mv" id="move-dst-128" data-title="source_file/comment"><span class="marker" id="mapping-761"></span><span class="token upd" id="move-dst-128" data-title="source_file/comment"><span class="cupd">// F</span>ork<span class="cupd"> </span><span class="cupd">o</span>f Ope<span class="cupd">n</span>Zeppe<span class="cupd">l</span><span class="cupd">in</span>'s B<span class="cupd">a</span>sic<span class="cupd">Token</span></span></span>
/**
 * @title Basic token
 * @dev Basic version of StandardToken, with no allowances.
 */
contract ModularBasicToken is HasOwner {
    using SafeMath for uint256;

    event Transfer(address indexed from, address indexed to, uint256 value);

    /**
    * @dev total number of tokens in existence
    */
    function totalSupply() public view returns (uint256) {
        return totalSupply_;
    }

    <span class="marker" id="mapping-762"></span><span class="token add" data-title="contract_body/function_definition">function balanceOf(<span class="marker" id="mapping-763"></span><span class="token add" data-title="function_definition/parameter">address _who</span>) <span class="marker" id="mapping-764"></span><span class="token mv" id="move-dst-121" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-765"></span><span class="token mv" id="move-dst-13" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-766"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-767"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-768"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-769"></span><span class="token add" data-title="return_statement/call_expression">_getBalance(<span class="marker" id="mapping-770"></span><span class="token mv" id="move-dst-35" data-title="call_expression/call_argument">_who</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-771"></span><span class="token add" data-title="contract_body/function_definition">function _getBalance(<span class="marker" id="mapping-772"></span><span class="token add" data-title="function_definition/parameter">address _who</span>) <span class="marker" id="mapping-773"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-774"></span><span class="token mv" id="move-dst-87" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-775"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-776"></span><span class="token add" data-title="function_definition/function_body">{
        return _balanceOf[_who];
    }</span></span>

    <span class="marker" id="mapping-777"></span><span class="token add" data-title="contract_body/function_definition">function _addBalance(<span class="marker" id="mapping-778"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-779"></span><span class="token add" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-780"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-781"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256 priorBalance)</span> <span class="marker" id="mapping-782"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-783"></span><span class="token add" data-title="function_body/expression_statement">priorBalance = _balanceOf[_who];</span>
        <span class="marker" id="mapping-784"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-785"></span><span class="token add" data-title="expression_statement/assignment_expression"><span class="marker" id="mapping-786"></span><span class="token add" data-title="assignment_expression/array_access">_balanceOf[_who]</span> = <span class="marker" id="mapping-787"></span><span class="token add" data-title="assignment_expression/call_expression"><span class="marker" id="mapping-788"></span><span class="token add" data-title="call_expression/member_expression">priorBalance.add</span>(<span class="marker" id="mapping-789"></span><span class="token mv" id="move-dst-80" data-title="call_expression/call_argument">_value</span>)</span></span>;</span>
    }</span></span>

    <span class="marker" id="mapping-790"></span><span class="token add" data-title="contract_body/function_definition">function _subBalance(<span class="marker" id="mapping-791"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-792"></span><span class="token mv" id="move-dst-77" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-793"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-794"></span><span class="token mv" id="move-dst-88" data-title="function_definition/return_type_definition">returns (uint256 <span class="marker" id="mapping-795"></span><span class="token upd" id="move-dst-89" data-title="parameter/identifier">result</span>)</span> <span class="marker" id="mapping-796"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-797"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-798"></span><span class="token add" data-title="expression_statement/assignment_expression">result = <span class="marker" id="mapping-799"></span><span class="token add" data-title="assignment_expression/call_expression"><span class="marker" id="mapping-800"></span><span class="token add" data-title="call_expression/member_expression">_balanceOf[_who].sub</span>(<span class="marker" id="mapping-801"></span><span class="token mv" id="move-dst-110" data-title="call_expression/call_argument">_value</span>)</span></span>;</span>
        <span class="marker" id="mapping-802"></span><span class="token add" data-title="function_body/expression_statement">_balanceOf[_who] = result;</span>
    }</span></span>

    <span class="marker" id="mapping-803"></span><span class="token add" data-title="contract_body/function_definition">function _setBalance(<span class="marker" id="mapping-804"></span><span class="token mv" id="move-dst-36" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-805"></span><span class="token mv" id="move-dst-70" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-806"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-807"></span><span class="token add" data-title="function_definition/function_body">{
        _balanceOf[_who] = _value;
    }</span></span>
}

// File: contracts/modularERC20/ModularStandardToken.sol

/**
 * @title Standard ERC20 token
 *
 * @dev Implementation of the basic standard token.
 * @dev https://github.com/ethereum/EIPs/issues/20
 * @dev Based on code by FirstBlood: https://github.com/Firstbloodio/token/blob/master/smart_contract/FirstBloodToken.sol
 */
contract ModularStandardToken is ModularBasicToken {
    <span class="marker" id="mapping-808"></span><span class="token add" data-title="contract_body/using_directive">using SafeMath for uint256;</span>
    
    event Approval(address indexed owner, address indexed spender, uint256 value);
    
    /**
     * @dev Approve the passed address to spend the specified amount of tokens on behalf of msg.sender.
     *
     * Beware that changing an allowance with this method brings the risk that someone may use both the old
     * and the new allowance by unfortunate transaction ordering. One possible solution to mitigate this
     * race condition is to first reduce the spender's allowance to 0 and set the desired value afterwards:
     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729
     * @param _spender The address which will spend the funds.
     * @param _value The amount of tokens to be spent.
     */
    function approve(address _spender, uint256 _value) public returns (bool) {
        _approveAllArgs(_spender, _value, msg.sender);
        return true;
    }

    function _approveAllArgs(address _spender, uint256 _value, address _tokenHolder) internal {
        <span class="marker" id="mapping-809"></span><span class="token mv" id="move-dst-117" data-title="function_body/expression_statement"><span class="marker" id="mapping-810"></span><span class="token add" data-title="call_expression/identifier">_setAllowance</span>(_tokenHolder, _spender, <span class="marker" id="mapping-811"></span><span class="token mv" id="move-dst-124" data-title="call_expression/call_argument">_value</span>);</span>
        emit Approval(_tokenHolder, _spender, _value);
    }

    /**
     * @dev Increase the amount of tokens that an owner allowed to a spender.
     *
     * approve should be called when allowed[_spender] == 0. To increment
     * allowed value is better to use this function to avoid 2 calls (and wait until
     * the first transaction is mined)
     * From MonolithDAO Token.sol
     * @param _spender The address which will spend the funds.
     * @param _addedValue The amount of tokens to increase the allowance by.
     */
    function increaseApproval(address _spender, uint _addedValue) public returns (bool) {
        _increaseApprovalAllArgs(_spender, _addedValue, msg.sender);
        return true;
    }

    function _increaseApprovalAllArgs(address _spender, uint256 _addedValue, address _tokenHolder) internal {
        <span class="marker" id="mapping-812"></span><span class="token add" data-title="call_expression/identifier">_addAllowance</span>(_tokenHolder, _spender, _addedValue);
        emit Approval(<span class="marker" id="mapping-813"></span><span class="token mv" id="move-dst-118" data-title="emit_statement/call_argument">_tokenHolder</span>, <span class="marker" id="mapping-814"></span><span class="token mv" id="move-dst-119" data-title="emit_statement/call_argument">_spender</span>, <span class="marker" id="mapping-815"></span><span class="token add" data-title="call_expression/identifier">_getAllowance</span>(_tokenHolder, _spender));
    }

    /**
     * @dev Decrease the amount of tokens that an owner allowed to a spender.
     *
     * approve should be called when allowed[_spender] == 0. To decrement
     * allowed value is better to use this function to avoid 2 calls (and wait until
     * the first transaction is mined)
     * From MonolithDAO Token.sol
     * @param _spender The address which will spend the funds.
     * @param _subtractedValue The amount of tokens to decrease the allowance by.
     */
    function decreaseApproval(address _spender, uint _subtractedValue) public returns (bool) {
        _decreaseApprovalAllArgs(_spender, _subtractedValue, msg.sender);
        return true;
    }

    function _decreaseApprovalAllArgs(address _spender, uint256 _subtractedValue, address _tokenHolder) internal {
        uint256 oldValue = <span class="marker" id="mapping-816"></span><span class="token add" data-title="call_expression/identifier">_getAllowance</span>(_tokenHolder, _spender);
        <span class="marker" id="mapping-817"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 newValue;</span>
        if (_subtractedValue &gt; oldValue) <span class="marker" id="mapping-818"></span><span class="token add" data-title="if_statement/block_statement">{
            newValue = 0;
        }</span> else <span class="marker" id="mapping-819"></span><span class="token add" data-title="if_statement/block_statement">{
            newValue = oldValue - _subtractedValue;
        }</span>
        <span class="marker" id="mapping-820"></span><span class="token mv" id="move-dst-109" data-title="function_body/expression_statement"><span class="marker" id="mapping-821"></span><span class="token add" data-title="call_expression/identifier">_setAllowance</span>(_tokenHolder, _spender, <span class="marker" id="mapping-822"></span><span class="token add" data-title="call_expression/call_argument">newValue</span>);</span>
        emit Approval(<span class="marker" id="mapping-823"></span><span class="token mv" id="move-dst-114" data-title="emit_statement/call_argument">_tokenHolder</span>,<span class="marker" id="mapping-824"></span><span class="token mv" id="move-dst-115" data-title="emit_statement/call_argument">_spender</span>, <span class="marker" id="mapping-825"></span><span class="token add" data-title="call_argument/identifier">newValue</span>);
    }

    <span class="marker" id="mapping-826"></span><span class="token mv" id="move-dst-111" data-title="contract_body/function_definition">function allowance(<span class="marker" id="mapping-827"></span><span class="token add" data-title="parameter/type_name">address</span> <span class="marker" id="mapping-828"></span><span class="token upd" id="move-dst-113" data-title="parameter/identifier"><span class="cupd">_</span>who</span>, address _spender) public view returns (uint256) {
        return <span class="marker" id="mapping-829"></span><span class="token add" data-title="call_expression/identifier">_getAllowance</span>(<span class="marker" id="mapping-830"></span><span class="token mv" id="move-dst-41" data-title="call_expression/call_argument">_who</span>, _spender);
    }</span>

    <span class="marker" id="mapping-831"></span><span class="token add" data-title="contract_body/function_definition">function _getAllowance(<span class="marker" id="mapping-832"></span><span class="token mv" id="move-dst-32" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-833"></span><span class="token mv" id="move-dst-103" data-title="function_definition/parameter">address _spender</span>) <span class="marker" id="mapping-834"></span><span class="token mv" id="move-dst-104" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-835"></span><span class="token mv" id="move-dst-33" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-836"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256 value)</span> <span class="marker" id="mapping-837"></span><span class="token add" data-title="function_definition/function_body">{
        return _allowance[_who][_spender];
    }</span></span>

    <span class="marker" id="mapping-838"></span><span class="token add" data-title="contract_body/function_definition">function _addAllowance(<span class="marker" id="mapping-839"></span><span class="token mv" id="move-dst-16" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-840"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-841"></span><span class="token add" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-842"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-843"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-844"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-845"></span><span class="token add" data-title="expression_statement/assignment_expression"><span class="marker" id="mapping-846"></span><span class="token add" data-title="assignment_expression/array_access">_allowance[_who][_spender]</span> = <span class="marker" id="mapping-847"></span><span class="token add" data-title="assignment_expression/call_expression"><span class="marker" id="mapping-848"></span><span class="token add" data-title="call_expression/member_expression">_allowance[_who][_spender].add</span>(<span class="marker" id="mapping-849"></span><span class="token mv" id="move-dst-108" data-title="call_expression/call_argument">_value</span>)</span></span>;</span>
    }</span></span>

    <span class="marker" id="mapping-850"></span><span class="token add" data-title="contract_body/function_definition">function _subAllowance(<span class="marker" id="mapping-851"></span><span class="token mv" id="move-dst-14" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-852"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-853"></span><span class="token add" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-854"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-855"></span><span class="token add" data-title="function_definition/return_type_definition">returns (bool allowanceZero)</span><span class="marker" id="mapping-856"></span><span class="token add" data-title="function_definition/function_body">{
        uint256 newAllowance = _allowance[_who][_spender].sub(_value);
        _allowance[_who][_spender] = newAllowance;
        allowanceZero = newAllowance == 0;
    }</span></span>

    <span class="marker" id="mapping-857"></span><span class="token add" data-title="contract_body/function_definition">function _setAllowance(<span class="marker" id="mapping-858"></span><span class="token mv" id="move-dst-12" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-859"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-860"></span><span class="token mv" id="move-dst-156" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-861"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-862"></span><span class="token add" data-title="function_definition/function_body">{
        _allowance[_who][_spender] = _value;
    }</span></span>
}

// File: contracts/modularERC20/ModularBurnableToken.sol

/**
 * @title Burnable Token
 * @dev Token that can be irreversibly burned (destroyed).
 */
contract ModularBurnableToken is ModularStandardToken {
    event Burn(address indexed burner, uint256 value);
    <span class="marker" id="mapping-863"></span><span class="token mv" id="move-dst-132" data-title="contract_body/event_definition">event Mint(address indexed to, uint256 value);</span>
    <span class="marker" id="mapping-864"></span><span class="token add" data-title="contract_body/state_variable_declaration">uint256 constant CENT = 10 ** 16;</span>

    function burn(uint256 _value) <span class="marker" id="mapping-865"></span><span class="token add" data-title="function_definition/visibility">external</span> {
        _burnAllArgs(msg.sender, <span class="marker" id="mapping-866"></span><span class="token add" data-title="call_expression/call_argument">_value - _value % CENT</span>);
    }

    function _burnAllArgs(<span class="marker" id="mapping-867"></span><span class="token mv" id="move-dst-101" data-title="function_definition/parameter">address _from</span>, uint256 _value) internal {
        // no need to require value &lt;= totalSupply, since that would imply the
        // sender's balance is greater than the totalSupply, which *should* be an assertion failure
        <span class="marker" id="mapping-868"></span><span class="token add" data-title="call_expression/identifier">_subBalance</span>(<span class="marker" id="mapping-869"></span><span class="token mv" id="move-dst-106" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-870"></span><span class="token mv" id="move-dst-137" data-title="call_expression/call_argument">_value</span>);
        totalSupply_ = totalSupply_.sub(_value);
        <span class="marker" id="mapping-871"></span><span class="token add" data-title="function_body/emit_statement">emit Burn(<span class="marker" id="mapping-872"></span><span class="token add" data-title="emit_statement/call_argument">_from</span>, <span class="marker" id="mapping-873"></span><span class="token mv" id="move-dst-139" data-title="emit_statement/call_argument">_value</span>);</span>
        <span class="marker" id="mapping-874"></span><span class="token mv" id="move-dst-140" data-title="function_body/emit_statement">emit Transfer(<span class="marker" id="mapping-875"></span><span class="token add" data-title="emit_statement/call_argument">_from</span>, <span class="marker" id="mapping-876"></span><span class="token mv" id="move-dst-141" data-title="emit_statement/call_argument">address(0)</span>, _value);</span>
    }
}

// File: contracts/BurnableTokenWithBounds.sol

/**
 * @title Burnable Token WithBounds
 * @dev Burning functions as redeeming money from the system. The platform will keep track of who burns coins,
 * and will send them back the equivalent amount of money (rounded down to the nearest cent).
 */
contract BurnableTokenWithBounds is <span class="marker" id="mapping-877"></span><span class="token mv" id="move-dst-131" data-title="contract_declaration/inheritance_specifier">ModularBurnableToken</span> {

    event SetBurnBounds(uint256 newMin, uint256 newMax);

    function _burnAllArgs(address _burner, uint256 _value) internal {
        require(_value &gt;= burnMin, "below min burn bound");
        require(_value &lt;= burnMax, "exceeds max burn bound");
        super._burnAllArgs(_burner, _value);
    }

    //Change the minimum and maximum amount that can be burned at once. Burning
    //may be disabled by setting both to 0 (this will not be done under normal
    //operation, but we can't add checks to disallow it without losing a lot of
    //flexibility since burning could also be as good as disabled
    //by setting the minimum extremely high, and we don't want to lock
    //in any particular cap for the minimum)
    function setBurnBounds(uint256 _min, uint256 _max) <span class="marker" id="mapping-878"></span><span class="token add" data-title="function_definition/visibility">external</span> onlyOwner {
        require(_min &lt;= _max, "min &gt; max");
        burnMin = _min;
        burnMax = _max;
        emit SetBurnBounds(_min, _max);
    }
}

<span class="marker" id="mapping-879"></span><span class="token mv" id="move-dst-130" data-title="source_file/comment"><span class="marker" id="mapping-880"></span><span class="token upd" id="move-dst-130" data-title="source_file/comment"><span class="cupd">/</span>/<span class="cupd"> </span>F<span class="cupd">i</span><span class="cupd">le</span>:<span class="cupd"> </span>c<span class="cupd">o</span><span class="cupd">n</span><span class="cupd">t</span><span class="cupd">r</span><span class="cupd">a</span><span class="cupd">c</span><span class="cupd">t</span><span class="cupd">s</span><span class="cupd">/</span>G<span class="cupd">as</span>R<span class="cupd">e</span>fu<span class="cupd">n</span><span class="cupd">d</span><span class="cupd">Token</span><span class="cupd">.</span><span class="cupd">s</span><span class="cupd">o</span>l</span></span>

<span class="marker" id="mapping-881"></span><span class="token upd" id="move-dst-144" data-title="source_file/comment"><span class="cupd">/</span>**<span class="cupd"> </span> 
@<span class="cupd">t</span>i<span class="cupd">tl</span><span class="cupd">e</span> Gas Refund <span class="cupd">T</span>ok<span class="cupd">e</span>n
Allow any use<span class="cupd">r</span> to spon<span class="cupd">s</span>or<span class="cupd"> </span>gas refunds for transfer and mints. Utilitzes the gas refund <span class="cupd">m</span>echanism in EVM
Ea<span class="cupd">c</span>h time a<span class="cupd">n</span> no<span class="cupd">n-</span>empty storag<span class="cupd">e</span> sl<span class="cupd">o</span>t is set to 0, evm r<span class="cupd">e</span>fund 15,0<span class="cupd">0</span><span class="cupd">0</span> to<span class="cupd"> </span>the<span class="cupd"> </span>sender
of the <span class="cupd">t</span>ransaction.
*/</span>
<span class="marker" id="mapping-882"></span><span class="token add" data-title="source_file/contract_declaration">contract GasRefundToken is <span class="marker" id="mapping-883"></span><span class="token add" data-title="contract_declaration/inheritance_specifier">ProxyStorage</span> <span class="marker" id="mapping-884"></span><span class="token add" data-title="contract_declaration/contract_body">{

    /**
      A buffer of "Sheep" runs from 0xffff...fffe down
      They suicide when you call them, if you are their parent
    */

    <span class="marker" id="mapping-885"></span><span class="token add" data-title="contract_body/function_definition">function sponsorGas2() external {
        /**
        Deploy (9 bytes)
          PC Assembly       Opcodes                                       Stack
          00 PUSH1(31)      60 1f                                         1f
          02 DUP1           80                                            1f 1f
          03 PUSH1(9)       60 09                                         1f 1f 09
          05 RETURNDATASIZE 3d                                            1f 1f 09 00
          06 CODECOPY       39                                            1f
          07 RETURNDATASIZE 3d                                            1f 00
          08 RETURN         f3
        Sheep (31 bytes = 3 + 20 + 8)
          PC Assembly       Opcodes                                       Stack
          00 RETURNDATASIZE 3d                                            0
          01 CALLER         33                                            0 caller
          02 PUSH20(me)     73 memememememememememememememememememememe   0 caller me
          17 EQ             14                                            0 valid
          18 PUSH1(1d)      60 1d                                         0 valid 1d
          1a JUMPI          57                                            0
          1b DUP1           80                                            0 0
          1c REVERT         fd
          1d JUMPDEST       5b                                            0
          1e SELFDESTRUCT   ff
        */
        assembly {
            mstore(0, or(0x601f8060093d393df33d33730000000000000000000000000000000000000000, address))
            mstore(32,   0x14601d5780fd5bff000000000000000000000000000000000000000000000000)
            let sheep := create(0, 0, 0x28)
            let offset := sload(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff)
            let location := sub(0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffe, offset)
            sstore(location, sheep)
            sheep := create(0, 0, 0x28)
            sstore(sub(location, 1), sheep)
            sheep := create(0, 0, 0x28)
            sstore(sub(location, 2), sheep)
            sstore(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, add(offset, 3))
        }
    }</span>

    /**
    @dev refund 39,000 gas
    @dev costs slightly more than 16,100 gas
    */
    <span class="marker" id="mapping-886"></span><span class="token add" data-title="contract_body/function_definition">function gasRefund39() internal {
        assembly {
            let offset := sload(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff)
            if gt(offset, 0) {
              let location := sub(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff,offset)
              sstore(0xffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff, sub(offset, 1))
              let sheep := sload(location)
              pop(call(gas, sheep, 0, 0, 0, 0, 0))
              sstore(location, 0)
            }
        }
    }</span>

    <span class="marker" id="mapping-887"></span><span class="token add" data-title="contract_body/function_definition">function sponsorGas() external {
        uint256 refundPrice = minimumGasPriceForFutureRefunds;
        require(refundPrice &gt; 0);
        assembly {
            let offset := sload(0xfffff)
            let result := add(offset, 9)
            sstore(0xfffff, result)
            let position := add(offset, 0x100000)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
            position := add(position, 1)
            sstore(position, refundPrice)
        }
    }</span>

    <span class="marker" id="mapping-888"></span><span class="token add" data-title="contract_body/function_definition">function minimumGasPriceForRefund() <span class="marker" id="mapping-889"></span><span class="token mv" id="move-dst-143" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-890"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-891"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256 result)</span> <span class="marker" id="mapping-892"></span><span class="token add" data-title="function_definition/function_body">{
        assembly {
            let offset := sload(0xfffff)
            let location := add(offset, 0xfffff)
            result := add(sload(location), 1)
        }
    }</span></span>

    /**  
    @dev refund 30,000 gas
    @dev costs slightly more than 15,400 gas
    */
    <span class="marker" id="mapping-893"></span><span class="token add" data-title="contract_body/function_definition">function gasRefund30() internal {
        assembly {
            let offset := sload(0xfffff)
            if gt(offset, 1) {
                let location := add(offset, 0xfffff)
                if gt(gasprice,sload(location)) {
                    sstore(location, 0)
                    location := sub(location, 1)
                    sstore(location, 0)
                    sstore(0xfffff, sub(offset, 2))
                }
            }
        }
    }</span>

    /**  
    @dev refund 15,000 gas
    @dev costs slightly more than 10,200 gas
    */
    <span class="marker" id="mapping-894"></span><span class="token add" data-title="contract_body/function_definition">function gasRefund15() internal {
        assembly {
            let offset := sload(0xfffff)
            if gt(offset, 1) {
                let location := add(offset, 0xfffff)
                if gt(gasprice,sload(location)) {
                    sstore(location, 0)
                    sstore(0xfffff, sub(offset, 1))
                }
            }
        }
    }</span>

    /**  
    *@dev Return the remaining sponsored gas slots
    */
    <span class="marker" id="mapping-895"></span><span class="token mv" id="move-dst-259" data-title="contract_body/function_definition">function <span class="marker" id="mapping-896"></span><span class="token upd" id="move-dst-260" data-title="function_definition/identifier"><span class="cupd">remaining</span>Ga<span class="cupd">s</span>R<span class="cupd">e</span>fun<span class="cupd">d</span>Pool</span>() public view returns (uint <span class="marker" id="mapping-897"></span><span class="token add" data-title="parameter/identifier">length</span>) {
        <span class="marker" id="mapping-898"></span><span class="token add" data-title="function_body/assembly_statement">assembly {
            length := sload(0xfffff)
        }</span>
    }</span>

    <span class="marker" id="mapping-899"></span><span class="token add" data-title="contract_body/function_definition">function gasRefundPool(<span class="marker" id="mapping-900"></span><span class="token add" data-title="function_definition/parameter">uint256 _index</span>) <span class="marker" id="mapping-901"></span><span class="token mv" id="move-dst-135" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-902"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-903"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256 gasPrice)</span> <span class="marker" id="mapping-904"></span><span class="token add" data-title="function_definition/function_body">{
        assembly {
            gasPrice := sload(add(0x100000, _index))
        }
    }</span></span>

    <span class="marker" id="mapping-905"></span><span class="token mv" id="move-dst-149" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-906"></span><span class="token upd" id="move-dst-150" data-title="state_variable_declaration/identifier">CAN_SET_FUTURE_REFUND_M<span class="cupd">I</span>N_GA<span class="cupd">S_</span>PRI<span class="cupd">C</span>E</span> = "canSetFutureRefundMinGasPrice";</span>

    <span class="marker" id="mapping-907"></span><span class="token mv" id="move-dst-288" data-title="contract_body/function_definition">function setMinimumGasPriceForFutureRefunds(uint256 _minimumGasPriceForFutureRefunds) public {
        require(registry.hasAttribute(msg.sender, CAN_SET_FUTURE_REFUND_MIN_GAS_PRICE));
        minimumGasPriceForFutureRefunds = _minimumGasPriceForFutureRefunds;
    }</span>
}</span></span>

// File: contracts/CompliantDepositTokenWithHook.sol

contract CompliantDepositTokenWithHook is <span class="marker" id="mapping-908"></span><span class="token upd" id="move-dst-176" data-title="user_defined_type/identifier">Rec<span class="cupd">l</span>a<span class="cupd">i</span>mer<span class="cupd">Token</span></span>, <span class="marker" id="mapping-909"></span><span class="token upd" id="move-dst-177" data-title="user_defined_type/identifier">R<span class="cupd">e</span>gi<span class="cupd">s</span><span class="cupd">t</span>ryCl<span class="cupd">o</span>ne</span>, <span class="marker" id="mapping-910"></span><span class="token mv" id="move-dst-296" data-title="contract_declaration/inheritance_specifier">BurnableTokenWithBounds</span><span class="marker" id="mapping-911"></span><span class="token add" data-title="contract_declaration/,">,</span> <span class="marker" id="mapping-912"></span><span class="token mv" id="move-dst-298" data-title="contract_declaration/inheritance_specifier">GasRefundToken</span> {

    <span class="marker" id="mapping-913"></span><span class="token mv" id="move-dst-165" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-914"></span><span class="token upd" id="move-dst-166" data-title="state_variable_declaration/identifier"><span class="cupd">IS_</span>R<span class="cupd">E</span>GI<span class="cupd">S</span><span class="cupd">T</span>ERED<span class="cupd">_</span>CONTRACT</span> = "isRegisteredContract";</span>
    <span class="marker" id="mapping-915"></span><span class="token mv" id="move-dst-147" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-916"></span><span class="token upd" id="move-dst-148" data-title="state_variable_declaration/identifier">IS_DEPOSIT_<span class="cupd">A</span>DDRESS</span> = "isDepositAddress";</span>
    <span class="marker" id="mapping-917"></span><span class="token mv" id="move-dst-200" data-title="contract_body/state_variable_declaration">uint256 constant REDEMPTION_ADDRESS_COUNT = 0x100000;</span>
    <span class="marker" id="mapping-918"></span><span class="token mv" id="move-dst-145" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-919"></span><span class="token upd" id="move-dst-146" data-title="state_variable_declaration/identifier">I<span class="cupd">S_</span>BL<span class="cupd">A</span>CKLI<span class="cupd">S</span>T<span class="cupd">ED</span></span> = "isBlacklisted";</span>

    <span class="marker" id="mapping-920"></span><span class="token mv" id="move-dst-9" data-title="contract_body/function_definition">function <span class="marker" id="mapping-921"></span><span class="token upd" id="move-dst-10" data-title="function_definition/identifier">canB<span class="cupd">u</span>rn</span>() <span class="marker" id="mapping-922"></span><span class="token add" data-title="visibility/internal">internal</span> pure returns (bytes32);</span>

    <span class="marker" id="mapping-923"></span><span class="token add" data-title="contract_body/comment">/**
    * @dev transfer token for a specified address
    * @param _to The address to transfer to.
    * @param _value The amount to be transferred.
    */</span>
    <span class="marker" id="mapping-924"></span><span class="token mv" id="move-dst-99" data-title="contract_body/function_definition">function <span class="marker" id="mapping-925"></span><span class="token upd" id="move-dst-100" data-title="function_definition/identifier"><span class="cupd">transfer</span></span>(address _to<span class="marker" id="mapping-926"></span><span class="token mv" id="move-dst-102" data-title="function_definition/,">,</span> uint256 _value) <span class="marker" id="mapping-927"></span><span class="token mv" id="move-dst-93" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-928"></span><span class="token mv" id="move-dst-95" data-title="function_definition/return_type_definition">returns (bool)</span> {
        <span class="marker" id="mapping-929"></span><span class="token add" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-930"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration"><span class="marker" id="mapping-931"></span><span class="token mv" id="move-dst-123" data-title="variable_declaration/type_name">address</span> _from</span> = <span class="marker" id="mapping-932"></span><span class="token mv" id="move-dst-8" data-title="variable_declaration_statement/member_expression">msg.sender</span>;</span>
        <span class="marker" id="mapping-933"></span><span class="token mv" id="move-dst-207" data-title="function_body/if_statement">if (<span class="marker" id="mapping-934"></span><span class="token mv" id="move-dst-251" data-title="type_cast_expression/primitive_type">uint256</span>(_to) &lt; REDEMPTION_ADDRESS_COUNT) {
            <span class="marker" id="mapping-935"></span><span class="token add" data-title="block_statement/expression_statement">_value -= _value % CENT;</span>
            <span class="marker" id="mapping-936"></span><span class="token add" data-title="call_expression/identifier">_burnFromAllArgs</span>(_from, _to, _value);
        } else {
            <span class="marker" id="mapping-937"></span><span class="token mv" id="move-dst-105" data-title="block_statement/expression_statement">_transferAllArgs(_from, _to, _value);</span>
        }</span>
        <span class="marker" id="mapping-938"></span><span class="token mv" id="move-dst-96" data-title="function_body/return_statement">return true;</span>
    }</span>

    <span class="marker" id="mapping-939"></span><span class="token add" data-title="contract_body/comment">/**
     * @dev Transfer tokens from one address to another
     * @param _from address The address which you want to send tokens from
     * @param _to address The address which you want to transfer to
     * @param _value uint256 the amount of tokens to be transferred
     */</span>
    <span class="marker" id="mapping-940"></span><span class="token mv" id="move-dst-97" data-title="contract_body/function_definition">function transferFrom(address _from, address _to, uint256 _value) public returns (bool) {
        <span class="marker" id="mapping-941"></span><span class="token mv" id="move-dst-219" data-title="function_body/if_statement">if (<span class="marker" id="mapping-942"></span><span class="token mv" id="move-dst-40" data-title="if_statement/binary_expression">uint256(<span class="marker" id="mapping-943"></span><span class="token mv" id="move-dst-220" data-title="type_cast_expression/call_argument">_to</span>) <span class="marker" id="mapping-944"></span><span class="token add" data-title="binary_expression/<">&lt;</span> <span class="marker" id="mapping-945"></span><span class="token add" data-title="binary_expression/identifier">REDEMPTION_ADDRESS_COUNT</span></span>) {
            <span class="marker" id="mapping-946"></span><span class="token add" data-title="expression_statement/augmented_assignment_expression">_value -= _value % CENT</span>;
            <span class="marker" id="mapping-947"></span><span class="token mv" id="move-dst-221" data-title="block_statement/expression_statement"><span class="marker" id="mapping-948"></span><span class="token add" data-title="call_expression/identifier">_burnFromAllowanceAllArgs</span>(_from, _to, _value);</span>
        } else {
            <span class="marker" id="mapping-949"></span><span class="token mv" id="move-dst-98" data-title="block_statement/expression_statement">_transferFromAllArgs(_from, _to, _value, msg.sender);</span>
        }</span>
        return true;
    }</span>

    <span class="marker" id="mapping-950"></span><span class="token add" data-title="contract_body/function_definition">function _burnFromAllowanceAllArgs(<span class="marker" id="mapping-951"></span><span class="token add" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-952"></span><span class="token mv" id="move-dst-133" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-953"></span><span class="token mv" id="move-dst-134" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-954"></span><span class="token mv" id="move-dst-78" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-955"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-956"></span><span class="token mv" id="move-dst-71" data-title="function_body/expression_statement"><span class="marker" id="mapping-957"></span><span class="token upd" id="move-dst-72" data-title="call_expression/identifier"><span class="cupd">_</span><span class="cupd">r</span>equireC<span class="cupd">an</span>Tran<span class="cupd">sfer</span>From</span>(msg.sender, <span class="marker" id="mapping-958"></span><span class="token mv" id="move-dst-185" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-959"></span><span class="token mv" id="move-dst-73" data-title="call_expression/call_argument">_to</span>);</span>
        <span class="marker" id="mapping-960"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-961"></span><span class="token add" data-title="expression_statement/call_expression">_requireOnlyCanBurn(<span class="marker" id="mapping-962"></span><span class="token mv" id="move-dst-195" data-title="call_expression/call_argument">_to</span>)</span>;</span>
        <span class="marker" id="mapping-963"></span><span class="token add" data-title="function_body/expression_statement">require(_value &gt;= burnMin, "below min burn bound");</span>
        <span class="marker" id="mapping-964"></span><span class="token add" data-title="function_body/expression_statement">require(_value &lt;= burnMax, "exceeds max burn bound");</span>
        <span class="marker" id="mapping-965"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-966"></span><span class="token add" data-title="if_statement/binary_expression">0 == _subBalance(_from, _value)</span>) <span class="marker" id="mapping-967"></span><span class="token add" data-title="if_statement/block_statement">{
            if (_subAllowance(_from, msg.sender, _value)) {
                // no refund
            } else {
                gasRefund15();
            }
        }</span> else <span class="marker" id="mapping-968"></span><span class="token add" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-969"></span><span class="token add" data-title="block_statement/if_statement">if (<span class="marker" id="mapping-970"></span><span class="token add" data-title="if_statement/call_expression">_subAllowance(<span class="marker" id="mapping-971"></span><span class="token mv" id="move-dst-224" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-972"></span><span class="token add" data-title="call_expression/call_argument">msg.sender</span>, <span class="marker" id="mapping-973"></span><span class="token add" data-title="call_expression/call_argument">_value</span>)</span>) <span class="marker" id="mapping-974"></span><span class="token add" data-title="if_statement/block_statement">{
                gasRefund15();
            }</span> else <span class="marker" id="mapping-975"></span><span class="token add" data-title="if_statement/block_statement">{
                gasRefund39();
            }</span></span>
        }</span></span>
        <span class="marker" id="mapping-976"></span><span class="token mv" id="move-dst-82" data-title="function_body/emit_statement">emit Transfer(_from, _to, _value);</span>
        <span class="marker" id="mapping-977"></span><span class="token add" data-title="function_body/expression_statement">totalSupply_ = totalSupply_.sub(_value);</span>
        <span class="marker" id="mapping-978"></span><span class="token add" data-title="function_body/emit_statement">emit Burn(<span class="marker" id="mapping-979"></span><span class="token mv" id="move-dst-142" data-title="emit_statement/call_argument">_to</span>, <span class="marker" id="mapping-980"></span><span class="token mv" id="move-dst-125" data-title="emit_statement/call_argument">_value</span>);</span>
        <span class="marker" id="mapping-981"></span><span class="token mv" id="move-dst-126" data-title="function_body/emit_statement">emit Transfer(<span class="marker" id="mapping-982"></span><span class="token mv" id="move-dst-138" data-title="emit_statement/call_argument">_to</span>, address(0), _value);</span>
    }</span></span>

    <span class="marker" id="mapping-983"></span><span class="token add" data-title="contract_body/function_definition">function _burnFromAllArgs(<span class="marker" id="mapping-984"></span><span class="token mv" id="move-dst-271" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-985"></span><span class="token mv" id="move-dst-272" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-986"></span><span class="token mv" id="move-dst-273" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-987"></span><span class="token mv" id="move-dst-274" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-988"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-989"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-990"></span><span class="token add" data-title="expression_statement/call_expression">_requireCanTransfer(<span class="marker" id="mapping-991"></span><span class="token mv" id="move-dst-187" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-992"></span><span class="token mv" id="move-dst-189" data-title="call_expression/call_argument">_to</span>)</span>;</span>
        <span class="marker" id="mapping-993"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-994"></span><span class="token add" data-title="expression_statement/call_expression">_requireOnlyCanBurn(<span class="marker" id="mapping-995"></span><span class="token mv" id="move-dst-198" data-title="call_expression/call_argument">_to</span>)</span>;</span>
        <span class="marker" id="mapping-996"></span><span class="token add" data-title="function_body/expression_statement">require(_value &gt;= burnMin, "below min burn bound");</span>
        <span class="marker" id="mapping-997"></span><span class="token add" data-title="function_body/expression_statement">require(_value &lt;= burnMax, "exceeds max burn bound");</span>
        <span class="marker" id="mapping-998"></span><span class="token add" data-title="function_body/if_statement">if (0 == _subBalance(_from, _value)) {
            gasRefund15();
        } else {
            gasRefund30();
        }</span>
        <span class="marker" id="mapping-999"></span><span class="token add" data-title="function_body/emit_statement">emit Transfer(_from, _to, _value);</span>
        <span class="marker" id="mapping-1000"></span><span class="token add" data-title="function_body/expression_statement">totalSupply_ = totalSupply_.sub(_value);</span>
        <span class="marker" id="mapping-1001"></span><span class="token add" data-title="function_body/emit_statement">emit Burn(<span class="marker" id="mapping-1002"></span><span class="token mv" id="move-dst-225" data-title="emit_statement/call_argument">_to</span>, <span class="marker" id="mapping-1003"></span><span class="token mv" id="move-dst-226" data-title="emit_statement/call_argument">_value</span>);</span>
        <span class="marker" id="mapping-1004"></span><span class="token mv" id="move-dst-49" data-title="function_body/emit_statement">emit <span class="marker" id="mapping-1005"></span><span class="token upd" id="move-dst-50" data-title="emit_statement/identifier"><span class="cupd">Transfer</span></span>(<span class="marker" id="mapping-1006"></span><span class="token mv" id="move-dst-210" data-title="emit_statement/call_argument">_to</span>, <span class="marker" id="mapping-1007"></span><span class="token mv" id="move-dst-51" data-title="emit_statement/call_argument">address(0)</span><span class="marker" id="mapping-1008"></span><span class="token add" data-title="emit_statement/,">,</span> <span class="marker" id="mapping-1009"></span><span class="token mv" id="move-dst-211" data-title="emit_statement/call_argument">_value</span>);</span>
    }</span></span>

    function <span class="marker" id="mapping-1010"></span><span class="token upd" id="move-dst-191" data-title="function_definition/identifier"><span class="cupd">_transfer</span>From<span class="cupd">AllArgs</span></span>(address _from, address _to, uint256 _value<span class="marker" id="mapping-1011"></span><span class="token add" data-title="function_definition/,">,</span> <span class="marker" id="mapping-1012"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>) internal {
        bool hasHook;
        address originalTo = _to;
        (_to, hasHook) = <span class="marker" id="mapping-1013"></span><span class="token add" data-title="call_expression/identifier">_requireCanTransferFrom</span>(<span class="marker" id="mapping-1014"></span><span class="token add" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-1015"></span><span class="token mv" id="move-dst-192" data-title="call_expression/call_argument">_from</span><span class="marker" id="mapping-1016"></span><span class="token add" data-title="call_expression/,">,</span> _to);
        <span class="marker" id="mapping-1017"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-1018"></span><span class="token add" data-title="if_statement/binary_expression">0 == <span class="marker" id="mapping-1019"></span><span class="token mv" id="move-dst-81" data-title="binary_expression/call_expression"><span class="marker" id="mapping-1020"></span><span class="token add" data-title="call_expression/identifier">_addBalance</span>(_to, _value)</span></span>) <span class="marker" id="mapping-1021"></span><span class="token add" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-1022"></span><span class="token add" data-title="block_statement/if_statement">if (<span class="marker" id="mapping-1023"></span><span class="token add" data-title="if_statement/call_expression">_subAllowance(<span class="marker" id="mapping-1024"></span><span class="token add" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-1025"></span><span class="token mv" id="move-dst-116" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-1026"></span><span class="token add" data-title="call_expression/call_argument">_value</span>)</span>) <span class="marker" id="mapping-1027"></span><span class="token add" data-title="if_statement/block_statement">{
                if (0 == _subBalance(_from, _value)) {
                    // do not refund
                } else {
                    gasRefund30();
                }
            }</span> else <span class="marker" id="mapping-1028"></span><span class="token add" data-title="if_statement/block_statement">{
                if (0 == _subBalance(_from, _value)) {
                    gasRefund30();
                } else {
                    gasRefund39();
                }
            }</span></span>
        }</span> else <span class="marker" id="mapping-1029"></span><span class="token add" data-title="if_statement/block_statement">{
            if (_subAllowance(_from, _spender, _value)) {
                if (0 == _subBalance(_from, _value)) {
                    // do not refund
                } else {
                    gasRefund15();
                }
            } else {
                if (0 == _subBalance(_from, _value)) {
                    gasRefund15();
                } else {
                    gasRefund39();
                }
            }

        }</span></span>
        emit Transfer(_from, originalTo, _value);
        if (originalTo != _to) {
            emit Transfer(originalTo, _to, _value);
            if (hasHook) {
                TrueCoinReceiver(_to).tokenFallback(originalTo, _value);
            }
        } else {
            if (hasHook) {
                TrueCoinReceiver(_to).tokenFallback(_from, _value);
            }
        }
    }

    <span class="marker" id="mapping-1030"></span><span class="token add" data-title="contract_body/function_definition">function _transferAllArgs(<span class="marker" id="mapping-1031"></span><span class="token mv" id="move-dst-178" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-1032"></span><span class="token mv" id="move-dst-179" data-title="function_definition/parameter">address _to</span>, <span class="marker" id="mapping-1033"></span><span class="token mv" id="move-dst-180" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1034"></span><span class="token mv" id="move-dst-181" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1035"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1036"></span><span class="token mv" id="move-dst-182" data-title="function_body/variable_declaration_statement">bool hasHook;</span>
        <span class="marker" id="mapping-1037"></span><span class="token add" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-1038"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration"><span class="marker" id="mapping-1039"></span><span class="token mv" id="move-dst-112" data-title="variable_declaration/type_name">address</span> finalTo</span>;</span>
        <span class="marker" id="mapping-1040"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1041"></span><span class="token add" data-title="expression_statement/assignment_expression"><span class="marker" id="mapping-1042"></span><span class="token add" data-title="assignment_expression/tuple_expression">(finalTo, hasHook)</span> = <span class="marker" id="mapping-1043"></span><span class="token add" data-title="assignment_expression/call_expression">_requireCanTransfer(<span class="marker" id="mapping-1044"></span><span class="token mv" id="move-dst-184" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-1045"></span><span class="token mv" id="move-dst-197" data-title="call_expression/call_argument">_to</span>)</span></span>;</span>
        <span class="marker" id="mapping-1046"></span><span class="token add" data-title="function_body/if_statement">if (0 == _subBalance(_from, _value)) {
            if (0 == _addBalance(finalTo, _value)) {
                gasRefund30();
            } else {
                // do not refund
            }
        } else {
            if (0 == _addBalance(finalTo, _value)) {
                gasRefund39();
            } else {
                gasRefund30();
            }
        }</span>
        <span class="marker" id="mapping-1047"></span><span class="token add" data-title="function_body/emit_statement">emit Transfer(_from, _to, _value);</span>
        <span class="marker" id="mapping-1048"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-1049"></span><span class="token add" data-title="if_statement/binary_expression">finalTo != _to</span>) <span class="marker" id="mapping-1050"></span><span class="token add" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-1051"></span><span class="token add" data-title="block_statement/emit_statement">emit Transfer(<span class="marker" id="mapping-1052"></span><span class="token mv" id="move-dst-222" data-title="emit_statement/call_argument">_to</span>, <span class="marker" id="mapping-1053"></span><span class="token add" data-title="emit_statement/call_argument">finalTo</span>, <span class="marker" id="mapping-1054"></span><span class="token mv" id="move-dst-223" data-title="emit_statement/call_argument">_value</span>);</span>
            <span class="marker" id="mapping-1055"></span><span class="token add" data-title="block_statement/if_statement">if (hasHook) <span class="marker" id="mapping-1056"></span><span class="token add" data-title="if_statement/block_statement">{
                <span class="marker" id="mapping-1057"></span><span class="token mv" id="move-dst-208" data-title="block_statement/expression_statement"><span class="marker" id="mapping-1058"></span><span class="token add" data-title="call_expression/member_expression">TrueCoinReceiver(finalTo).tokenFallback</span>(_to, _value);</span>
            }</span></span>
        }</span> else <span class="marker" id="mapping-1059"></span><span class="token add" data-title="if_statement/block_statement">{
            <span class="marker" id="mapping-1060"></span><span class="token add" data-title="block_statement/if_statement">if (hasHook) <span class="marker" id="mapping-1061"></span><span class="token add" data-title="if_statement/block_statement">{
                <span class="marker" id="mapping-1062"></span><span class="token add" data-title="block_statement/expression_statement"><span class="marker" id="mapping-1063"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-1064"></span><span class="token add" data-title="call_expression/member_expression">TrueCoinReceiver(finalTo).tokenFallback</span>(<span class="marker" id="mapping-1065"></span><span class="token mv" id="move-dst-209" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-1066"></span><span class="token add" data-title="call_expression/call_argument">_value</span>)</span>;</span>
            }</span></span>
        }</span></span>
    }</span></span>

    function mint(address _to, uint256 _value) public onlyOwner {
        require(_to != address(0), "to address cannot be zero");
        bool hasHook;
        address originalTo = _to;
        <span class="marker" id="mapping-1067"></span><span class="token mv" id="move-dst-183" data-title="function_body/expression_statement">(_to, hasHook) = <span class="marker" id="mapping-1068"></span><span class="token add" data-title="call_expression/identifier">_requireCanMint</span>(_to);</span>
        totalSupply_ = totalSupply_.add(_value);
        emit Mint(originalTo, _value);
        emit Transfer(address(0), originalTo, _value);
        if (_to != originalTo) {
            emit Transfer(originalTo, _to, _value);
        }
        <span class="marker" id="mapping-1069"></span><span class="token mv" id="move-dst-285" data-title="function_body/expression_statement"><span class="marker" id="mapping-1070"></span><span class="token add" data-title="call_expression/identifier">_addBalance</span>(_to, _value);</span>
        if (hasHook) {
            if (_to != originalTo) {
                TrueCoinReceiver(_to).tokenFallback(originalTo, _value);
            } else {
                TrueCoinReceiver(_to).tokenFallback(address(0), _value);
            }
        }
    }

    <span class="marker" id="mapping-1071"></span><span class="token mv" id="move-dst-151" data-title="contract_body/event_definition">event WipeBlacklistedAccount(address indexed account, uint256 balance);</span>
    <span class="marker" id="mapping-1072"></span><span class="token mv" id="move-dst-152" data-title="contract_body/event_definition">event SetRegistry(address indexed registry);</span>

    <span class="marker" id="mapping-1073"></span><span class="token add" data-title="contract_body/comment">/**
    * @dev Point to the registry that contains all compliance related data
    @param _registry The address of the registry instance
    */</span>
    <span class="marker" id="mapping-1074"></span><span class="token mv" id="move-dst-153" data-title="contract_body/function_definition">function setRegistry(Registry _registry) public onlyOwner {
        registry = _registry;
        emit SetRegistry(registry);
    }</span>

    <span class="marker" id="mapping-1075"></span><span class="token add" data-title="contract_body/modifier_definition">modifier onlyRegistry <span class="marker" id="mapping-1076"></span><span class="token add" data-title="modifier_definition/function_body">{
      <span class="marker" id="mapping-1077"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1078"></span><span class="token add" data-title="expression_statement/call_expression">require(<span class="marker" id="mapping-1079"></span><span class="token add" data-title="call_expression/call_argument"><span class="marker" id="mapping-1080"></span><span class="token mv" id="move-dst-205" data-title="call_argument/binary_expression"><span class="marker" id="mapping-1081"></span><span class="token mv" id="move-dst-48" data-title="binary_expression/member_expression">msg.sender</span> == address(<span class="marker" id="mapping-1082"></span><span class="token add" data-title="call_argument/identifier">registry</span>)</span></span>)</span>;</span>
      <span class="marker" id="mapping-1083"></span><span class="token add" data-title="function_body/expression_statement">_;</span>
    }</span></span>

    <span class="marker" id="mapping-1084"></span><span class="token add" data-title="contract_body/function_definition">function syncAttributeValue(<span class="marker" id="mapping-1085"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1086"></span><span class="token add" data-title="function_definition/parameter">bytes32 _attribute</span>, <span class="marker" id="mapping-1087"></span><span class="token add" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1088"></span><span class="token mv" id="move-dst-86" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-1089"></span><span class="token add" data-title="function_definition/modifier_invocation">onlyRegistry</span> <span class="marker" id="mapping-1090"></span><span class="token add" data-title="function_definition/function_body">{
        attributes[_attribute][_who] = _value;
    }</span></span>

    <span class="marker" id="mapping-1091"></span><span class="token mv" id="move-dst-154" data-title="contract_body/function_definition">function _burnAllArgs(address <span class="marker" id="mapping-1092"></span><span class="token upd" id="move-dst-155" data-title="parameter/identifier"><span class="cupd">_</span>from</span>, <span class="marker" id="mapping-1093"></span><span class="token add" data-title="function_definition/parameter">uint256 _value</span>) internal {
        <span class="marker" id="mapping-1094"></span><span class="token add" data-title="call_expression/identifier">_requireCanBurn</span>(<span class="marker" id="mapping-1095"></span><span class="token upd" id="move-dst-157" data-title="call_argument/identifier"><span class="cupd">_</span>from</span>);
        super._burnAllArgs(<span class="marker" id="mapping-1096"></span><span class="token mv" id="move-dst-79" data-title="call_expression/call_argument">_from</span>, _value);
    }</span>

    <span class="marker" id="mapping-1097"></span><span class="token add" data-title="contract_body/comment">// Destroy the tokens owned by a blacklisted account</span>
    <span class="marker" id="mapping-1098"></span><span class="token mv" id="move-dst-158" data-title="contract_body/function_definition">function wipeBlacklistedAccount(address _account) public onlyOwner {
        require(<span class="marker" id="mapping-1099"></span><span class="token add" data-title="call_argument/call_expression">_isBlacklisted(_account)</span>, "_account is not blacklisted");
        uint256 oldValue = <span class="marker" id="mapping-1100"></span><span class="token upd" id="move-dst-160" data-title="call_expression/identifier">_getB<span class="cupd">alance</span></span>(_account);
        <span class="marker" id="mapping-1101"></span><span class="token add" data-title="call_expression/identifier">_setBalance</span>(_account, 0);
        totalSupply_ = totalSupply_.sub(oldValue);
        emit WipeBlacklistedAccount(_account, oldValue);
        emit Transfer(_account, address(0), oldValue);
    }</span>

    <span class="marker" id="mapping-1102"></span><span class="token add" data-title="contract_body/function_definition">function _isBlacklisted(<span class="marker" id="mapping-1103"></span><span class="token add" data-title="function_definition/parameter">address _account</span>) <span class="marker" id="mapping-1104"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1105"></span><span class="token mv" id="move-dst-37" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1106"></span><span class="token add" data-title="function_definition/return_type_definition">returns (bool blacklisted)</span> <span class="marker" id="mapping-1107"></span><span class="token add" data-title="function_definition/function_body">{
        return attributes[IS_BLACKLISTED][_account] != 0;
    }</span></span>

    <span class="marker" id="mapping-1108"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanTransfer(<span class="marker" id="mapping-1109"></span><span class="token add" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-1110"></span><span class="token mv" id="move-dst-282" data-title="function_definition/parameter">address _to</span>) <span class="marker" id="mapping-1111"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1112"></span><span class="token mv" id="move-dst-31" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1113"></span><span class="token add" data-title="function_definition/return_type_definition">returns (address, bool)</span> <span class="marker" id="mapping-1114"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1115"></span><span class="token add" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-1116"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration">uint256 depositAddressValue</span> = <span class="marker" id="mapping-1117"></span><span class="token mv" id="move-dst-34" data-title="variable_declaration_statement/array_access"><span class="marker" id="mapping-1118"></span><span class="token add" data-title="array_access/array_access">attributes[IS_DEPOSIT_ADDRESS]</span>[address(uint256(<span class="marker" id="mapping-1119"></span><span class="token add" data-title="type_cast_expression/call_argument">_to</span>) &gt;&gt; 20)]</span>;</span>
        <span class="marker" id="mapping-1120"></span><span class="token add" data-title="function_body/if_statement">if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }</span>
        <span class="marker" id="mapping-1121"></span><span class="token add" data-title="function_body/expression_statement">require (attributes[IS_BLACKLISTED][_to] == 0, "blacklisted");</span>
        <span class="marker" id="mapping-1122"></span><span class="token add" data-title="function_body/expression_statement">require (attributes[IS_BLACKLISTED][_from] == 0, "blacklisted");</span>
        <span class="marker" id="mapping-1123"></span><span class="token add" data-title="function_body/return_statement">return (_to, attributes[IS_REGISTERED_CONTRACT][_to] != 0);</span>
    }</span></span>

    <span class="marker" id="mapping-1124"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanTransferFrom(<span class="marker" id="mapping-1125"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-1126"></span><span class="token mv" id="move-dst-75" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-1127"></span><span class="token mv" id="move-dst-76" data-title="function_definition/parameter">address _to</span>) <span class="marker" id="mapping-1128"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1129"></span><span class="token mv" id="move-dst-30" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1130"></span><span class="token add" data-title="function_definition/return_type_definition">returns (address, bool)</span> <span class="marker" id="mapping-1131"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1132"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 flag;</span>
        <span class="marker" id="mapping-1133"></span><span class="token add" data-title="function_body/expression_statement">require (attributes[IS_BLACKLISTED][_spender] == 0, "blacklisted");</span>
        <span class="marker" id="mapping-1134"></span><span class="token add" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-1135"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration">uint256 depositAddressValue</span> = <span class="marker" id="mapping-1136"></span><span class="token add" data-title="variable_declaration_statement/array_access"><span class="marker" id="mapping-1137"></span><span class="token add" data-title="array_access/array_access">attributes[IS_DEPOSIT_ADDRESS]</span>[<span class="marker" id="mapping-1138"></span><span class="token add" data-title="array_access/type_cast_expression"><span class="marker" id="mapping-1139"></span><span class="token mv" id="move-dst-38" data-title="type_cast_expression/primitive_type">address</span>(<span class="marker" id="mapping-1140"></span><span class="token add" data-title="type_cast_expression/call_argument"><span class="marker" id="mapping-1141"></span><span class="token add" data-title="call_argument/binary_expression"><span class="marker" id="mapping-1142"></span><span class="token add" data-title="binary_expression/type_cast_expression"><span class="marker" id="mapping-1143"></span><span class="token mv" id="move-dst-317" data-title="type_cast_expression/primitive_type">uint256</span>(<span class="marker" id="mapping-1144"></span><span class="token add" data-title="type_cast_expression/call_argument">_to</span>)</span> &gt;&gt; 20</span></span>)</span>]</span>;</span>
        <span class="marker" id="mapping-1145"></span><span class="token add" data-title="function_body/if_statement">if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }</span>
        <span class="marker" id="mapping-1146"></span><span class="token add" data-title="function_body/expression_statement">require (attributes[IS_BLACKLISTED][_to] == 0, "blacklisted");</span>
        <span class="marker" id="mapping-1147"></span><span class="token add" data-title="function_body/expression_statement">require (attributes[IS_BLACKLISTED][_from] == 0, "blacklisted");</span>
        <span class="marker" id="mapping-1148"></span><span class="token add" data-title="function_body/return_statement">return (_to, attributes[IS_REGISTERED_CONTRACT][_to] != 0);</span>
    }</span></span>

    <span class="marker" id="mapping-1149"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanMint(<span class="marker" id="mapping-1150"></span><span class="token mv" id="move-dst-69" data-title="function_definition/parameter">address _to</span>) <span class="marker" id="mapping-1151"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1152"></span><span class="token mv" id="move-dst-28" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1153"></span><span class="token add" data-title="function_definition/return_type_definition">returns (address, bool)</span> <span class="marker" id="mapping-1154"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1155"></span><span class="token add" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-1156"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration">uint256 depositAddressValue</span> = <span class="marker" id="mapping-1157"></span><span class="token add" data-title="variable_declaration_statement/array_access"><span class="marker" id="mapping-1158"></span><span class="token add" data-title="array_access/array_access">attributes[IS_DEPOSIT_ADDRESS]</span>[<span class="marker" id="mapping-1159"></span><span class="token add" data-title="array_access/type_cast_expression"><span class="marker" id="mapping-1160"></span><span class="token mv" id="move-dst-217" data-title="type_cast_expression/primitive_type">address</span>(<span class="marker" id="mapping-1161"></span><span class="token add" data-title="type_cast_expression/call_argument"><span class="marker" id="mapping-1162"></span><span class="token add" data-title="call_argument/binary_expression"><span class="marker" id="mapping-1163"></span><span class="token add" data-title="binary_expression/type_cast_expression"><span class="marker" id="mapping-1164"></span><span class="token mv" id="move-dst-316" data-title="type_cast_expression/primitive_type">uint256</span>(<span class="marker" id="mapping-1165"></span><span class="token add" data-title="type_cast_expression/call_argument">_to</span>)</span> &gt;&gt; 20</span></span>)</span>]</span>;</span>
        <span class="marker" id="mapping-1166"></span><span class="token add" data-title="function_body/if_statement">if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }</span>
        <span class="marker" id="mapping-1167"></span><span class="token mv" id="move-dst-7" data-title="function_body/expression_statement">require (<span class="marker" id="mapping-1168"></span><span class="token add" data-title="call_argument/binary_expression">attributes[IS_BLACKLISTED][_to] == 0</span>, "blacklisted");</span>
        <span class="marker" id="mapping-1169"></span><span class="token add" data-title="function_body/return_statement">return (_to, attributes[IS_REGISTERED_CONTRACT][_to] != 0);</span>
    }</span></span>

    <span class="marker" id="mapping-1170"></span><span class="token add" data-title="contract_body/function_definition">function _requireOnlyCanBurn(<span class="marker" id="mapping-1171"></span><span class="token add" data-title="function_definition/parameter">address _from</span>) <span class="marker" id="mapping-1172"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1173"></span><span class="token mv" id="move-dst-17" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1174"></span><span class="token add" data-title="function_definition/function_body">{
        require (attributes[canBurn()][_from] != 0, "cannot burn from this address");
    }</span></span>

    <span class="marker" id="mapping-1175"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanBurn(<span class="marker" id="mapping-1176"></span><span class="token add" data-title="function_definition/parameter">address _from</span>) <span class="marker" id="mapping-1177"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1178"></span><span class="token mv" id="move-dst-15" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1179"></span><span class="token add" data-title="function_definition/function_body">{
        require (attributes[IS_BLACKLISTED][_from] == 0, "blacklisted");
        require (attributes[canBurn()][_from] != 0, "cannot burn from this address");
    }</span></span>

    <span class="marker" id="mapping-1180"></span><span class="token mv" id="move-dst-312" data-title="contract_body/function_definition">function paused() public pure returns (bool) {
        return false;
    }</span>
}

// File: contracts/DelegateERC20.sol

/** @title DelegateERC20
Accept forwarding delegation calls from the old TrueUSD (V1) contract. This way the all the ERC20
functions in the old contract still works (except Burn). 
*/
contract DelegateERC20 is <span class="marker" id="mapping-1181"></span><span class="token upd" id="move-dst-289" data-title="user_defined_type/identifier">C<span class="cupd">o</span>mp<span class="cupd">l</span>i<span class="cupd">a</span>n<span class="cupd">t</span>Deposit<span class="cupd">Token</span>WithHook</span> {

    address constant DELEGATE_FROM = 0x8dd5fbCe2F6a956C3022bA3663759011Dd51e73E;
    
    modifier onlyDelegateFrom() {
        require(msg.sender == DELEGATE_FROM);
        _;
    }

    function delegateTotalSupply() public view returns (uint256) {
        return totalSupply();
    }

    function delegateBalanceOf(address who) public view returns (uint256) {
        return <span class="marker" id="mapping-1182"></span><span class="token upd" id="move-dst-290" data-title="call_expression/identifier">_getB<span class="cupd">alance</span></span>(who);
    }

    function delegateTransfer(address to, uint256 value, address origSender) public onlyDelegateFrom returns (bool) {
        _transferAllArgs(origSender, to, value);
        return true;
    }

    function delegateAllowance(address owner, address spender) public view returns (uint256) {
        return <span class="marker" id="mapping-1183"></span><span class="token upd" id="move-dst-291" data-title="call_expression/identifier">_getA<span class="cupd">llowance</span></span>(owner, spender);
    }

    function delegateTransferFrom(address from, address to, uint256 value, address origSender) public onlyDelegateFrom returns (bool) {
        _transferFromAllArgs(from, to, value, origSender);
        return true;
    }

    function delegateApprove(address spender, uint256 value, address origSender) public onlyDelegateFrom returns (bool) {
        _approveAllArgs(spender, value, origSender);
        return true;
    }

    function delegateIncreaseApproval(address spender, uint addedValue, address origSender) public onlyDelegateFrom returns (bool) {
        _increaseApprovalAllArgs(spender, addedValue, origSender);
        return true;
    }

    function delegateDecreaseApproval(address spender, uint subtractedValue, address origSender) public onlyDelegateFrom returns (bool) {
        _decreaseApprovalAllArgs(spender, subtractedValue, origSender);
        return true;
    }
}

// File: contracts/TrueUSD.sol

/** @title TrueUSD
* @dev This is the top-level ERC20 contract, but most of the interesting functionality is
* inherited - see the documentation on the corresponding contracts.
*/
<span class="marker" id="mapping-1184"></span><span class="token add" data-title="source_file/contract_declaration">contract TrueUSD is 
<span class="marker" id="mapping-1185"></span><span class="token mv" id="move-dst-295" data-title="contract_declaration/inheritance_specifier">CompliantDepositTokenWithHook</span>,
<span class="marker" id="mapping-1186"></span><span class="token mv" id="move-dst-297" data-title="contract_declaration/inheritance_specifier">DelegateERC20</span> <span class="marker" id="mapping-1187"></span><span class="token add" data-title="contract_declaration/contract_body">{
    <span class="marker" id="mapping-1188"></span><span class="token mv" id="move-dst-302" data-title="contract_body/state_variable_declaration">uint8 constant <span class="marker" id="mapping-1189"></span><span class="token upd" id="move-dst-303" data-title="state_variable_declaration/identifier"><span class="cupd">D</span>ECIMALS</span> = <span class="marker" id="mapping-1190"></span><span class="token upd" id="move-dst-304" data-title="state_variable_declaration/number_literal">18</span>;</span>
    <span class="marker" id="mapping-1191"></span><span class="token mv" id="move-dst-299" data-title="contract_body/state_variable_declaration">uint8 constant <span class="marker" id="mapping-1192"></span><span class="token upd" id="move-dst-300" data-title="state_variable_declaration/identifier">ROUN<span class="cupd">D</span>ING</span> = <span class="marker" id="mapping-1193"></span><span class="token upd" id="move-dst-301" data-title="state_variable_declaration/number_literal">2</span>;</span>

    <span class="marker" id="mapping-1194"></span><span class="token mv" id="move-dst-305" data-title="contract_body/function_definition">function decimals() public pure returns (uint8) {
        return DECIMALS;
    }</span>

    <span class="marker" id="mapping-1195"></span><span class="token mv" id="move-dst-306" data-title="contract_body/function_definition">function rounding() public pure returns (uint8) {
        return ROUNDING;
    }</span>

    <span class="marker" id="mapping-1196"></span><span class="token add" data-title="contract_body/function_definition">function name() <span class="marker" id="mapping-1197"></span><span class="token mv" id="move-dst-244" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-1198"></span><span class="token add" data-title="function_definition/state_mutability">pure</span> <span class="marker" id="mapping-1199"></span><span class="token add" data-title="function_definition/return_type_definition">returns (<span class="marker" id="mapping-1200"></span><span class="token mv" id="move-dst-308" data-title="return_type_definition/parameter">string</span>)</span> <span class="marker" id="mapping-1201"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1202"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1203"></span><span class="token mv" id="move-dst-218" data-title="return_statement/string_literal">"TrueUSD"</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-1204"></span><span class="token add" data-title="contract_body/function_definition">function symbol() <span class="marker" id="mapping-1205"></span><span class="token mv" id="move-dst-66" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-1206"></span><span class="token add" data-title="function_definition/state_mutability">pure</span> <span class="marker" id="mapping-1207"></span><span class="token add" data-title="function_definition/return_type_definition">returns (<span class="marker" id="mapping-1208"></span><span class="token mv" id="move-dst-307" data-title="return_type_definition/parameter">string</span>)</span> <span class="marker" id="mapping-1209"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1210"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1211"></span><span class="token mv" id="move-dst-206" data-title="return_statement/string_literal">"TUSD"</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-1212"></span><span class="token add" data-title="contract_body/function_definition">function canBurn() <span class="marker" id="mapping-1213"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1214"></span><span class="token add" data-title="function_definition/state_mutability">pure</span> <span class="marker" id="mapping-1215"></span><span class="token add" data-title="function_definition/return_type_definition">returns (bytes32)</span> <span class="marker" id="mapping-1216"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1217"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1218"></span><span class="token mv" id="move-dst-5" data-title="return_statement/string_literal">"canBurn"</span>;</span>
    }</span></span>
}</span></span>

<span class="marker" id="mapping-1219"></span><span class="token mv" id="move-dst-162" data-title="source_file/comment"><span class="marker" id="mapping-1220"></span><span class="token upd" id="move-dst-162" data-title="source_file/comment"><span class="cupd">// File: contracts/Dep</span>reca<span class="cupd">t</span><span class="cupd">e</span>dGasRefu<span class="cupd">n</span>dPool<span class="cupd">.sol</span></span></span>

<span class="marker" id="mapping-1221"></span><span class="token add" data-title="source_file/pragma_directive">pragma solidity^0.4.23;</span>


<span class="marker" id="mapping-1222"></span><span class="token mv" id="move-dst-227" data-title="source_file/contract_declaration">contract <span class="marker" id="mapping-1223"></span><span class="token upd" id="move-dst-228" data-title="contract_declaration/identifier">Deprecated<span class="cupd">GasRefund</span>Pool</span> is <span class="marker" id="mapping-1224"></span><span class="token upd" id="move-dst-229" data-title="user_defined_type/identifier">Pr<span class="cupd">o</span>xySto<span class="cupd">r</span><span class="cupd">a</span>ge</span> {
    <span class="marker" id="mapping-1225"></span><span class="token add" data-title="contract_body/modifier_definition">modifier retroGasRefund15 <span class="marker" id="mapping-1226"></span><span class="token add" data-title="modifier_definition/function_body">{
        <span class="marker" id="mapping-1227"></span><span class="token add" data-title="function_body/expression_statement">_;</span>
        <span class="marker" id="mapping-1228"></span><span class="token mv" id="move-dst-232" data-title="function_body/variable_declaration_statement">uint256 len = <span class="marker" id="mapping-1229"></span><span class="token upd" id="move-dst-233" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>.length;</span>
        <span class="marker" id="mapping-1230"></span><span class="token add" data-title="function_body/if_statement">if (<span class="marker" id="mapping-1231"></span><span class="token add" data-title="if_statement/array_access"><span class="marker" id="mapping-1232"></span><span class="token add" data-title="array_access/binary_expression"><span class="marker" id="mapping-1233"></span><span class="token add" data-title="binary_expression/member_expression"><span class="marker" id="mapping-1234"></span><span class="token add" data-title="member_expression/binary_expression"><span class="marker" id="mapping-1235"></span><span class="token mv" id="move-dst-249" data-title="binary_expression/binary_expression">len &gt; 0</span> &amp;&amp; tx</span>.gasprice</span> &gt; gasRefundPool_Deprecated</span>[<span class="marker" id="mapping-1236"></span><span class="token add" data-title="array_access/binary_expression">len-1</span>]</span>) <span class="marker" id="mapping-1237"></span><span class="token add" data-title="if_statement/block_statement">{
            gasRefundPool_Deprecated.length = len - 1;
        }</span></span>
    }</span></span>
    <span class="marker" id="mapping-1238"></span><span class="token add" data-title="contract_body/modifier_definition">modifier retroGasRefund30 <span class="marker" id="mapping-1239"></span><span class="token mv" id="move-dst-247" data-title="modifier_definition/function_body">{
        <span class="marker" id="mapping-1240"></span><span class="token add" data-title="function_body/expression_statement">_;</span>
        uint256 len = <span class="marker" id="mapping-1241"></span><span class="token upd" id="move-dst-248" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>.length;
        if (<span class="marker" id="mapping-1242"></span><span class="token add" data-title="if_statement/array_access"><span class="marker" id="mapping-1243"></span><span class="token add" data-title="array_access/binary_expression">len &gt; 1 &amp;&amp; tx.gasprice &gt; gasRefundPool_Deprecated</span>[<span class="marker" id="mapping-1244"></span><span class="token mv" id="move-dst-250" data-title="array_access/binary_expression">len-1</span>]</span>) {
            <span class="marker" id="mapping-1245"></span><span class="token add" data-title="block_statement/expression_statement">gasRefundPool_Deprecated.length = len - 2;</span>
        }
    }</span></span>
    modifier <span class="marker" id="mapping-1246"></span><span class="token upd" id="move-dst-252" data-title="modifier_definition/identifier">retroG<span class="cupd">asRefund</span>45</span> {
        <span class="marker" id="mapping-1247"></span><span class="token mv" id="move-dst-256" data-title="function_body/expression_statement">_;</span>
        uint256 len = <span class="marker" id="mapping-1248"></span><span class="token upd" id="move-dst-253" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>.length;
        if (len &gt; 2 &amp;&amp; tx.gasprice &gt; <span class="marker" id="mapping-1249"></span><span class="token upd" id="move-dst-254" data-title="binary_expression/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len-1]) {
            <span class="marker" id="mapping-1250"></span><span class="token upd" id="move-dst-255" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>.length = len - 3;
        }
    }
    <span class="marker" id="mapping-1251"></span><span class="token add" data-title="contract_body/modifier_definition">modifier retroSponsorGas <span class="marker" id="mapping-1252"></span><span class="token mv" id="move-dst-231" data-title="modifier_definition/function_body">{
        uint256 refundPrice = minimumGasPriceForFutureRefunds;
        require(refundPrice &gt; 0);
        <span class="marker" id="mapping-1253"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 len = gasRefundPool_Deprecated.length;</span>
        <span class="marker" id="mapping-1254"></span><span class="token upd" id="move-dst-234" data-title="member_expression/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>.length = len + 9;
        <span class="marker" id="mapping-1255"></span><span class="token upd" id="move-dst-235" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len] = refundPrice;
        <span class="marker" id="mapping-1256"></span><span class="token upd" id="move-dst-236" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 1] = refundPrice;
        <span class="marker" id="mapping-1257"></span><span class="token upd" id="move-dst-237" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 2] = refundPrice;
        <span class="marker" id="mapping-1258"></span><span class="token upd" id="move-dst-238" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 3] = refundPrice;
        <span class="marker" id="mapping-1259"></span><span class="token upd" id="move-dst-239" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 4] = refundPrice;
        <span class="marker" id="mapping-1260"></span><span class="token upd" id="move-dst-240" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 5] = refundPrice;
        <span class="marker" id="mapping-1261"></span><span class="token upd" id="move-dst-241" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 6] = refundPrice;
        <span class="marker" id="mapping-1262"></span><span class="token upd" id="move-dst-242" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 7] = refundPrice;
        <span class="marker" id="mapping-1263"></span><span class="token upd" id="move-dst-243" data-title="array_access/identifier"><span class="cupd">gasRefundPool</span>_Deprecated</span>[len + 8] = refundPrice;
        <span class="marker" id="mapping-1264"></span><span class="token add" data-title="function_body/expression_statement">_;</span>
    }</span></span>
    <span class="marker" id="mapping-1265"></span><span class="token add" data-title="contract_body/function_definition">function retroGasPoolRemaining() <span class="marker" id="mapping-1266"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1267"></span><span class="token mv" id="move-dst-245" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1268"></span><span class="token mv" id="move-dst-246" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-1269"></span><span class="token add" data-title="function_definition/function_body">{
        return gasRefundPool_Deprecated.length;
    }</span></span>
}</span>

<span class="marker" id="mapping-1270"></span><span class="token mv" id="move-dst-164" data-title="source_file/comment"><span class="marker" id="mapping-1271"></span><span class="token upd" id="move-dst-164" data-title="source_file/comment"><span class="cupd">/</span>/<span class="cupd"> </span>F<span class="cupd">i</span><span class="cupd">le</span>:<span class="cupd"> </span><span class="cupd">r</span><span class="cupd">egist</span><span class="cupd">r</span>y/c<span class="cupd">o</span>n<span class="cupd">t</span><span class="cupd">ra</span>c<span class="cupd">t</span><span class="cupd">s</span>/P<span class="cupd">r</span><span class="cupd">o</span>v<span class="cupd">is</span><span class="cupd">i</span><span class="cupd">o</span>n<span class="cupd">a</span>lR<span class="cupd">e</span><span class="cupd">gist</span><span class="cupd">r</span>y<span class="cupd">.</span><span class="cupd">s</span><span class="cupd">o</span>l</span></span>

<span class="marker" id="mapping-1272"></span><span class="token add" data-title="source_file/contract_declaration">contract ProvisionalRegistry is <span class="marker" id="mapping-1273"></span><span class="token add" data-title="contract_declaration/inheritance_specifier">Registry</span> <span class="marker" id="mapping-1274"></span><span class="token add" data-title="contract_declaration/contract_body">{
    <span class="marker" id="mapping-1275"></span><span class="token mv" id="move-dst-174" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-1276"></span><span class="token upd" id="move-dst-175" data-title="state_variable_declaration/identifier"><span class="cupd">IS_</span>BLACKL<span class="cupd">ISTE</span>D</span> = "isBlacklisted";</span>
    <span class="marker" id="mapping-1277"></span><span class="token mv" id="move-dst-3" data-title="contract_body/state_variable_declaration">bytes32 constant IS_DEPOSIT_ADDRESS = "isDepositAddress";</span>
    <span class="marker" id="mapping-1278"></span><span class="token mv" id="move-dst-1" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-1279"></span><span class="token upd" id="move-dst-2" data-title="state_variable_declaration/identifier"><span class="cupd">IS_</span>REG<span class="cupd">ISTE</span>RED_CONTRACT</span> = "isRegisteredContract";</span>
    <span class="marker" id="mapping-1280"></span><span class="token mv" id="move-dst-286" data-title="contract_body/state_variable_declaration">bytes32 constant <span class="marker" id="mapping-1281"></span><span class="token upd" id="move-dst-287" data-title="state_variable_declaration/identifier"><span class="cupd">CAN_</span>B<span class="cupd">U</span><span class="cupd">R</span>N</span> = "canBurn";</span>

    <span class="marker" id="mapping-1282"></span><span class="token mv" id="move-dst-42" data-title="contract_body/function_definition">function requireCanTransfer(address _from, address _to) public view returns (address, bool) {
        require (attributes[_from][IS_BLACKLISTED].value == 0, "blacklisted");
        uint256 depositAddressValue = attributes[address(uint256(_to) &gt;&gt; 20)][IS_DEPOSIT_ADDRESS].value;
        if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }
        require (attributes[_to][IS_BLACKLISTED].value == 0, "blacklisted");
        return (_to, attributes[_to][IS_REGISTERED_CONTRACT].value != 0);
    }</span>

    <span class="marker" id="mapping-1283"></span><span class="token mv" id="move-dst-43" data-title="contract_body/function_definition">function requireCanTransferFrom(address _sender, address _from, address _to) public view returns (address, bool) {
        require (attributes[_sender][IS_BLACKLISTED].value == 0, "blacklisted");
        return requireCanTransfer(_from, _to);
    }</span>

    <span class="marker" id="mapping-1284"></span><span class="token mv" id="move-dst-44" data-title="contract_body/function_definition">function requireCanMint(address _to) public view returns (address, bool) {
        require (attributes[_to][IS_BLACKLISTED].value == 0, "blacklisted");
        uint256 depositAddressValue = attributes[address(uint256(_to) &gt;&gt; 20)][IS_DEPOSIT_ADDRESS].value;
        if (depositAddressValue != 0) {
            _to = address(depositAddressValue);
        }
        return (_to, attributes[_to][IS_REGISTERED_CONTRACT].value != 0);
    }</span>

    <span class="marker" id="mapping-1285"></span><span class="token mv" id="move-dst-45" data-title="contract_body/function_definition">function requireCanBurn(address _from) public view {
        require (attributes[_from][CAN_BURN].value != 0);
        require (attributes[_from][IS_BLACKLISTED].value == 0);
    }</span>
}</span></span>

<span class="marker" id="mapping-1286"></span><span class="token mv" id="move-dst-168" data-title="source_file/comment"><span class="marker" id="mapping-1287"></span><span class="token upd" id="move-dst-168" data-title="source_file/comment"><span class="cupd">// File: contracts/</span>P<span class="cupd">r</span>ovisional<span class="cupd">Co</span>mpl<span class="cupd">i</span>a<span class="cupd">n</span>tD<span class="cupd">e</span>positTok<span class="cupd">e</span>nW<span class="cupd">i</span>thHook<span class="cupd">.sol</span></span></span>

<span class="marker" id="mapping-1288"></span><span class="token mv" id="move-dst-171" data-title="source_file/comment"><span class="marker" id="mapping-1289"></span><span class="token upd" id="move-dst-171" data-title="source_file/comment"><span class="cupd">// </span>Supports ba<span class="cupd">l</span>anc<span class="cupd">e</span><span class="cupd"> </span>and all<span class="cupd">o</span>wa<span class="cupd">n</span>ce mig<span class="cupd">ra</span><span class="cupd">t</span>i<span class="cupd">o</span><span class="cupd">n</span> a<span class="cupd">t</span> great c<span class="cupd">o</span>st</span></span>
<span class="marker" id="mapping-1290"></span><span class="token add" data-title="source_file/contract_declaration">contract ProvisionalCompliantDepositTokenWithHook is <span class="marker" id="mapping-1291"></span><span class="token add" data-title="contract_declaration/inheritance_specifier">CompliantDepositTokenWithHook</span>, <span class="marker" id="mapping-1292"></span><span class="token add" data-title="contract_declaration/inheritance_specifier">DeprecatedGasRefundPool</span> <span class="marker" id="mapping-1293"></span><span class="token add" data-title="contract_declaration/contract_body">{
    <span class="marker" id="mapping-1294"></span><span class="token add" data-title="contract_body/function_definition">function _isBlacklisted(<span class="marker" id="mapping-1295"></span><span class="token add" data-title="function_definition/parameter">address _account</span>) <span class="marker" id="mapping-1296"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1297"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1298"></span><span class="token mv" id="move-dst-68" data-title="function_definition/return_type_definition">returns (bool)</span> <span class="marker" id="mapping-1299"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1300"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1301"></span><span class="token mv" id="move-dst-159" data-title="return_statement/call_expression">registry.hasAttribute(_account, IS_BLACKLISTED)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-1302"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanTransfer(<span class="marker" id="mapping-1303"></span><span class="token mv" id="move-dst-201" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-1304"></span><span class="token mv" id="move-dst-202" data-title="function_definition/parameter">address _to</span>) <span class="marker" id="mapping-1305"></span><span class="token mv" id="move-dst-204" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1306"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1307"></span><span class="token add" data-title="function_definition/return_type_definition">returns (address, bool)</span> <span class="marker" id="mapping-1308"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1309"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1310"></span><span class="token add" data-title="return_statement/call_expression"><span class="marker" id="mapping-1311"></span><span class="token add" data-title="call_expression/member_expression">ProvisionalRegistry(registry).requireCanTransfer</span>(<span class="marker" id="mapping-1312"></span><span class="token add" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-1313"></span><span class="token mv" id="move-dst-136" data-title="call_expression/call_argument">_to</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-1314"></span><span class="token mv" id="move-dst-269" data-title="contract_body/function_definition">function <span class="marker" id="mapping-1315"></span><span class="token upd" id="move-dst-270" data-title="function_definition/identifier"><span class="cupd">_</span><span class="cupd">r</span>equireC<span class="cupd">an</span>Tran<span class="cupd">sferFrom</span></span>(<span class="marker" id="mapping-1316"></span><span class="token mv" id="move-dst-215" data-title="function_definition/parameter">address _sender</span>, <span class="marker" id="mapping-1317"></span><span class="token mv" id="move-dst-212" data-title="function_definition/parameter">address _from</span>, <span class="marker" id="mapping-1318"></span><span class="token mv" id="move-dst-213" data-title="function_definition/parameter">address _to</span>) <span class="marker" id="mapping-1319"></span><span class="token mv" id="move-dst-216" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1320"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1321"></span><span class="token add" data-title="function_definition/return_type_definition">returns (address, bool)</span> {
        <span class="marker" id="mapping-1322"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1323"></span><span class="token mv" id="move-dst-275" data-title="return_statement/call_expression"><span class="marker" id="mapping-1324"></span><span class="token add" data-title="member_expression/call_expression">ProvisionalRegistry(registry)</span>.<span class="marker" id="mapping-1325"></span><span class="token mv" id="move-dst-277" data-title="member_expression/identifier"><span class="marker" id="mapping-1326"></span><span class="token upd" id="move-dst-277" data-title="member_expression/identifier">req<span class="cupd">u</span>ir<span class="cupd">e</span>CanTransferFrom</span></span>(<span class="marker" id="mapping-1327"></span><span class="token mv" id="move-dst-281" data-title="call_expression/call_argument">_sender</span>, <span class="marker" id="mapping-1328"></span><span class="token mv" id="move-dst-278" data-title="call_expression/call_argument">_from</span>, <span class="marker" id="mapping-1329"></span><span class="token mv" id="move-dst-279" data-title="call_expression/call_argument">_to</span>)</span>;</span>
    }</span>

    <span class="marker" id="mapping-1330"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanMint(<span class="marker" id="mapping-1331"></span><span class="token mv" id="move-dst-263" data-title="function_definition/parameter">address _to</span>) <span class="marker" id="mapping-1332"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1333"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1334"></span><span class="token add" data-title="function_definition/return_type_definition">returns (address, bool)</span> <span class="marker" id="mapping-1335"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1336"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1337"></span><span class="token add" data-title="return_statement/call_expression"><span class="marker" id="mapping-1338"></span><span class="token add" data-title="call_expression/member_expression">ProvisionalRegistry(registry).requireCanMint</span>(<span class="marker" id="mapping-1339"></span><span class="token mv" id="move-dst-267" data-title="call_expression/call_argument">_to</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-1340"></span><span class="token add" data-title="contract_body/function_definition">function _requireCanBurn(<span class="marker" id="mapping-1341"></span><span class="token add" data-title="function_definition/parameter">address _from</span>) <span class="marker" id="mapping-1342"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1343"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1344"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1345"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1346"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-1347"></span><span class="token add" data-title="call_expression/member_expression">ProvisionalRegistry(registry).requireCanBurn</span>(<span class="marker" id="mapping-1348"></span><span class="token mv" id="move-dst-193" data-title="call_expression/call_argument">_from</span>)</span>;</span>
    }</span></span>
    <span class="marker" id="mapping-1349"></span><span class="token mv" id="move-dst-261" data-title="contract_body/function_definition">function <span class="marker" id="mapping-1350"></span><span class="token upd" id="move-dst-262" data-title="function_definition/identifier"><span class="cupd">_</span><span class="cupd">r</span><span class="cupd">e</span>qui<span class="cupd">r</span>eOn<span class="cupd">l</span>yCanBurn</span>(address _from) internal <span class="marker" id="mapping-1351"></span><span class="token add" data-title="function_definition/state_mutability">view</span> {
        <span class="marker" id="mapping-1352"></span><span class="token add" data-title="member_expression/call_expression">ProvisionalRegistry(registry)</span>.<span class="marker" id="mapping-1353"></span><span class="token mv" id="move-dst-266" data-title="member_expression/identifier"><span class="marker" id="mapping-1354"></span><span class="token upd" id="move-dst-266" data-title="member_expression/identifier">req<span class="cupd">u</span>ir<span class="cupd">e</span>CanBurn</span></span>(_from);
    }</span>
    <span class="marker" id="mapping-1355"></span><span class="token add" data-title="contract_body/function_definition">function migratedBalanceOf(<span class="marker" id="mapping-1356"></span><span class="token add" data-title="function_definition/parameter">address _who</span>) <span class="marker" id="mapping-1357"></span><span class="token mv" id="move-dst-257" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-1358"></span><span class="token mv" id="move-dst-258" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1359"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-1360"></span><span class="token add" data-title="function_definition/function_body">{
        return super._getBalance(_who);
    }</span></span>
    <span class="marker" id="mapping-1361"></span><span class="token add" data-title="contract_body/function_definition">function _getBalance(address _who) internal view returns (uint256) {
        return balances_Deprecated.balanceOf(_who);
    }</span>
    <span class="marker" id="mapping-1362"></span><span class="token add" data-title="contract_body/function_definition">function _addBalance(<span class="marker" id="mapping-1363"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1364"></span><span class="token mv" id="move-dst-264" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1365"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1366"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256 priorBalance)</span> <span class="marker" id="mapping-1367"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1368"></span><span class="token add" data-title="function_body/expression_statement">priorBalance = _getBalance(_who);</span>
        <span class="marker" id="mapping-1369"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1370"></span><span class="token add" data-title="expression_statement/call_expression">_setBalance(<span class="marker" id="mapping-1371"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1372"></span><span class="token add" data-title="call_expression/call_argument"><span class="marker" id="mapping-1373"></span><span class="token add" data-title="call_argument/call_expression"><span class="marker" id="mapping-1374"></span><span class="token add" data-title="call_expression/member_expression">priorBalance.add</span>(<span class="marker" id="mapping-1375"></span><span class="token mv" id="move-dst-188" data-title="call_expression/call_argument">_value</span>)</span></span>)</span>;</span>
    }</span></span>
    <span class="marker" id="mapping-1376"></span><span class="token add" data-title="contract_body/function_definition">function _subBalance(<span class="marker" id="mapping-1377"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1378"></span><span class="token mv" id="move-dst-283" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1379"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1380"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256 balanceNew)</span> <span class="marker" id="mapping-1381"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1382"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1383"></span><span class="token add" data-title="expression_statement/assignment_expression">balanceNew = <span class="marker" id="mapping-1384"></span><span class="token add" data-title="assignment_expression/call_expression"><span class="marker" id="mapping-1385"></span><span class="token add" data-title="call_expression/member_expression">_getBalance(_who).sub</span>(<span class="marker" id="mapping-1386"></span><span class="token mv" id="move-dst-74" data-title="call_expression/call_argument">_value</span>)</span></span>;</span>
        <span class="marker" id="mapping-1387"></span><span class="token add" data-title="function_body/expression_statement">_setBalance(_who, balanceNew);</span>
    }</span></span>
    <span class="marker" id="mapping-1388"></span><span class="token add" data-title="contract_body/function_definition">function _setBalance(<span class="marker" id="mapping-1389"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1390"></span><span class="token mv" id="move-dst-214" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1391"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1392"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1393"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1394"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-1395"></span><span class="token add" data-title="call_expression/member_expression">balances_Deprecated.setBalance</span>(<span class="marker" id="mapping-1396"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1397"></span><span class="token mv" id="move-dst-268" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-1398"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1399"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-1400"></span><span class="token add" data-title="call_expression/member_expression">super._setBalance</span>(<span class="marker" id="mapping-1401"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1402"></span><span class="token mv" id="move-dst-280" data-title="call_expression/call_argument">_value</span>)</span>;</span>
    }</span></span>

    <span class="marker" id="mapping-1403"></span><span class="token add" data-title="contract_body/function_definition">function migrateBalances(<span class="marker" id="mapping-1404"></span><span class="token mv" id="move-dst-63" data-title="function_definition/parameter"><span class="marker" id="mapping-1405"></span><span class="token add" data-title="parameter/type_name"><span class="marker" id="mapping-1406"></span><span class="token mv" id="move-dst-64" data-title="type_name/type_name">address</span>[]</span> <span class="marker" id="mapping-1407"></span><span class="token upd" id="move-dst-65" data-title="parameter/identifier"><span class="cupd">h</span>olders</span></span>) <span class="marker" id="mapping-1408"></span><span class="token mv" id="move-dst-309" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-1409"></span><span class="token add" data-title="function_definition/modifier_invocation">retroGasRefund45</span> <span class="marker" id="mapping-1410"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1411"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 i = holders.length;</span>
        <span class="marker" id="mapping-1412"></span><span class="token add" data-title="function_body/while_statement">while (<span class="marker" id="mapping-1413"></span><span class="token add" data-title="while_statement/binary_expression">i --&gt; 0</span>) <span class="marker" id="mapping-1414"></span><span class="token add" data-title="while_statement/block_statement">{
            <span class="marker" id="mapping-1415"></span><span class="token add" data-title="block_statement/variable_declaration_statement"><span class="marker" id="mapping-1416"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration"><span class="marker" id="mapping-1417"></span><span class="token mv" id="move-dst-25" data-title="variable_declaration/type_name">address</span> holder</span> = <span class="marker" id="mapping-1418"></span><span class="token add" data-title="variable_declaration_statement/array_access">holders[i]</span>;</span>
            <span class="marker" id="mapping-1419"></span><span class="token add" data-title="block_statement/expression_statement">super._setBalance(holder, _getBalance(holder));</span>
        }</span></span>
    }</span></span>

    <span class="marker" id="mapping-1420"></span><span class="token add" data-title="contract_body/function_definition">function migrateAllowances(<span class="marker" id="mapping-1421"></span><span class="token mv" id="move-dst-90" data-title="function_definition/parameter"><span class="marker" id="mapping-1422"></span><span class="token add" data-title="parameter/type_name"><span class="marker" id="mapping-1423"></span><span class="token mv" id="move-dst-91" data-title="type_name/type_name">address</span>[]</span> <span class="marker" id="mapping-1424"></span><span class="token upd" id="move-dst-92" data-title="parameter/identifier"><span class="cupd">h</span>olders</span></span>, <span class="marker" id="mapping-1425"></span><span class="token mv" id="move-dst-83" data-title="function_definition/parameter"><span class="marker" id="mapping-1426"></span><span class="token add" data-title="parameter/type_name"><span class="marker" id="mapping-1427"></span><span class="token mv" id="move-dst-84" data-title="type_name/type_name">address</span>[]</span> <span class="marker" id="mapping-1428"></span><span class="token upd" id="move-dst-85" data-title="parameter/identifier">spe<span class="cupd">n</span>d<span class="cupd">er</span>s</span></span>) <span class="marker" id="mapping-1429"></span><span class="token mv" id="move-dst-230" data-title="function_definition/visibility">external</span> <span class="marker" id="mapping-1430"></span><span class="token add" data-title="function_definition/modifier_invocation">retroGasRefund45</span> <span class="marker" id="mapping-1431"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1432"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 i = holders.length;</span>
        <span class="marker" id="mapping-1433"></span><span class="token add" data-title="function_body/while_statement">while (<span class="marker" id="mapping-1434"></span><span class="token add" data-title="while_statement/binary_expression">i --&gt; 0</span>) <span class="marker" id="mapping-1435"></span><span class="token add" data-title="while_statement/block_statement">{
            <span class="marker" id="mapping-1436"></span><span class="token add" data-title="block_statement/variable_declaration_statement"><span class="marker" id="mapping-1437"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration"><span class="marker" id="mapping-1438"></span><span class="token mv" id="move-dst-26" data-title="variable_declaration/type_name">address</span> holder</span> = <span class="marker" id="mapping-1439"></span><span class="token add" data-title="variable_declaration_statement/array_access">holders[i]</span>;</span>
            <span class="marker" id="mapping-1440"></span><span class="token add" data-title="block_statement/variable_declaration_statement"><span class="marker" id="mapping-1441"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration"><span class="marker" id="mapping-1442"></span><span class="token mv" id="move-dst-21" data-title="variable_declaration/type_name">address</span> spender</span> = <span class="marker" id="mapping-1443"></span><span class="token add" data-title="variable_declaration_statement/array_access">spenders[i]</span>;</span>
            <span class="marker" id="mapping-1444"></span><span class="token add" data-title="block_statement/expression_statement">super._setAllowance(holder, spender, _getAllowance(holder, spender));</span>
        }</span></span>
    }</span></span>
    <span class="marker" id="mapping-1445"></span><span class="token add" data-title="contract_body/function_definition">function migratedAllowance(<span class="marker" id="mapping-1446"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1447"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>) <span class="marker" id="mapping-1448"></span><span class="token mv" id="move-dst-284" data-title="function_definition/visibility">public</span> <span class="marker" id="mapping-1449"></span><span class="token add" data-title="function_definition/state_mutability">view</span> <span class="marker" id="mapping-1450"></span><span class="token add" data-title="function_definition/return_type_definition">returns (uint256)</span> <span class="marker" id="mapping-1451"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1452"></span><span class="token add" data-title="function_body/return_statement">return <span class="marker" id="mapping-1453"></span><span class="token add" data-title="return_statement/call_expression"><span class="marker" id="mapping-1454"></span><span class="token add" data-title="call_expression/member_expression">super._getAllowance</span>(<span class="marker" id="mapping-1455"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1456"></span><span class="token mv" id="move-dst-120" data-title="call_expression/call_argument">_spender</span>)</span>;</span>
    }</span></span>
    <span class="marker" id="mapping-1457"></span><span class="token add" data-title="contract_body/function_definition">function _getAllowance(address _who, address _spender) internal view returns (uint256) {
        return allowances_Deprecated.allowanceOf(_who, _spender);
    }</span>
    <span class="marker" id="mapping-1458"></span><span class="token add" data-title="contract_body/function_definition">function _addAllowance(<span class="marker" id="mapping-1459"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1460"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-1461"></span><span class="token mv" id="move-dst-314" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1462"></span><span class="token mv" id="move-dst-315" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1463"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1464"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 prior = _getAllowance(_who, _spender);</span>
        <span class="marker" id="mapping-1465"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1466"></span><span class="token add" data-title="expression_statement/call_expression">_setAllowance(<span class="marker" id="mapping-1467"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1468"></span><span class="token mv" id="move-dst-107" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-1469"></span><span class="token add" data-title="call_expression/call_argument"><span class="marker" id="mapping-1470"></span><span class="token add" data-title="call_argument/call_expression"><span class="marker" id="mapping-1471"></span><span class="token add" data-title="call_expression/member_expression">prior.add</span>(<span class="marker" id="mapping-1472"></span><span class="token mv" id="move-dst-199" data-title="call_expression/call_argument">_value</span>)</span></span>)</span>;</span> 
    }</span></span>
    <span class="marker" id="mapping-1473"></span><span class="token add" data-title="contract_body/function_definition">function _subAllowance(<span class="marker" id="mapping-1474"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1475"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-1476"></span><span class="token mv" id="move-dst-203" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1477"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1478"></span><span class="token add" data-title="function_definition/return_type_definition">returns (bool allowanceZero)</span> <span class="marker" id="mapping-1479"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1480"></span><span class="token add" data-title="function_body/variable_declaration_statement">uint256 prior = _getAllowance(_who, _spender);</span>
        <span class="marker" id="mapping-1481"></span><span class="token add" data-title="function_body/variable_declaration_statement"><span class="marker" id="mapping-1482"></span><span class="token add" data-title="variable_declaration_statement/variable_declaration">uint256 updated</span> = <span class="marker" id="mapping-1483"></span><span class="token add" data-title="variable_declaration_statement/call_expression"><span class="marker" id="mapping-1484"></span><span class="token add" data-title="call_expression/member_expression">prior.sub</span>(<span class="marker" id="mapping-1485"></span><span class="token mv" id="move-dst-190" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-1486"></span><span class="token add" data-title="function_body/expression_statement">_setAllowance(_who, _spender, updated);</span> 
        <span class="marker" id="mapping-1487"></span><span class="token add" data-title="function_body/expression_statement">allowanceZero = updated == 0;</span>
    }</span></span>
    <span class="marker" id="mapping-1488"></span><span class="token add" data-title="contract_body/function_definition">function _setAllowance(<span class="marker" id="mapping-1489"></span><span class="token add" data-title="function_definition/parameter">address _who</span>, <span class="marker" id="mapping-1490"></span><span class="token add" data-title="function_definition/parameter">address _spender</span>, <span class="marker" id="mapping-1491"></span><span class="token add" data-title="function_definition/parameter">uint256 _value</span>) <span class="marker" id="mapping-1492"></span><span class="token add" data-title="function_definition/visibility">internal</span> <span class="marker" id="mapping-1493"></span><span class="token add" data-title="function_definition/function_body">{
        <span class="marker" id="mapping-1494"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1495"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-1496"></span><span class="token add" data-title="call_expression/member_expression">super._setAllowance</span>(<span class="marker" id="mapping-1497"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1498"></span><span class="token add" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-1499"></span><span class="token mv" id="move-dst-196" data-title="call_expression/call_argument">_value</span>)</span>;</span>
        <span class="marker" id="mapping-1500"></span><span class="token add" data-title="function_body/expression_statement"><span class="marker" id="mapping-1501"></span><span class="token add" data-title="expression_statement/call_expression"><span class="marker" id="mapping-1502"></span><span class="token add" data-title="call_expression/member_expression">allowances_Deprecated.setAllowance</span>(<span class="marker" id="mapping-1503"></span><span class="token add" data-title="call_expression/call_argument">_who</span>, <span class="marker" id="mapping-1504"></span><span class="token add" data-title="call_expression/call_argument">_spender</span>, <span class="marker" id="mapping-1505"></span><span class="token mv" id="move-dst-194" data-title="call_expression/call_argument">_value</span>)</span>;</span>
    }</span></span>
}</span></span>

<span class="marker" id="mapping-1506"></span><span class="token mv" id="move-dst-173" data-title="source_file/comment"><span class="marker" id="mapping-1507"></span><span class="token upd" id="move-dst-173" data-title="source_file/comment"><span class="cupd">/</span>/<span class="cupd"> </span>F<span class="cupd">i</span><span class="cupd">le</span>:<span class="cupd"> </span><span class="cupd">c</span><span class="cupd">ontract</span>s/P<span class="cupd">r</span><span class="cupd">o</span><span class="cupd">v</span><span class="cupd">is</span><span class="cupd">i</span><span class="cupd">on</span><span class="cupd">a</span><span class="cupd">l</span><span class="cupd">True</span>USD<span class="cupd">.</span>s<span class="cupd">o</span>l</span></span>

<span class="marker" id="mapping-1508"></span><span class="token add" data-title="source_file/contract_declaration">contract ProvisionalTrueUSD is TrueUSD, ProvisionalCompliantDepositTokenWithHook {
}</span></pre></div></div></div></body></html>